<!DOCTYPE html><html lang="en" class="no-js"><head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../understanding-SIEM/understanding-SIEM.html">
      
      
        <link rel="next" href="../wazuh/wazuh.html">
      
      
        
      
      
      <link rel="icon" href="../images/Cyber Defence Kit logo.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Splunk - Cyber Defence Kit</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
        <script src="https://unpkg.com/iframe-worker/shim"></script>
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  <link href="../assets/stylesheets/glightbox.min.css" rel="stylesheet"><script src="../assets/javascripts/glightbox.min.js"></script><style id="glightbox-style">
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color); }
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color); }
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color); }
        </style></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="light-blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#splunk" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="Cyber Defence Kit" class="md-header__button md-logo" aria-label="Cyber Defence Kit" data-md-component="logo">
      
  <img src="../images/Cyber Defence Kit logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Cyber Defence Kit
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Splunk
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="light-blue" aria-label="Switch to dark mode" type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"></path></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="light-blue" aria-label="Switch to light mode" type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"></path></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"></path></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../index.html" class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../understanding-SIEM/understanding-SIEM.html" class="md-tabs__link">
          
  
  
    
  
  SIEM

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../understanding-IDS-IPS/understanding-IDS-IPS.html" class="md-tabs__link">
          
  
  
    
  
  IDS/IPS

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../understanding-SIRP/understanding-SIRP.html" class="md-tabs__link">
          
  
  
    
  
  SIRP

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../understanding-SOAR/understanding-SOAR.html" class="md-tabs__link">
          
  
  
    
  
  SOAR

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../understanding-NTA/understanding-NTA.html" class="md-tabs__link">
          
  
  
    
  
  NTA

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../understanding-DFIR/understanding-DFIR.html" class="md-tabs__link">
          
  
  
    
  
  DFIR

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../understanding-EDR/understanding-EDR.html" class="md-tabs__link">
          
  
  
    
  
  EDR

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../caldera/caldera.html" class="md-tabs__link">
          
  
  
    
  
  MITRE

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="Cyber Defence Kit" class="md-nav__button md-logo" aria-label="Cyber Defence Kit" data-md-component="logo">
      
  <img src="../images/Cyber Defence Kit logo.png" alt="logo">

    </a>
    Cyber Defence Kit
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    SIEM
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    SIEM
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../understanding-SIEM/understanding-SIEM.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Understanding SIEM
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Splunk
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="splunk.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Splunk
  

    
  </span>
  
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#lab-setup-for-proof-of-concept" class="md-nav__link">
    <span class="md-ellipsis">
      
        Lab Setup for Proof of Concept
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installing-splunk-enterprise-offline" class="md-nav__link">
    <span class="md-ellipsis">
      
        Installing Splunk Enterprise Offline
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Installing Splunk Enterprise Offline">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#on-an-internet-connected-machine-ubuntu" class="md-nav__link">
    <span class="md-ellipsis">
      
        On an Internet-Connected Machine (Ubuntu)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#on-the-air-gapped-environment" class="md-nav__link">
    <span class="md-ellipsis">
      
        On the Air-Gapped Environment
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-firewall-optional" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuring Firewall (Optional)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring-fortigate" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuring FortiGate
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring-syslog-logging-on-fortigate" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuring Syslog Logging on FortiGate
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring-syslog-logging-on-cisco-isr-optional" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuring Syslog Logging on Cisco ISR (Optional)
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ingesting-fortigate-logs" class="md-nav__link">
    <span class="md-ellipsis">
      
        Ingesting FortiGate Logs
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ingesting-fortigate-logs-through-sc4s-option-1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Ingesting FortiGate Logs through SC4S (Option 1)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ingesting FortiGate Logs through SC4S (Option 1)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-indexes-for-sc4s" class="md-nav__link">
    <span class="md-ellipsis">
      
        Creating Indexes for SC4S
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-a-hec-token" class="md-nav__link">
    <span class="md-ellipsis">
      
        Creating a HEC Token
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#loading-sc4s-container-image" class="md-nav__link">
    <span class="md-ellipsis">
      
        Loading SC4S Container Image
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-ipv4-forwarding" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuring IPv4 forwarding
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-sc4s" class="md-nav__link">
    <span class="md-ellipsis">
      
        Testing SC4S
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ingesting-fortigate-logs-through-fortigate-app-option-2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Ingesting FortiGate Logs through FortiGate App (Option 2)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ingesting FortiGate Logs through FortiGate App (Option 2)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#adding-udp-data-input" class="md-nav__link">
    <span class="md-ellipsis">
      
        Adding UDP Data Input
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-syslog-logging-on-fortigate-udp-5514" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuring Syslog Logging on FortiGate (UDP 5514)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-fortigate-app" class="md-nav__link">
    <span class="md-ellipsis">
      
        Testing FortiGate App
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installing-sysmon-on-windows" class="md-nav__link">
    <span class="md-ellipsis">
      
        Installing Sysmon on Windows
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installing-splunk-uf-on-windows" class="md-nav__link">
    <span class="md-ellipsis">
      
        Installing Splunk UF on Windows
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installing-splunk-uf-with-a-domain-account-option-1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Installing Splunk UF with a Domain Account (Option 1)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Installing Splunk UF with a Domain Account (Option 1)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-a-domain-account" class="md-nav__link">
    <span class="md-ellipsis">
      
        Creating a Domain Account
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-rdp-optional" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuring RDP (Optional)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-splunk-uf-on-windows" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuring Splunk UF on Windows
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-a-new-outbound-firewall-rule" class="md-nav__link">
    <span class="md-ellipsis">
      
        Creating a New Outbound Firewall Rule
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verifying-agent-connection-on-windows" class="md-nav__link">
    <span class="md-ellipsis">
      
        Verifying Agent Connection on Windows
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installing-splunk-uf-on-linux" class="md-nav__link">
    <span class="md-ellipsis">
      
        Installing Splunk UF on Linux
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Installing Splunk UF on Linux">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuring-splunk-uf-on-linux" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuring Splunk UF on Linux
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verifying-agent-connection-on-linux" class="md-nav__link">
    <span class="md-ellipsis">
      
        Verifying Agent Connection on Linux
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installing-splunk-apps" class="md-nav__link">
    <span class="md-ellipsis">
      
        Installing Splunk Apps
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-indexes-for-apps" class="md-nav__link">
    <span class="md-ellipsis">
      
        Creating Indexes for Apps
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring-linux-app" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuring Linux App
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuring Linux App">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#for-splunk-uf-v940-and-above" class="md-nav__link">
    <span class="md-ellipsis">
      
        For Splunk UF v9.4.0 and above:
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#for-older-versions-of-splunk-uf" class="md-nav__link">
    <span class="md-ellipsis">
      
        For older versions of Splunk UF:
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#editing-config-files-for-linux-app" class="md-nav__link">
    <span class="md-ellipsis">
      
        Editing Config Files for Linux App
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring-windows-and-sysmon-apps" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuring Windows and Sysmon Apps
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuring Windows and Sysmon Apps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#for-splunk-v-940-and-above" class="md-nav__link">
    <span class="md-ellipsis">
      
        For Splunk v 9.4.0 and above:
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#for-older-versions-of-splunk" class="md-nav__link">
    <span class="md-ellipsis">
      
        For older versions of Splunk:
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#editing-config-files-for-windows-app" class="md-nav__link">
    <span class="md-ellipsis">
      
        Editing Config Files for Windows App
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#editing-config-files-for-sysmon-app" class="md-nav__link">
    <span class="md-ellipsis">
      
        Editing Config Files for Sysmon App
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#annex-installing-splunk-uf-on-windows-with-a-virtual-account" class="md-nav__link">
    <span class="md-ellipsis">
      
        Annex: Installing Splunk UF on Windows with a Virtual Account
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduction-to-splunk" class="md-nav__link">
    <span class="md-ellipsis">
      
        Introduction to Splunk
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Introduction to Splunk">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#attack-simulation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Attack Simulation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-reports" class="md-nav__link">
    <span class="md-ellipsis">
      
        Creating Reports
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-alerts" class="md-nav__link">
    <span class="md-ellipsis">
      
        Creating Alerts
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-dashboards" class="md-nav__link">
    <span class="md-ellipsis">
      
        Creating Dashboards
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cloning-in-dashboard-studio" class="md-nav__link">
    <span class="md-ellipsis">
      
        Cloning in Dashboard Studio
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wazuh/wazuh.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Wazuh
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../securityonion/securityonion.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Security Onion
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3">
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    IDS/IPS
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    IDS/IPS
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../understanding-IDS-IPS/understanding-IDS-IPS.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Understanding IDS/IPS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../snort/snort.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Snort
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../suricata/suricata.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Suricata
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4">
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    SIRP
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    SIRP
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../understanding-SIRP/understanding-SIRP.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Understanding SIRP
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../thehive/thehive.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    TheHive
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../iris/iris.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IRIS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5">
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    SOAR
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    SOAR
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../understanding-SOAR/understanding-SOAR.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Understanding SOAR
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../shuffle/shuffle.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Shuffle
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6">
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    NTA
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    NTA
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../understanding-NTA/understanding-NTA.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Understanding NTA
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wireshark/wireshark.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Wireshark
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../zeek/zeek.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Zeek
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../zui/zui.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Zui
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7">
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    DFIR
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    DFIR
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../understanding-DFIR/understanding-DFIR.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Understanding DFIR
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../velociraptor/velociraptor.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Velociraptor
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8">
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    EDR
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    EDR
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../understanding-EDR/understanding-EDR.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Understanding EDR
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../auroralite/auroralite.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Aurora Lite
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_9">
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    MITRE
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    MITRE
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../caldera/caldera.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Caldera
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../navigator/navigator.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MITRE ATT&amp;CK Navigator
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="splunk"><strong>Splunk</strong></h1>
<p>Splunk Enterprise is a Security Information and Event Management (SIEM) tool usually installed on the server. It is designed for searching, analysing, and visualising data. It allows users to collect and ingest data, and search across various data types. Splunk Universal Forwarders are usually installed on clients to provide reliable, secure data collection and forward that data into Splunk Enterprise for indexing. This part of documentation focuses on installing and configuring Splunk. For Splunk, the main focus will be installing Splunk Enterprise and Universal Forwarder. </p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/aje9p_npwwg?si=r_cDgVJfrqYae1A7" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

<h2 id="lab-setup-for-proof-of-concept"><strong>Lab Setup for Proof of Concept</strong></h2>
<p>In this proof of concept, Splunk Enterprise was installed on an Ubuntu VM (Virtual Machine), and the Splunk Universal Forwarder was installed on both Ubuntu and Windows VMs. An attack emulation was conducted on the FortiGate VM in a safe and controlled environment.</p>
<p><strong>Note: Do not attempt to replicate the attack emulation demonstrated here unless you are properly trained and it is safe to do so. Unauthorised attack emulation can lead to legal consequences and unintended damage to systems. Always ensure that such activities are conducted by qualified professionals in a secure, isolated environment.</strong></p>
<p><strong>For Documentation:</strong></p>
<table>
<thead>
<tr>
<th><strong>Hostname</strong></th>
<th><strong>OS</strong></th>
<th><strong>Role</strong></th>
<th><strong>IP Address</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Fortigate</td>
<td>Fortios 7.6.0</td>
<td>Firewall/Router</td>
<td>192.168.1.10 (WAN) /</td>
</tr>
<tr>
<td>10.0.0.1 (LAN)</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Splunk</td>
<td>Ubuntu 24.04</td>
<td>Splunk Enterprise (server), SC4S</td>
<td>10.0.0.100</td>
</tr>
<tr>
<td>Ubuntu</td>
<td>Ubuntu 24.04</td>
<td>Splunk Universal Forwarder (Linux client)</td>
<td>10.0.0.200</td>
</tr>
<tr>
<td>WS2019</td>
<td>Windows Server 2019</td>
<td>Splunk Universal Forwarder (Windows client)</td>
<td>10.0.0.50</td>
</tr>
<tr>
<td>Kali</td>
<td>Kali Linux 2025.1</td>
<td>Attacker machine</td>
<td>10.0.0.22</td>
</tr>
</tbody>
</table>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="Splunk_PoC.drawio.png" data-desc-position="bottom"><img alt="Splunk PoC.drawio.png" src="Splunk_PoC.drawio.png"></a></p>
<h2 id="installing-splunk-enterprise-offline"><strong>Installing Splunk Enterprise Offline</strong></h2>
<p>This documentation explains how to install Splunk Enterprise offline on Ubuntu or CentOS virtual machines (VMs).</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="1.png" data-desc-position="bottom"><img alt="1.png" src="1.png"></a></p>
<h3 id="on-an-internet-connected-machine-ubuntu"><strong>On an Internet-Connected Machine (Ubuntu)</strong></h3>
<p>On an internet-connected <strong>Ubuntu VM</strong>, refresh the package lists from the repositories and create a structured directory for downloading dependencies:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>sudo<span class="w"> </span>apt-get<span class="w"> </span>update
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>mkdir<span class="w"> </span>-p<span class="w"> </span>~/splunk-offline/<span class="o">{</span>vmtools,nettools,docker,sc4s,apps<span class="o">}</span>
</code></pre></div>
<p>Download and install VM tools and its dependencies (this will enable copy and pasting and dynamic resolution). After installing VM tools, reboot the VM. </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="nb">cd</span><span class="w"> </span>~/splunk-offline/vmtools
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>apt-get<span class="w"> </span>download<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w">  </span>libatkmm-1.6-1v5<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">  </span>libcairomm-1.0-1v5<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="w">  </span>libglibmm-2.4-1t64<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="w">  </span>libgtkmm-3.0-1t64<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="w">  </span>libmspack0t64<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="w">  </span>libpangomm-1.4-1v5<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="w">  </span>libsigc++-2.0-0v5<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="w">  </span>libxmlsec1t64<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="w">  </span>libxmlsec1t64-openssl<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="w">  </span>open-vm-tools<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="w">  </span>open-vm-tools-desktop<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a><span class="w">  </span>zerofree
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>sudo<span class="w"> </span>dpkg<span class="w"> </span>-i<span class="w"> </span>*.deb
</code></pre></div>
<p>Register on the Splunk website for a free trial and download <a href="https://www.splunk.com/en_us/download/splunk-enterprise.html">Splunk Enterprise</a> for Linux. There are options for <code>.tgz</code>, <code>.deb</code>, and <code>.rpm</code>. Use <code>wget</code> and copy and paste the wget link in the <code>splunk-offline</code> directory. </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="nb">cd</span><span class="w"> </span>~/splunk-offline
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>wget<span class="w"> </span>-O<span class="w"> </span>splunk-9.4.1-linux-amd64.tgz<span class="w"> </span><span class="s2">"https://download.splunk.com/products/splunk/releases/9.4.1/linux/splunk-9.4.1-&lt;SNIP&gt;-linux-amd64.tgz"</span>
</code></pre></div>
<p>Download Docker Engine and its dependencies. If you are using <strong>CentOS</strong>, skip this step as Podman is already installed.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c1">#Ubuntu 22.04</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="nb">cd</span><span class="w"> </span>~/splunk-offline/docker
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>wget<span class="w"> </span>https://download.docker.com/linux/ubuntu/dists/jammy/pool/stable/amd64/containerd.io_1.7.25-1_amd64.deb
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>wget<span class="w"> </span>https://download.docker.com/linux/ubuntu/dists/jammy/pool/stable/amd64/docker-ce_28.0.0-1~ubuntu.22.04~jammy_amd64.deb
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>wget<span class="w"> </span>https://download.docker.com/linux/ubuntu/dists/jammy/pool/stable/amd64/docker-ce-cli_28.0.0-1~ubuntu.22.04~jammy_amd64.deb
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>wget<span class="w"> </span>https://download.docker.com/linux/ubuntu/dists/jammy/pool/stable/amd64/docker-buildx-plugin_0.21.0-1~ubuntu.22.04~jammy_amd64.deb
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>wget<span class="w"> </span>https://download.docker.com/linux/ubuntu/dists/jammy/pool/stable/amd64/docker-compose-plugin_2.33.0-1~ubuntu.22.04~jammy_amd64.deb
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c1">#Ubuntu 24.04</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="nb">cd</span><span class="w"> </span>~/splunk-offline/docker
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>wget<span class="w"> </span>https://download.docker.com/linux/ubuntu/dists/noble/pool/stable/amd64/containerd.io_1.7.25-1_amd64.deb
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>wget<span class="w"> </span>https://download.docker.com/linux/ubuntu/dists/noble/pool/stable/amd64/docker-ce_28.0.0-1~ubuntu.24.04~noble_amd64.deb
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>wget<span class="w"> </span>https://download.docker.com/linux/ubuntu/dists/noble/pool/stable/amd64/docker-ce-cli_28.0.0-1~ubuntu.24.04~noble_amd64.deb
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>wget<span class="w"> </span>https://download.docker.com/linux/ubuntu/dists/noble/pool/stable/amd64/docker-buildx-plugin_0.21.0-1~ubuntu.24.04~noble_amd64.deb
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>wget<span class="w"> </span>https://download.docker.com/linux/ubuntu/dists/noble/pool/stable/amd64/docker-compose-plugin_2.33.0-1~ubuntu.24.04~noble_amd64.deb
</code></pre></div>
<p>Download net-tools. </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="n">cd</span> <span class="o">~/</span><span class="n">splunk</span><span class="o">-</span><span class="n">offline</span><span class="o">/</span><span class="n">nettools</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">download</span> <span class="n">net</span><span class="o">-</span><span class="n">tools</span>
</code></pre></div>
<p>Download the latest SC4S container image&nbsp;<code>oci_container.tgz</code>&nbsp;from <a href="https://github.com/splunk/splunk-connect-for-syslog/releases">SC4S GitHub</a> page.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="nb">cd</span><span class="w"> </span>~/splunk-offline/sc4s
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>wget<span class="w"> </span>https://github.com/splunk/splunk-connect-for-syslog/releases/download/v3.34.3/oci_container.tar.gz
</code></pre></div>
<p>Download the following Splunk Apps (tar archive files). You will need to login using the registered credential.</p>
<ul>
<li><a href="https://splunkbase.splunk.com/app/742">Splunk Add-on for MS Windows</a></li>
<li><a href="https://splunkbase.splunk.com/app/5709">Splunk Add-on for Sysmon</a></li>
<li><a href="https://splunkbase.splunk.com/app/2846">Fortinet FortiGate Add-On for Splunk</a> (optional: required if ingesting FortiGate logs through this App)</li>
<li><a href="https://splunkbase.splunk.com/app/833">Splunk Add-on for Unix and Linux</a></li>
</ul>
<p>Copy the Splunk Apps to <code>~/splunk-offline/apps/</code> directory. Verify that the apps have been copied.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>cp<span class="w"> </span>~/Downloads/*.tgz<span class="w"> </span>~/splunk-offline/apps/
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="nb">cd</span><span class="w"> </span>~/splunk-offline/apps/
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>ls
</code></pre></div>
<p>Compress all dependencies with <code>sudo</code> privileges before transferring them. This process may take some time.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="nb">cd</span><span class="w"> </span>~/splunk-offline
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>sudo<span class="w"> </span>tar<span class="w"> </span>-czvf<span class="w"> </span>splunk-offline.tar.gz<span class="w"> </span>*
</code></pre></div>
<p>Change the ownership of <code>splunk-offline.tar.gz</code> to your standard user and group, then verify the change.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>sudo<span class="w"> </span>chown<span class="w"> </span><span class="k">$(</span>whoami<span class="k">)</span>:<span class="k">$(</span>id<span class="w"> </span>-g<span class="w"> </span>-n<span class="k">)</span><span class="w"> </span>splunk-offline.tar.gz
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>ls<span class="w"> </span>-la
</code></pre></div>
<p>Transfer <code>splunk-offline.tar.gz</code> to the air-gapped Ubuntu VM using a USB drive.</p>
<h3 id="on-the-air-gapped-environment"><strong>On the Air-Gapped Environment</strong></h3>
<p>On the air-gapped VM, make a directory called <code>splunk-offline</code> and extract the transferred archive. This process may take some time.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>mkdir<span class="w"> </span>~/splunk-offline<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>~/splunk-offline
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>tar<span class="w"> </span>-xzvf<span class="w"> </span>~/splunk-offline.tar.gz
</code></pre></div>
<p>Install VM tools and its dependencies (this will enable copy and pasting and dynamic resolution). After installing VM tools, reboot the VM. </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="nb">cd</span><span class="w"> </span>~/splunk-offline/vmtools
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>sudo<span class="w"> </span>dpkg<span class="w"> </span>-i<span class="w"> </span>*deb
</code></pre></div>
<p>Install Docker and its dependencies. Verify Installation.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="n">cd</span> <span class="o">~/</span><span class="n">splunk</span><span class="o">-</span><span class="n">offline</span><span class="o">/</span><span class="n">docker</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="n">sudo</span> <span class="n">dpkg</span> <span class="o">-</span><span class="n">i</span> <span class="o">*</span>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="n">docker</span> <span class="o">--</span><span class="n">version</span>
</code></pre></div>
<p>Run <code>sudo service docker start</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="n">sudo</span> <span class="n">service</span> <span class="n">docker</span> <span class="n">start</span>
</code></pre></div>
<p>Run the following command to add your user to the <code>docker</code> group:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="n">sudo</span> <span class="n">usermod</span> <span class="o">-</span><span class="n">aG</span> <span class="n">docker</span> <span class="err">$</span><span class="p">(</span><span class="n">whoami</span><span class="p">)</span>
</code></pre></div>
<p>Reload the group membership for your current session with the following command:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="n">newgrp</span> <span class="n">docker</span>
</code></pre></div>
<p>Check if you can run Docker commands without <code>sudo</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="n">docker</span> <span class="n">ps</span>
</code></pre></div>
<p>Install net-tools and verify installation.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="n">cd</span> <span class="o">~/</span><span class="n">splunk</span><span class="o">-</span><span class="n">offline</span><span class="o">/</span><span class="n">nettools</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="n">sudo</span> <span class="n">dpkg</span> <span class="o">-</span><span class="n">i</span> <span class="o">*.</span><span class="n">deb</span>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="n">ifconfig</span>
</code></pre></div>
<p>In a new tab as the standard user, set the host OS kernel to match the default receiver buffer of SC4S, which is set to 16MB. Add the following content to <code>/etc/sysctl.conf</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="n">sudo</span> <span class="n">nano</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">sysctl</span><span class="o">.</span><span class="n">conf</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="n">net</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">rmem_default</span> <span class="o">=</span> <span class="mi">17039360</span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="n">net</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">rmem_max</span> <span class="o">=</span> <span class="mi">17039360</span>
</code></pre></div>
<p>Apply to the kernel by running the command  <code>sysctl -p</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="n">sudo</span> <span class="n">sysctl</span> <span class="o">-</span><span class="n">p</span>
</code></pre></div>
<p>Ensure the kernel is not dropping packets. Please note that you may see some packet receive errors due to the air-gapped environment. These errors can be ignored.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="n">netstat</span> <span class="o">-</span><span class="n">su</span> <span class="o">|</span> <span class="n">grep</span> <span class="s2">"receive errors"</span> 
</code></pre></div>
<p>Extract the <code>splunk-offline</code> tar archive to the <code>/opt</code> directory.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="nb">cd</span><span class="w"> </span>~/splunk-offline
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>sudo<span class="w"> </span>tar<span class="w"> </span>xvzf<span class="w"> </span>splunk*.tgz<span class="w"> </span>-C<span class="w"> </span>/opt
</code></pre></div>
<p>Create user <code>splunk</code> and change ownership of <code>/opt/splunk</code> directory to the <code>splunk</code> user. Enter password and user information for the <code>splunk</code> user (use default values by pressing <code>enter</code> ). </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="n">sudo</span> <span class="n">adduser</span> <span class="n">splunk</span>
</code></pre></div>
<p>If you are using <strong>CentOS</strong>, after adding user, go to settings &gt; Users. Unlock to Change Settings. Set password for the&nbsp;<code>splunk</code>&nbsp;user. Make the <code>splunk</code> user the owner of the <code>/opt/splunk</code> directory and verify the ownership.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>sudo<span class="w"> </span>chown<span class="w"> </span>-R<span class="w"> </span>splunk:splunk<span class="w"> </span>/opt/splunk
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="nb">cd</span><span class="w"> </span>/opt
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a>ls<span class="w"> </span>-la
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="c1">#Example output</span>
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="n">total</span> <span class="mi">12</span>
<a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a><span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span>  <span class="mi">3</span> <span class="n">root</span>   <span class="n">root</span>   <span class="mi">4096</span> <span class="n">Sep</span> <span class="mi">18</span> <span class="mi">15</span><span class="p">:</span><span class="mi">36</span> <span class="o">.</span>
<a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a><span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span> <span class="mi">20</span> <span class="n">root</span>   <span class="n">root</span>   <span class="mi">4096</span> <span class="n">Sep</span> <span class="mi">18</span> <span class="mi">15</span><span class="p">:</span><span class="mi">21</span> <span class="o">..</span>
<a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a><span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span> <span class="mi">11</span> <span class="o">**</span><span class="n">splunk</span> <span class="n">splunk</span><span class="o">**</span> <span class="mi">4096</span> <span class="n">Sep</span>  <span class="mi">6</span> <span class="mi">05</span><span class="p">:</span><span class="mi">58</span> <span class="n">splunk</span>
</code></pre></div>
<p>Switch to <code>splunk</code> user and start Splunk Enterprise. When prompted, create admin credentials.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>su<span class="w"> </span>splunk
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="nb">cd</span><span class="w"> </span>/opt/splunk/bin
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a>./splunk<span class="w"> </span>start<span class="w"> </span>--accept-license
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a>This<span class="w"> </span>appears<span class="w"> </span>to<span class="w"> </span>be<span class="w"> </span>your<span class="w"> </span>first<span class="w"> </span><span class="nb">time</span><span class="w"> </span>running<span class="w"> </span>this<span class="w"> </span>version<span class="w"> </span>of<span class="w"> </span>Splunk.
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>
<a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a>Splunk<span class="w"> </span>software<span class="w"> </span>must<span class="w"> </span>create<span class="w"> </span>an<span class="w"> </span>administrator<span class="w"> </span>account<span class="w"> </span>during<span class="w"> </span>startup.<span class="w"> </span>Otherwise,<span class="w"> </span>you<span class="w"> </span>cannot<span class="w"> </span>log<span class="w"> </span><span class="k">in</span>.
<a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a>Create<span class="w"> </span>credentials<span class="w"> </span><span class="k">for</span><span class="w"> </span>the<span class="w"> </span>administrator<span class="w"> </span>account.
<a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a>Characters<span class="w"> </span><span class="k">do</span><span class="w"> </span>not<span class="w"> </span>appear<span class="w"> </span>on<span class="w"> </span>the<span class="w"> </span>screen<span class="w"> </span>when<span class="w"> </span>you<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="k">in</span><span class="w"> </span>credentials.
<a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a>
<a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a>Please<span class="w"> </span>enter<span class="w"> </span>an<span class="w"> </span>administrator<span class="w"> </span>username:<span class="w"> </span>splunk<span class="w"> </span><span class="c1">#Create your username</span>
<a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a>Password<span class="w"> </span>must<span class="w"> </span>contain<span class="w"> </span>at<span class="w"> </span>least:<span class="w"> </span><span class="c1">#Create your password</span>
<a id="__codelineno-28-9" name="__codelineno-28-9" href="#__codelineno-28-9"></a><span class="w">   </span>*<span class="w"> </span><span class="m">8</span><span class="w"> </span>total<span class="w"> </span>printable<span class="w"> </span>ASCII<span class="w"> </span>character<span class="o">(</span>s<span class="o">)</span>.
<a id="__codelineno-28-10" name="__codelineno-28-10" href="#__codelineno-28-10"></a>Please<span class="w"> </span>enter<span class="w"> </span>a<span class="w"> </span>new<span class="w"> </span>password:<span class="w"> </span>
<a id="__codelineno-28-11" name="__codelineno-28-11" href="#__codelineno-28-11"></a>Please<span class="w"> </span>confirm<span class="w"> </span>new<span class="w"> </span>password:<span class="w"> </span>
</code></pre></div>
<p>In the <code>/opt/splunk/bin/</code> directory, configure Splunk to listen on port 9997</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a>./splunk<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>listen<span class="w"> </span><span class="m">9997</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="c1">#Example Output</span>
<a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a>Listening<span class="w"> </span><span class="k">for</span><span class="w"> </span>Splunk<span class="w"> </span>data<span class="w"> </span>on<span class="w"> </span>TCP<span class="w"> </span>port<span class="w"> </span><span class="m">9997</span>.
</code></pre></div>
<p>Navigate to <code>http://&lt;IP address&gt;:8000</code>on a web browser. Enter Splunk admin credentials. Verify that you can navigate the Splunk web interface.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image.png" data-desc-position="bottom"><img alt="image.png" src="image.png"></a></p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%201.png" data-desc-position="bottom"><img alt="image.png" src="image%201.png"></a></p>
<h3 id="configuring-firewall-optional"><strong>Configuring Firewall (Optional)</strong></h3>
<p>On Ubuntu, run the following command as a standard user in a new tab. This will configure and enable Firewall. In this lab, however, we will disable the firewall.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>sudo<span class="w"> </span>ufw<span class="w"> </span>allow<span class="w"> </span><span class="m">514</span>/tcp<span class="w">  </span><span class="c1"># syslog TCP</span>
<a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a>sudo<span class="w"> </span>ufw<span class="w"> </span>allow<span class="w"> </span><span class="m">514</span>/udp<span class="w">  </span><span class="c1"># syslog UDP</span>
<a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a>sudo<span class="w"> </span>ufw<span class="w"> </span>allow<span class="w"> </span><span class="m">6514</span>/tcp<span class="w"> </span><span class="c1"># syslog TLS</span>
<a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a>sudo<span class="w"> </span>ufw<span class="w"> </span>allow<span class="w"> </span><span class="m">5425</span>/tcp<span class="w"> </span><span class="c1"># syslog</span>
<a id="__codelineno-31-5" name="__codelineno-31-5" href="#__codelineno-31-5"></a>sudo<span class="w"> </span>ufw<span class="w"> </span>allow<span class="w"> </span><span class="m">601</span>/tcp<span class="w">  </span><span class="c1"># syslog</span>
<a id="__codelineno-31-6" name="__codelineno-31-6" href="#__codelineno-31-6"></a>sudo<span class="w"> </span>ufw<span class="w"> </span>allow<span class="w"> </span><span class="m">8000</span>/tcp<span class="w"> </span><span class="c1"># Web UI Port</span>
<a id="__codelineno-31-7" name="__codelineno-31-7" href="#__codelineno-31-7"></a>sudo<span class="w"> </span>ufw<span class="w"> </span>allow<span class="w"> </span><span class="m">8080</span>/tcp<span class="w"> </span><span class="c1"># HEC Port</span>
<a id="__codelineno-31-8" name="__codelineno-31-8" href="#__codelineno-31-8"></a>sudo<span class="w"> </span>ufw<span class="w"> </span>allow<span class="w"> </span><span class="m">8088</span>/tcp<span class="w"> </span><span class="c1"># HEC Port</span>
<a id="__codelineno-31-9" name="__codelineno-31-9" href="#__codelineno-31-9"></a>sudo<span class="w"> </span>ufw<span class="w"> </span>allow<span class="w"> </span><span class="m">8089</span>/tcp<span class="w"> </span><span class="c1"># Management Port</span>
<a id="__codelineno-31-10" name="__codelineno-31-10" href="#__codelineno-31-10"></a>sudo<span class="w"> </span>ufw<span class="w"> </span>allow<span class="w"> </span><span class="m">9997</span>/tcp<span class="w"> </span><span class="c1"># Data flow</span>
<a id="__codelineno-31-11" name="__codelineno-31-11" href="#__codelineno-31-11"></a>sudo<span class="w"> </span>ufw<span class="w"> </span>allow<span class="w"> </span><span class="m">8065</span>/tcp<span class="w"> </span><span class="c1"># Appserver</span>
<a id="__codelineno-31-12" name="__codelineno-31-12" href="#__codelineno-31-12"></a>sudo<span class="w"> </span>ufw<span class="w"> </span>allow<span class="w"> </span><span class="m">8191</span>/tcp<span class="w"> </span><span class="c1"># KVstore</span>
<a id="__codelineno-31-13" name="__codelineno-31-13" href="#__codelineno-31-13"></a>sudo<span class="w"> </span>ufw<span class="w"> </span><span class="nb">enable</span>
<a id="__codelineno-31-14" name="__codelineno-31-14" href="#__codelineno-31-14"></a>sudo<span class="w"> </span>ufw<span class="w"> </span>reload
</code></pre></div>
<p>Alternatively, if you are on CentOS, run the following command to configure and enable Firewall:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a>sudo<span class="w"> </span>firewall-cmd<span class="w"> </span>--zone<span class="o">=</span>public<span class="w"> </span>--add-port<span class="o">=</span><span class="m">514</span>/tcp<span class="w"> </span>--permanent<span class="w"> </span><span class="c1"># syslog TCP</span>
<a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a>sudo<span class="w"> </span>firewall-cmd<span class="w"> </span>--zone<span class="o">=</span>public<span class="w"> </span>--add-port<span class="o">=</span><span class="m">514</span>/udp<span class="w"> </span>--permanent<span class="w"> </span><span class="c1"># syslog UDP</span>
<a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a>sudo<span class="w"> </span>firewall-cmd<span class="w"> </span>--zone<span class="o">=</span>public<span class="w"> </span>--add-port<span class="o">=</span><span class="m">5514</span>/udp<span class="w"> </span>--permanent<span class="w"> </span><span class="c1"># syslog UDP</span>
<a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a>sudo<span class="w"> </span>firewall-cmd<span class="w"> </span>--zone<span class="o">=</span>public<span class="w"> </span>--add-port<span class="o">=</span><span class="m">6514</span>/tcp<span class="w"> </span>--permanent<span class="w"> </span><span class="c1"># syslog TLS</span>
<a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a>sudo<span class="w"> </span>firewall-cmd<span class="w"> </span>--zone<span class="o">=</span>public<span class="w"> </span>--add-port<span class="o">=</span><span class="m">5425</span>/tcp<span class="w"> </span>--permanent<span class="w"> </span><span class="c1"># syslog</span>
<a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a>sudo<span class="w"> </span>firewall-cmd<span class="w"> </span>--zone<span class="o">=</span>public<span class="w"> </span>--add-port<span class="o">=</span><span class="m">601</span>/tcp<span class="w"> </span>--permanent<span class="w"> </span><span class="c1"># syslog</span>
<a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a>sudo<span class="w"> </span>firewall-cmd<span class="w"> </span>--zone<span class="o">=</span>public<span class="w"> </span>--add-port<span class="o">=</span><span class="m">8000</span>/tcp<span class="w"> </span>--permanent<span class="w"> </span><span class="c1"># Web UI Port</span>
<a id="__codelineno-32-8" name="__codelineno-32-8" href="#__codelineno-32-8"></a>sudo<span class="w"> </span>firewall-cmd<span class="w"> </span>--zone<span class="o">=</span>public<span class="w"> </span>--add-port<span class="o">=</span><span class="m">8080</span>/tcp<span class="w"> </span>--permanent<span class="w"> </span><span class="c1"># HEC port</span>
<a id="__codelineno-32-9" name="__codelineno-32-9" href="#__codelineno-32-9"></a>sudo<span class="w"> </span>firewall-cmd<span class="w"> </span>--zone<span class="o">=</span>public<span class="w"> </span>--add-port<span class="o">=</span><span class="m">8088</span>/tcp<span class="w"> </span>--permanent<span class="w"> </span><span class="c1"># HEC port</span>
<a id="__codelineno-32-10" name="__codelineno-32-10" href="#__codelineno-32-10"></a>sudo<span class="w"> </span>firewall-cmd<span class="w"> </span>--zone<span class="o">=</span>public<span class="w"> </span>--add-port<span class="o">=</span><span class="m">8089</span>/tcp<span class="w"> </span>--permanent<span class="w"> </span><span class="c1"># Managment Port</span>
<a id="__codelineno-32-11" name="__codelineno-32-11" href="#__codelineno-32-11"></a>sudo<span class="w"> </span>firewall-cmd<span class="w"> </span>--zone<span class="o">=</span>public<span class="w"> </span>--add-port<span class="o">=</span><span class="m">9997</span>/tcp<span class="w"> </span>--permanent<span class="w"> </span><span class="c1"># Data flow</span>
<a id="__codelineno-32-12" name="__codelineno-32-12" href="#__codelineno-32-12"></a>sudo<span class="w"> </span>firewall-cmd<span class="w"> </span>--zone<span class="o">=</span>public<span class="w"> </span>--add-port<span class="o">=</span><span class="m">8065</span>/tcp<span class="w"> </span>--permanent<span class="w"> </span><span class="c1"># appserver</span>
<a id="__codelineno-32-13" name="__codelineno-32-13" href="#__codelineno-32-13"></a>sudo<span class="w"> </span>firewall-cmd<span class="w"> </span>--zone<span class="o">=</span>public<span class="w"> </span>--add-port<span class="o">=</span><span class="m">8191</span>/tcp<span class="w"> </span>--permanent<span class="w"> </span><span class="c1"># kvstore</span>
<a id="__codelineno-32-14" name="__codelineno-32-14" href="#__codelineno-32-14"></a>sudo<span class="w"> </span>firewall-cmd<span class="w"> </span>--reload
<a id="__codelineno-32-15" name="__codelineno-32-15" href="#__codelineno-32-15"></a>sudo<span class="w"> </span>firewall-cmd<span class="w"> </span>--list-all
</code></pre></div>
<h2 id="configuring-fortigate"><strong>Configuring FortiGate</strong></h2>
<p>Configure Port 1 as WAN interface and Port 2 as LAN interface. Set up DHCP to automatically assign IP addresses to clients connecting to the LAN.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%202.png" data-desc-position="bottom"><img alt="image.png" src="image%202.png"></a></p>
<p>Create a Firewall Policy to allow LAN to WAN. To simulate an air-gapped environment without internet access, the policy has been disabled.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%203.png" data-desc-position="bottom"><img alt="image.png" src="image%203.png"></a></p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%204.png" data-desc-position="bottom"><img alt="image.png" src="image%204.png"></a></p>
<h2 id="configuring-syslog-logging-on-fortigate"><strong>Configuring Syslog Logging on FortiGate</strong></h2>
<p>On FortiGate Command-Line Interface (CLI), run the following commands to configure Syslog Server Settings:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a>config<span class="w"> </span>log<span class="w"> </span>syslogd<span class="w"> </span>setting
<a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a><span class="w">    </span><span class="nb">set</span><span class="w"> </span>status<span class="w"> </span><span class="nb">enable</span>
<a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a><span class="w">    </span><span class="nb">set</span><span class="w"> </span>server<span class="w"> </span>&lt;syslog-ng<span class="w"> </span>IP&gt;
<a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a><span class="w">    </span><span class="nb">set</span><span class="w"> </span>source-ip<span class="w"> </span>&lt;FortiGate<span class="w"> </span>IP&gt;
<a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a><span class="w">    </span><span class="c1"># set port &lt;port number&gt;  (Default port is 514)</span>
<a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a><span class="w">    </span><span class="c1"># Verify settings by running "show"</span>
<a id="__codelineno-33-7" name="__codelineno-33-7" href="#__codelineno-33-7"></a>end
</code></pre></div>
<p>Configure Log Memory Filter:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a>config<span class="w"> </span>log<span class="w"> </span>memory<span class="w"> </span>filter
<a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a><span class="w">    </span><span class="nb">set</span><span class="w"> </span>forward-traffic<span class="w"> </span><span class="nb">enable</span>
<a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a><span class="w">    </span><span class="nb">set</span><span class="w"> </span>local-traffic<span class="w"> </span><span class="nb">enable</span>
<a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a><span class="w">    </span><span class="nb">set</span><span class="w"> </span>sniffer-traffic<span class="w"> </span>disable
<a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a><span class="w">    </span><span class="nb">set</span><span class="w"> </span>anomaly<span class="w"> </span><span class="nb">enable</span>
<a id="__codelineno-34-6" name="__codelineno-34-6" href="#__codelineno-34-6"></a><span class="w">    </span><span class="nb">set</span><span class="w"> </span>voip<span class="w"> </span>disable
<a id="__codelineno-34-7" name="__codelineno-34-7" href="#__codelineno-34-7"></a><span class="w">    </span><span class="nb">set</span><span class="w"> </span>multicast-traffic<span class="w"> </span><span class="nb">enable</span>
<a id="__codelineno-34-8" name="__codelineno-34-8" href="#__codelineno-34-8"></a><span class="w">    </span><span class="c1"># Verify settings by running "show full-configuration"</span>
<a id="__codelineno-34-9" name="__codelineno-34-9" href="#__codelineno-34-9"></a>end
</code></pre></div>
<p>Configure Global System Settings:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a>config<span class="w"> </span>system<span class="w"> </span>global
<a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a><span class="w">    </span><span class="nb">set</span><span class="w"> </span>cli-audit-log<span class="w"> </span><span class="nb">enable</span>
<a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a><span class="w">    </span><span class="c1"># Verify settings by running "show"</span>
<a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a><span class="w">    </span><span class="c1"># Ensure the timezone is correct, e.g., "Pacific/Auckland"</span>
<a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a>end
</code></pre></div>
<p>Enable Logging for Neighbour Events:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a>config<span class="w"> </span>log<span class="w"> </span>setting
<a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a><span class="w">    </span><span class="nb">set</span><span class="w"> </span>neighbor-event<span class="w"> </span><span class="nb">enable</span>
<a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a>end
</code></pre></div>
<h2 id="configuring-syslog-logging-on-cisco-isr-optional"><strong>Configuring Syslog Logging on Cisco ISR (Optional)</strong></h2>
<p>On Cisco Integrated Services Routers (ISR) CLI, run the following command to verify Clock and Configure NTP</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a>show<span class="w"> </span>clock
<a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a>ntp<span class="w"> </span>server<span class="w"> </span>&lt;FortiGate<span class="w"> </span>IP&gt;
</code></pre></div>
<p>Enable Syslog Logging:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a>conf<span class="w"> </span>t
<a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a>logging<span class="w"> </span>on
<a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a>logging<span class="w"> </span>&lt;Syslog<span class="w"> </span>Server<span class="w"> </span>IP&gt;
<a id="__codelineno-38-4" name="__codelineno-38-4" href="#__codelineno-38-4"></a>logging<span class="w"> </span><span class="nb">trap</span><span class="w"> </span><span class="m">6</span>
<a id="__codelineno-38-5" name="__codelineno-38-5" href="#__codelineno-38-5"></a><span class="c1"># Use "?" to see available options</span>
<a id="__codelineno-38-6" name="__codelineno-38-6" href="#__codelineno-38-6"></a><span class="nb">exit</span>
</code></pre></div>
<p>Verify Logging:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a>show<span class="w"> </span>logging
<a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a><span class="c1"># Port 514/UDP is used by default</span>
</code></pre></div>
<p>Check Current Logging Configuration:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a>sh<span class="w"> </span>run<span class="w"> </span><span class="p">|</span><span class="w"> </span>inc<span class="w"> </span>logging
<a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a><span class="c1"># Multiple syslog servers can be configured</span>
</code></pre></div>
<p>Set IP Address for VLAN 1 and Test Connectivity:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a>conf<span class="w"> </span>t
<a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a>interface<span class="w"> </span>vlan<span class="w"> </span><span class="m">1</span>
<a id="__codelineno-41-3" name="__codelineno-41-3" href="#__codelineno-41-3"></a>ip<span class="w"> </span>address<span class="w"> </span>&lt;IP<span class="w"> </span>Address&gt;<span class="w"> </span>&lt;Subnet<span class="w"> </span>Mask&gt;
<a id="__codelineno-41-4" name="__codelineno-41-4" href="#__codelineno-41-4"></a>no<span class="w"> </span>shutdown
<a id="__codelineno-41-5" name="__codelineno-41-5" href="#__codelineno-41-5"></a><span class="nb">exit</span>
<a id="__codelineno-41-6" name="__codelineno-41-6" href="#__codelineno-41-6"></a>
<a id="__codelineno-41-7" name="__codelineno-41-7" href="#__codelineno-41-7"></a><span class="c1"># Test connectivity to the syslog server</span>
<a id="__codelineno-41-8" name="__codelineno-41-8" href="#__codelineno-41-8"></a>ping<span class="w"> </span>&lt;Syslog<span class="w"> </span>Server<span class="w"> </span>IP&gt;
</code></pre></div>
<p>Enable Log Sequence Numbers:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a>conf<span class="w"> </span>t
<a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a>service<span class="w"> </span>sequence-numbers
<a id="__codelineno-42-3" name="__codelineno-42-3" href="#__codelineno-42-3"></a><span class="c1"># Assigns sequence numbers to syslog messages in the order events occur</span>
</code></pre></div>
<p>Configure Console Logging:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a>conf<span class="w"> </span>t
<a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a>line<span class="w"> </span>console<span class="w"> </span><span class="m">0</span>
<a id="__codelineno-43-3" name="__codelineno-43-3" href="#__codelineno-43-3"></a>logging<span class="w"> </span>synchronous
<a id="__codelineno-43-4" name="__codelineno-43-4" href="#__codelineno-43-4"></a><span class="c1"># Ensures syslog messages are displayed properly after configuration</span>
<a id="__codelineno-43-5" name="__codelineno-43-5" href="#__codelineno-43-5"></a>end
</code></pre></div>
<h2 id="ingesting-fortigate-logs"><strong>Ingesting FortiGate Logs</strong></h2>
<p>To ingest FortiGate logs into Splunk, you have two options:</p>
<p>Option 1: Ingest FortiGate logs through SC4S.
Option 2: Ingest FortiGate logs through Splunks FortiGate App.</p>
<p>Please select one option, as using both options simultaneously is not recommended. However, for demonstration purposes, we will first go through Option 1, followed by Option 2.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="splunk2.png" data-desc-position="bottom"><img alt="splunk2.png" src="splunk2.png"></a></p>
<h2 id="ingesting-fortigate-logs-through-sc4s-option-1"><strong>Ingesting FortiGate Logs through SC4S (Option 1)</strong></h2>
<p>SC4S is an open source packaged solution for getting data into Splunk. It is based on the syslog-ng Open Source Edition (Syslog-NG OSE) and transports data to Splunk via the Splunk HTTP event Collector (HEC) rather than writing events to disk for collection by a Universal Forwarder.</p>
<h3 id="creating-indexes-for-sc4s"><strong>Creating Indexes for SC4S</strong></h3>
<p>On the <strong>Splunk VM</strong>, as the <code>splunk</code> user, create an <code>indexes.conf</code> in the <code>/opt/splunk/etc/system/local</code> directory. Copy and paste the following content. This step will create the default indexes that are used by SC4S. It is important that you <strong>do not edit</strong> <code>/opt/splunk/etc/system/default/indexes.conf</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a><span class="n">nano</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">splunk</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">indexes</span><span class="o">.</span><span class="n">conf</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a><span class="p">[</span><span class="n">default</span><span class="p">]</span>
<a id="__codelineno-45-2" name="__codelineno-45-2" href="#__codelineno-45-2"></a><span class="n">lastChanceIndex</span> <span class="o">=</span> <span class="n">main</span>
<a id="__codelineno-45-3" name="__codelineno-45-3" href="#__codelineno-45-3"></a>
<a id="__codelineno-45-4" name="__codelineno-45-4" href="#__codelineno-45-4"></a><span class="p">[</span><span class="n">email</span><span class="p">]</span>
<a id="__codelineno-45-5" name="__codelineno-45-5" href="#__codelineno-45-5"></a><span class="n">homePath</span>   <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">email</span><span class="o">/</span><span class="n">db</span>
<a id="__codelineno-45-6" name="__codelineno-45-6" href="#__codelineno-45-6"></a><span class="n">coldPath</span>   <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">email</span><span class="o">/</span><span class="n">colddb</span>
<a id="__codelineno-45-7" name="__codelineno-45-7" href="#__codelineno-45-7"></a><span class="n">thawedPath</span> <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">email</span><span class="o">/</span><span class="n">thaweddb</span>
<a id="__codelineno-45-8" name="__codelineno-45-8" href="#__codelineno-45-8"></a>
<a id="__codelineno-45-9" name="__codelineno-45-9" href="#__codelineno-45-9"></a><span class="p">[</span><span class="n">epav</span><span class="p">]</span>
<a id="__codelineno-45-10" name="__codelineno-45-10" href="#__codelineno-45-10"></a><span class="n">homePath</span>   <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">epav</span><span class="o">/</span><span class="n">db</span>
<a id="__codelineno-45-11" name="__codelineno-45-11" href="#__codelineno-45-11"></a><span class="n">coldPath</span>   <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">epav</span><span class="o">/</span><span class="n">colddb</span>
<a id="__codelineno-45-12" name="__codelineno-45-12" href="#__codelineno-45-12"></a><span class="n">thawedPath</span> <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">epav</span><span class="o">/</span><span class="n">thaweddb</span>
<a id="__codelineno-45-13" name="__codelineno-45-13" href="#__codelineno-45-13"></a>
<a id="__codelineno-45-14" name="__codelineno-45-14" href="#__codelineno-45-14"></a><span class="p">[</span><span class="n">epintel</span><span class="p">]</span>
<a id="__codelineno-45-15" name="__codelineno-45-15" href="#__codelineno-45-15"></a><span class="n">homePath</span>   <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">epintel</span><span class="o">/</span><span class="n">db</span>
<a id="__codelineno-45-16" name="__codelineno-45-16" href="#__codelineno-45-16"></a><span class="n">coldPath</span>   <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">epintel</span><span class="o">/</span><span class="n">colddb</span>
<a id="__codelineno-45-17" name="__codelineno-45-17" href="#__codelineno-45-17"></a><span class="n">thawedPath</span> <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">epintel</span><span class="o">/</span><span class="n">thaweddb</span>
<a id="__codelineno-45-18" name="__codelineno-45-18" href="#__codelineno-45-18"></a>
<a id="__codelineno-45-19" name="__codelineno-45-19" href="#__codelineno-45-19"></a><span class="p">[</span><span class="n">_metrics</span><span class="p">]</span>
<a id="__codelineno-45-20" name="__codelineno-45-20" href="#__codelineno-45-20"></a><span class="n">datatype</span><span class="o">=</span><span class="n">metric</span>
<a id="__codelineno-45-21" name="__codelineno-45-21" href="#__codelineno-45-21"></a><span class="n">homePath</span>   <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">_metrics</span><span class="o">/</span><span class="n">db</span>
<a id="__codelineno-45-22" name="__codelineno-45-22" href="#__codelineno-45-22"></a><span class="n">coldPath</span>   <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">_metrics</span><span class="o">/</span><span class="n">colddb</span>
<a id="__codelineno-45-23" name="__codelineno-45-23" href="#__codelineno-45-23"></a><span class="n">thawedPath</span> <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">_metrics</span><span class="o">/</span><span class="n">thaweddb</span>
<a id="__codelineno-45-24" name="__codelineno-45-24" href="#__codelineno-45-24"></a>
<a id="__codelineno-45-25" name="__codelineno-45-25" href="#__codelineno-45-25"></a><span class="p">[</span><span class="n">syslogng_fallback</span><span class="p">]</span>
<a id="__codelineno-45-26" name="__codelineno-45-26" href="#__codelineno-45-26"></a><span class="n">homePath</span>   <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">syslogng_fallback</span><span class="o">/</span><span class="n">db</span>
<a id="__codelineno-45-27" name="__codelineno-45-27" href="#__codelineno-45-27"></a><span class="n">coldPath</span>   <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">syslogng_fallback</span><span class="o">/</span><span class="n">colddb</span>
<a id="__codelineno-45-28" name="__codelineno-45-28" href="#__codelineno-45-28"></a><span class="n">thawedPath</span> <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">syslogng_fallback</span><span class="o">/</span><span class="n">thaweddb</span>
<a id="__codelineno-45-29" name="__codelineno-45-29" href="#__codelineno-45-29"></a>
<a id="__codelineno-45-30" name="__codelineno-45-30" href="#__codelineno-45-30"></a><span class="p">[</span><span class="n">test</span><span class="p">]</span>
<a id="__codelineno-45-31" name="__codelineno-45-31" href="#__codelineno-45-31"></a><span class="n">homePath</span>   <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">db</span>
<a id="__codelineno-45-32" name="__codelineno-45-32" href="#__codelineno-45-32"></a><span class="n">coldPath</span>   <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">colddb</span>
<a id="__codelineno-45-33" name="__codelineno-45-33" href="#__codelineno-45-33"></a><span class="n">thawedPath</span> <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">thaweddb</span>
<a id="__codelineno-45-34" name="__codelineno-45-34" href="#__codelineno-45-34"></a>
<a id="__codelineno-45-35" name="__codelineno-45-35" href="#__codelineno-45-35"></a><span class="p">[</span><span class="n">test2</span><span class="p">]</span>
<a id="__codelineno-45-36" name="__codelineno-45-36" href="#__codelineno-45-36"></a><span class="n">homePath</span>   <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">test2</span><span class="o">/</span><span class="n">db</span>
<a id="__codelineno-45-37" name="__codelineno-45-37" href="#__codelineno-45-37"></a><span class="n">coldPath</span>   <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">test2</span><span class="o">/</span><span class="n">colddb</span>
<a id="__codelineno-45-38" name="__codelineno-45-38" href="#__codelineno-45-38"></a><span class="n">thawedPath</span> <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">test2</span><span class="o">/</span><span class="n">thaweddb</span>
<a id="__codelineno-45-39" name="__codelineno-45-39" href="#__codelineno-45-39"></a>
<a id="__codelineno-45-40" name="__codelineno-45-40" href="#__codelineno-45-40"></a><span class="p">[</span><span class="n">infraops</span><span class="p">]</span>
<a id="__codelineno-45-41" name="__codelineno-45-41" href="#__codelineno-45-41"></a><span class="n">homePath</span>   <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">infraops</span><span class="o">/</span><span class="n">db</span>
<a id="__codelineno-45-42" name="__codelineno-45-42" href="#__codelineno-45-42"></a><span class="n">coldPath</span>   <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">infraops</span><span class="o">/</span><span class="n">colddb</span>
<a id="__codelineno-45-43" name="__codelineno-45-43" href="#__codelineno-45-43"></a><span class="n">thawedPath</span> <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">infraops</span><span class="o">/</span><span class="n">thaweddb</span>
<a id="__codelineno-45-44" name="__codelineno-45-44" href="#__codelineno-45-44"></a>
<a id="__codelineno-45-45" name="__codelineno-45-45" href="#__codelineno-45-45"></a><span class="p">[</span><span class="n">osnix</span><span class="p">]</span>
<a id="__codelineno-45-46" name="__codelineno-45-46" href="#__codelineno-45-46"></a><span class="n">homePath</span>   <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">osnix</span><span class="o">/</span><span class="n">db</span>
<a id="__codelineno-45-47" name="__codelineno-45-47" href="#__codelineno-45-47"></a><span class="n">coldPath</span>   <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">osnix</span><span class="o">/</span><span class="n">colddb</span>
<a id="__codelineno-45-48" name="__codelineno-45-48" href="#__codelineno-45-48"></a><span class="n">thawedPath</span> <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">osnix</span><span class="o">/</span><span class="n">thaweddb</span>
<a id="__codelineno-45-49" name="__codelineno-45-49" href="#__codelineno-45-49"></a>
<a id="__codelineno-45-50" name="__codelineno-45-50" href="#__codelineno-45-50"></a><span class="p">[</span><span class="n">oswin</span><span class="p">]</span>
<a id="__codelineno-45-51" name="__codelineno-45-51" href="#__codelineno-45-51"></a><span class="n">homePath</span>   <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">oswin</span><span class="o">/</span><span class="n">db</span>
<a id="__codelineno-45-52" name="__codelineno-45-52" href="#__codelineno-45-52"></a><span class="n">coldPath</span>   <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">oswin</span><span class="o">/</span><span class="n">colddb</span>
<a id="__codelineno-45-53" name="__codelineno-45-53" href="#__codelineno-45-53"></a><span class="n">thawedPath</span> <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">oswin</span><span class="o">/</span><span class="n">thaweddb</span>
<a id="__codelineno-45-54" name="__codelineno-45-54" href="#__codelineno-45-54"></a>
<a id="__codelineno-45-55" name="__codelineno-45-55" href="#__codelineno-45-55"></a><span class="p">[</span><span class="n">oswinsec</span><span class="p">]</span>
<a id="__codelineno-45-56" name="__codelineno-45-56" href="#__codelineno-45-56"></a><span class="n">homePath</span>   <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">oswinsec</span><span class="o">/</span><span class="n">db</span>
<a id="__codelineno-45-57" name="__codelineno-45-57" href="#__codelineno-45-57"></a><span class="n">coldPath</span>   <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">oswinsec</span><span class="o">/</span><span class="n">colddb</span>
<a id="__codelineno-45-58" name="__codelineno-45-58" href="#__codelineno-45-58"></a><span class="n">thawedPath</span> <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">oswinsec</span><span class="o">/</span><span class="n">thaweddb</span>
<a id="__codelineno-45-59" name="__codelineno-45-59" href="#__codelineno-45-59"></a>
<a id="__codelineno-45-60" name="__codelineno-45-60" href="#__codelineno-45-60"></a><span class="p">[</span><span class="n">netauth</span><span class="p">]</span>
<a id="__codelineno-45-61" name="__codelineno-45-61" href="#__codelineno-45-61"></a><span class="n">homePath</span>   <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">netauth</span><span class="o">/</span><span class="n">db</span>
<a id="__codelineno-45-62" name="__codelineno-45-62" href="#__codelineno-45-62"></a><span class="n">coldPath</span>   <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">netauth</span><span class="o">/</span><span class="n">colddb</span>
<a id="__codelineno-45-63" name="__codelineno-45-63" href="#__codelineno-45-63"></a><span class="n">thawedPath</span> <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">netauth</span><span class="o">/</span><span class="n">thaweddb</span>
<a id="__codelineno-45-64" name="__codelineno-45-64" href="#__codelineno-45-64"></a>
<a id="__codelineno-45-65" name="__codelineno-45-65" href="#__codelineno-45-65"></a><span class="p">[</span><span class="n">netdlp</span><span class="p">]</span>
<a id="__codelineno-45-66" name="__codelineno-45-66" href="#__codelineno-45-66"></a><span class="n">homePath</span>   <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">netdlp</span><span class="o">/</span><span class="n">db</span>
<a id="__codelineno-45-67" name="__codelineno-45-67" href="#__codelineno-45-67"></a><span class="n">coldPath</span>   <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">netdlp</span><span class="o">/</span><span class="n">colddb</span>
<a id="__codelineno-45-68" name="__codelineno-45-68" href="#__codelineno-45-68"></a><span class="n">thawedPath</span> <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">netdlp</span><span class="o">/</span><span class="n">thaweddb</span>
<a id="__codelineno-45-69" name="__codelineno-45-69" href="#__codelineno-45-69"></a>
<a id="__codelineno-45-70" name="__codelineno-45-70" href="#__codelineno-45-70"></a><span class="p">[</span><span class="n">netdns</span><span class="p">]</span>
<a id="__codelineno-45-71" name="__codelineno-45-71" href="#__codelineno-45-71"></a><span class="n">homePath</span>   <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">netdns</span><span class="o">/</span><span class="n">db</span>
<a id="__codelineno-45-72" name="__codelineno-45-72" href="#__codelineno-45-72"></a><span class="n">coldPath</span>   <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">netdns</span><span class="o">/</span><span class="n">colddb</span>
<a id="__codelineno-45-73" name="__codelineno-45-73" href="#__codelineno-45-73"></a><span class="n">thawedPath</span> <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">netdns</span><span class="o">/</span><span class="n">thaweddb</span>
<a id="__codelineno-45-74" name="__codelineno-45-74" href="#__codelineno-45-74"></a>
<a id="__codelineno-45-75" name="__codelineno-45-75" href="#__codelineno-45-75"></a><span class="p">[</span><span class="n">netfw</span><span class="p">]</span>
<a id="__codelineno-45-76" name="__codelineno-45-76" href="#__codelineno-45-76"></a><span class="n">homePath</span>   <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">netfw</span><span class="o">/</span><span class="n">db</span>
<a id="__codelineno-45-77" name="__codelineno-45-77" href="#__codelineno-45-77"></a><span class="n">coldPath</span>   <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">netfw</span><span class="o">/</span><span class="n">colddb</span>
<a id="__codelineno-45-78" name="__codelineno-45-78" href="#__codelineno-45-78"></a><span class="n">thawedPath</span> <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">netfw</span><span class="o">/</span><span class="n">thaweddb</span>
<a id="__codelineno-45-79" name="__codelineno-45-79" href="#__codelineno-45-79"></a>
<a id="__codelineno-45-80" name="__codelineno-45-80" href="#__codelineno-45-80"></a><span class="p">[</span><span class="n">netids</span><span class="p">]</span>
<a id="__codelineno-45-81" name="__codelineno-45-81" href="#__codelineno-45-81"></a><span class="n">homePath</span>   <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">netids</span><span class="o">/</span><span class="n">db</span>
<a id="__codelineno-45-82" name="__codelineno-45-82" href="#__codelineno-45-82"></a><span class="n">coldPath</span>   <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">netids</span><span class="o">/</span><span class="n">colddb</span>
<a id="__codelineno-45-83" name="__codelineno-45-83" href="#__codelineno-45-83"></a><span class="n">thawedPath</span> <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">netids</span><span class="o">/</span><span class="n">thaweddb</span>
<a id="__codelineno-45-84" name="__codelineno-45-84" href="#__codelineno-45-84"></a>
<a id="__codelineno-45-85" name="__codelineno-45-85" href="#__codelineno-45-85"></a><span class="p">[</span><span class="n">netipam</span><span class="p">]</span>
<a id="__codelineno-45-86" name="__codelineno-45-86" href="#__codelineno-45-86"></a><span class="n">homePath</span>   <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">netipam</span><span class="o">/</span><span class="n">db</span>
<a id="__codelineno-45-87" name="__codelineno-45-87" href="#__codelineno-45-87"></a><span class="n">coldPath</span>   <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">netipam</span><span class="o">/</span><span class="n">colddb</span>
<a id="__codelineno-45-88" name="__codelineno-45-88" href="#__codelineno-45-88"></a><span class="n">thawedPath</span> <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">netipam</span><span class="o">/</span><span class="n">thaweddb</span>
<a id="__codelineno-45-89" name="__codelineno-45-89" href="#__codelineno-45-89"></a>
<a id="__codelineno-45-90" name="__codelineno-45-90" href="#__codelineno-45-90"></a><span class="p">[</span><span class="n">netops</span><span class="p">]</span>
<a id="__codelineno-45-91" name="__codelineno-45-91" href="#__codelineno-45-91"></a><span class="n">homePath</span>   <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">netops</span><span class="o">/</span><span class="n">db</span>
<a id="__codelineno-45-92" name="__codelineno-45-92" href="#__codelineno-45-92"></a><span class="n">coldPath</span>   <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">netops</span><span class="o">/</span><span class="n">colddb</span>
<a id="__codelineno-45-93" name="__codelineno-45-93" href="#__codelineno-45-93"></a><span class="n">thawedPath</span> <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">netops</span><span class="o">/</span><span class="n">thaweddb</span>
<a id="__codelineno-45-94" name="__codelineno-45-94" href="#__codelineno-45-94"></a>
<a id="__codelineno-45-95" name="__codelineno-45-95" href="#__codelineno-45-95"></a><span class="p">[</span><span class="n">netproxy</span><span class="p">]</span>
<a id="__codelineno-45-96" name="__codelineno-45-96" href="#__codelineno-45-96"></a><span class="n">homePath</span>   <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">netproxy</span><span class="o">/</span><span class="n">db</span>
<a id="__codelineno-45-97" name="__codelineno-45-97" href="#__codelineno-45-97"></a><span class="n">coldPath</span>   <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">netproxy</span><span class="o">/</span><span class="n">colddb</span>
<a id="__codelineno-45-98" name="__codelineno-45-98" href="#__codelineno-45-98"></a><span class="n">thawedPath</span> <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">netproxy</span><span class="o">/</span><span class="n">thaweddb</span>
<a id="__codelineno-45-99" name="__codelineno-45-99" href="#__codelineno-45-99"></a>
<a id="__codelineno-45-100" name="__codelineno-45-100" href="#__codelineno-45-100"></a><span class="p">[</span><span class="n">netwaf</span><span class="p">]</span>
<a id="__codelineno-45-101" name="__codelineno-45-101" href="#__codelineno-45-101"></a><span class="n">homePath</span>   <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">netwaf</span><span class="o">/</span><span class="n">db</span>
<a id="__codelineno-45-102" name="__codelineno-45-102" href="#__codelineno-45-102"></a><span class="n">coldPath</span>   <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">netwaf</span><span class="o">/</span><span class="n">colddb</span>
<a id="__codelineno-45-103" name="__codelineno-45-103" href="#__codelineno-45-103"></a><span class="n">thawedPath</span> <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">netwaf</span><span class="o">/</span><span class="n">thaweddb</span>
<a id="__codelineno-45-104" name="__codelineno-45-104" href="#__codelineno-45-104"></a>
<a id="__codelineno-45-105" name="__codelineno-45-105" href="#__codelineno-45-105"></a><span class="p">[</span><span class="n">email</span><span class="p">]</span>
<a id="__codelineno-45-106" name="__codelineno-45-106" href="#__codelineno-45-106"></a><span class="n">homePath</span>   <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">email</span><span class="o">/</span><span class="n">db</span>
<a id="__codelineno-45-107" name="__codelineno-45-107" href="#__codelineno-45-107"></a><span class="n">coldPath</span>   <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">email</span><span class="o">/</span><span class="n">colddb</span>
<a id="__codelineno-45-108" name="__codelineno-45-108" href="#__codelineno-45-108"></a><span class="n">thawedPath</span> <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">email</span><span class="o">/</span><span class="n">thaweddb</span>
<a id="__codelineno-45-109" name="__codelineno-45-109" href="#__codelineno-45-109"></a>
<a id="__codelineno-45-110" name="__codelineno-45-110" href="#__codelineno-45-110"></a><span class="p">[</span><span class="n">netlb</span><span class="p">]</span>
<a id="__codelineno-45-111" name="__codelineno-45-111" href="#__codelineno-45-111"></a><span class="n">homePath</span>   <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">netlb</span><span class="o">/</span><span class="n">db</span>
<a id="__codelineno-45-112" name="__codelineno-45-112" href="#__codelineno-45-112"></a><span class="n">coldPath</span>   <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">netlb</span><span class="o">/</span><span class="n">colddb</span>
<a id="__codelineno-45-113" name="__codelineno-45-113" href="#__codelineno-45-113"></a><span class="n">thawedPath</span> <span class="o">=</span> <span class="err">$</span><span class="n">SPLUNK_DB</span><span class="o">/</span><span class="n">netlb</span><span class="o">/</span><span class="n">thaweddb</span>
</code></pre></div>
<p>In the<code>/opt/splunk/bin</code> directory, restart Splunk Enterprise as the <code>splunk</code> user.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a>./splunk<span class="w"> </span>restart
</code></pre></div>
<p>On the Splunk web interface, navigate to Settings, then Indexes. Verify that the SC4S default indexes have been created. Use the filter search bar to find indexes if needed.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%205.png" data-desc-position="bottom"><img alt="image.png" src="image%205.png"></a></p>
<h3 id="creating-a-hec-token"><strong>Creating a HEC Token</strong></h3>
<p>On the Splunk Web UI, navigate to Settings &gt; Data Inputs &gt; HTTP Event Collector &gt; Global Settings. Select Enabled for All Tokens. Set main as the Default Index. Uncheck Enable SSL. Leave the HTTP Port Number as 8088. Click Save.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%206.png" data-desc-position="bottom"><img alt="image.png" src="image%206.png"></a></p>
<p>Click New Token, name it 'sc4s_token', and click Next.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%207.png" data-desc-position="bottom"><img alt="image.png" src="image%207.png"></a></p>
<p>Leave Source Type as Automatic. Leave Selected Allowed Indexes blank. Select main as the Default Index. Click Review, then Submit.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%208.png" data-desc-position="bottom"><img alt="image.png" src="image%208.png"></a></p>
<p>Copy your Token Value and save it in a notepad (you will need this later). You can also find your token value under Settings &gt; Data Inputs &gt; HTTP Event Collector.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%209.png" data-desc-position="bottom"><img alt="image.png" src="image%209.png"></a></p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2010.png" data-desc-position="bottom"><img alt="image.png" src="image%2010.png"></a></p>
<h3 id="loading-sc4s-container-image">Loading SC4S Container Image</h3>
<p>In a tab, as a standard user, use Docker to load the SC4S container image. Make a note of the container ID and image name. If you are using CentOS, replace <code>docker</code> with <code>podman</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a><span class="n">cd</span> <span class="o">~/</span><span class="n">splunk</span><span class="o">-</span><span class="n">offline</span><span class="o">/</span><span class="n">sc4s</span>
<a id="__codelineno-47-2" name="__codelineno-47-2" href="#__codelineno-47-2"></a><span class="n">sudo</span> <span class="n">docker</span> <span class="n">load</span> <span class="o">&lt;</span> <span class="n">oci_container</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a><span class="c1">#Example output</span>
<a id="__codelineno-48-2" name="__codelineno-48-2" href="#__codelineno-48-2"></a><span class="n">Loaded</span> <span class="n">image</span><span class="p">:</span> <span class="n">ghcr</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">splunk</span><span class="o">/</span><span class="n">splunk</span><span class="o">-</span><span class="n">connect</span><span class="o">-</span><span class="k">for</span><span class="o">-</span><span class="n">syslog</span><span class="o">/</span><span class="n">container3</span><span class="p">:</span><span class="mf">3.34.3</span>
</code></pre></div>
<p>Use the container ID to create a local label using docker. </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a><span class="n">sudo</span> <span class="n">docker</span> <span class="n">tag</span> <span class="n">ghcr</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">splunk</span><span class="o">/</span><span class="n">splunk</span><span class="o">-</span><span class="n">connect</span><span class="o">-</span><span class="k">for</span><span class="o">-</span><span class="n">syslog</span><span class="o">/</span><span class="n">container3</span><span class="p">:</span><span class="mf">3.34.3</span> <span class="n">sc4slocal</span><span class="p">:</span><span class="n">latest</span>
</code></pre></div>
<p>Create the systemd unit file&nbsp;<code>/lib/systemd/system/sc4s.service</code> and copy and paste the following content:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a><span class="n">sudo</span> <span class="n">nano</span> <span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">sc4s</span><span class="o">.</span><span class="n">service</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a><span class="o">[</span>Unit<span class="o">]</span>
<a id="__codelineno-51-2" name="__codelineno-51-2" href="#__codelineno-51-2"></a><span class="nv">Description</span><span class="o">=</span>SC4S<span class="w"> </span>Container
<a id="__codelineno-51-3" name="__codelineno-51-3" href="#__codelineno-51-3"></a><span class="nv">Wants</span><span class="o">=</span>NetworkManager.service<span class="w"> </span>network-online.target<span class="w"> </span>docker.service
<a id="__codelineno-51-4" name="__codelineno-51-4" href="#__codelineno-51-4"></a><span class="nv">After</span><span class="o">=</span>NetworkManager.service<span class="w"> </span>network-online.target<span class="w"> </span>docker.service
<a id="__codelineno-51-5" name="__codelineno-51-5" href="#__codelineno-51-5"></a><span class="nv">Requires</span><span class="o">=</span>docker.service
<a id="__codelineno-51-6" name="__codelineno-51-6" href="#__codelineno-51-6"></a>
<a id="__codelineno-51-7" name="__codelineno-51-7" href="#__codelineno-51-7"></a><span class="o">[</span>Install<span class="o">]</span>
<a id="__codelineno-51-8" name="__codelineno-51-8" href="#__codelineno-51-8"></a><span class="nv">WantedBy</span><span class="o">=</span>multi-user.target
<a id="__codelineno-51-9" name="__codelineno-51-9" href="#__codelineno-51-9"></a>
<a id="__codelineno-51-10" name="__codelineno-51-10" href="#__codelineno-51-10"></a><span class="o">[</span>Service<span class="o">]</span>
<a id="__codelineno-51-11" name="__codelineno-51-11" href="#__codelineno-51-11"></a><span class="nv">Environment</span><span class="o">=</span><span class="s2">"SC4S_IMAGE=sc4slocal:latest"</span>
<a id="__codelineno-51-12" name="__codelineno-51-12" href="#__codelineno-51-12"></a>
<a id="__codelineno-51-13" name="__codelineno-51-13" href="#__codelineno-51-13"></a><span class="c1"># Required mount point for syslog-ng persist data (including disk buffer)</span>
<a id="__codelineno-51-14" name="__codelineno-51-14" href="#__codelineno-51-14"></a><span class="nv">Environment</span><span class="o">=</span><span class="s2">"SC4S_PERSIST_MOUNT=splunk-sc4s-var:/var/lib/syslog-ng"</span>
<a id="__codelineno-51-15" name="__codelineno-51-15" href="#__codelineno-51-15"></a>
<a id="__codelineno-51-16" name="__codelineno-51-16" href="#__codelineno-51-16"></a><span class="c1"># Optional mount point for local overrides and configurations; see notes in docs</span>
<a id="__codelineno-51-17" name="__codelineno-51-17" href="#__codelineno-51-17"></a><span class="nv">Environment</span><span class="o">=</span><span class="s2">"SC4S_LOCAL_MOUNT=/opt/sc4s/local:/etc/syslog-ng/conf.d/local:z"</span>
<a id="__codelineno-51-18" name="__codelineno-51-18" href="#__codelineno-51-18"></a>
<a id="__codelineno-51-19" name="__codelineno-51-19" href="#__codelineno-51-19"></a><span class="c1"># Optional mount point for local disk archive (EWMM output) files</span>
<a id="__codelineno-51-20" name="__codelineno-51-20" href="#__codelineno-51-20"></a><span class="nv">Environment</span><span class="o">=</span><span class="s2">"SC4S_ARCHIVE_MOUNT=/opt/sc4s/archive:/var/lib/syslog-ng/archive:z"</span>
<a id="__codelineno-51-21" name="__codelineno-51-21" href="#__codelineno-51-21"></a>
<a id="__codelineno-51-22" name="__codelineno-51-22" href="#__codelineno-51-22"></a><span class="c1"># Map location of TLS custom TLS</span>
<a id="__codelineno-51-23" name="__codelineno-51-23" href="#__codelineno-51-23"></a><span class="nv">Environment</span><span class="o">=</span><span class="s2">"SC4S_TLS_MOUNT=/opt/sc4s/tls:/etc/syslog-ng/tls:z"</span>
<a id="__codelineno-51-24" name="__codelineno-51-24" href="#__codelineno-51-24"></a>
<a id="__codelineno-51-25" name="__codelineno-51-25" href="#__codelineno-51-25"></a><span class="nv">TimeoutStartSec</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-51-26" name="__codelineno-51-26" href="#__codelineno-51-26"></a>
<a id="__codelineno-51-27" name="__codelineno-51-27" href="#__codelineno-51-27"></a><span class="c1">#ExecStartPre=/usr/bin/docker pull $SC4S_IMAGE</span>
<a id="__codelineno-51-28" name="__codelineno-51-28" href="#__codelineno-51-28"></a>
<a id="__codelineno-51-29" name="__codelineno-51-29" href="#__codelineno-51-29"></a><span class="c1"># Note: /usr/bin/bash will not be valid path for all OS</span>
<a id="__codelineno-51-30" name="__codelineno-51-30" href="#__codelineno-51-30"></a><span class="c1"># when startup fails on running bash check if the path is correct</span>
<a id="__codelineno-51-31" name="__codelineno-51-31" href="#__codelineno-51-31"></a><span class="nv">ExecStartPre</span><span class="o">=</span>/usr/bin/bash<span class="w"> </span>-c<span class="w"> </span><span class="s2">"/usr/bin/systemctl set-environment SC4SHOST=</span><span class="k">$(</span>hostname<span class="w"> </span>-s<span class="k">)</span><span class="s2">"</span>
<a id="__codelineno-51-32" name="__codelineno-51-32" href="#__codelineno-51-32"></a>
<a id="__codelineno-51-33" name="__codelineno-51-33" href="#__codelineno-51-33"></a><span class="c1"># Note: Prevent the error 'The container name "/SC4S" is already in use by container &lt;container_id&gt;. You have to remove (or rename) that container to be able to reuse that name.'</span>
<a id="__codelineno-51-34" name="__codelineno-51-34" href="#__codelineno-51-34"></a><span class="nv">ExecStartPre</span><span class="o">=</span>/usr/bin/bash<span class="w"> </span>-c<span class="w"> </span><span class="s2">"/usr/bin/docker rm SC4S &gt; /dev/null 2&gt;&amp;1 || true"</span>
<a id="__codelineno-51-35" name="__codelineno-51-35" href="#__codelineno-51-35"></a><span class="nv">ExecStart</span><span class="o">=</span>/usr/bin/docker<span class="w"> </span>run<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-51-36" name="__codelineno-51-36" href="#__codelineno-51-36"></a><span class="w">        </span>-e<span class="w"> </span><span class="s2">"SC4S_CONTAINER_HOST=</span><span class="si">${</span><span class="nv">SC4SHOST</span><span class="si">}</span><span class="s2">"</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-51-37" name="__codelineno-51-37" href="#__codelineno-51-37"></a><span class="w">        </span>-v<span class="w"> </span><span class="s2">"</span><span class="nv">$SC4S_PERSIST_MOUNT</span><span class="s2">"</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-51-38" name="__codelineno-51-38" href="#__codelineno-51-38"></a><span class="w">        </span>-v<span class="w"> </span><span class="s2">"</span><span class="nv">$SC4S_LOCAL_MOUNT</span><span class="s2">"</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-51-39" name="__codelineno-51-39" href="#__codelineno-51-39"></a><span class="w">        </span>-v<span class="w"> </span><span class="s2">"</span><span class="nv">$SC4S_ARCHIVE_MOUNT</span><span class="s2">"</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-51-40" name="__codelineno-51-40" href="#__codelineno-51-40"></a><span class="w">        </span>-v<span class="w"> </span><span class="s2">"</span><span class="nv">$SC4S_TLS_MOUNT</span><span class="s2">"</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-51-41" name="__codelineno-51-41" href="#__codelineno-51-41"></a><span class="w">        </span>--env-file<span class="o">=</span>/opt/sc4s/env_file<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-51-42" name="__codelineno-51-42" href="#__codelineno-51-42"></a><span class="w">        </span>--network<span class="w"> </span>host<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-51-43" name="__codelineno-51-43" href="#__codelineno-51-43"></a><span class="w">        </span>--name<span class="w"> </span>SC4S<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-51-44" name="__codelineno-51-44" href="#__codelineno-51-44"></a><span class="w">        </span>--rm<span class="w"> </span><span class="nv">$SC4S_IMAGE</span>
<a id="__codelineno-51-45" name="__codelineno-51-45" href="#__codelineno-51-45"></a>
<a id="__codelineno-51-46" name="__codelineno-51-46" href="#__codelineno-51-46"></a><span class="nv">Restart</span><span class="o">=</span>on-failure
</code></pre></div>
<h3 id="configuring-ipv4-forwarding"><strong>Configuring IPv4 forwarding</strong></h3>
<p>IPv4 forwarding is not enabled by default. IPv4 forwarding must be enabled for container networking.</p>
<p>To check that IPv4 forwarding is enabled:&nbsp;</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a><span class="n">sudo</span> <span class="n">sysctl</span> <span class="n">net</span><span class="o">.</span><span class="n">ipv4</span><span class="o">.</span><span class="n">ip_forward</span>
</code></pre></div>
<p>To enable IPv4 forwarding:&nbsp;</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a><span class="n">sudo</span> <span class="n">sysctl</span> <span class="n">net</span><span class="o">.</span><span class="n">ipv4</span><span class="o">.</span><span class="n">ip_forward</span><span class="o">=</span><span class="mi">1</span>
</code></pre></div>
<p>To ensure your changes persist upon reboot, define sysctl settings through files in&nbsp;<code>/usr/lib/sysctl.d/</code> and&nbsp;<code>/etc/sysctl.d/</code>. To override only specific settings, either add a file with a lexically later name in&nbsp;<code>/etc/sysctl.d/</code>&nbsp;and put following setting there or find this specific setting in one of the existing configuration files and set the value to&nbsp;<code>1</code>. </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a><span class="nb">cd</span><span class="w"> </span>/usr/lib/sysctl.d/
<a id="__codelineno-54-2" name="__codelineno-54-2" href="#__codelineno-54-2"></a>sudo<span class="w"> </span>nano<span class="w"> </span><span class="m">100</span>-custom.conf
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a>net.ipv4.ip_forward<span class="o">=</span><span class="m">1</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-56-1" name="__codelineno-56-1" href="#__codelineno-56-1"></a>cyber@Splunk:/usr/lib/sysctl.d$<span class="w"> </span>ls
<a id="__codelineno-56-2" name="__codelineno-56-2" href="#__codelineno-56-2"></a><span class="m">100</span>-custom.conf<span class="w">  </span><span class="m">10</span>-apparmor.conf<span class="w">  </span><span class="m">30</span>-tracker.conf<span class="w">  </span><span class="m">50</span>-bubblewrap.conf<span class="w">  </span><span class="m">50</span>-pid-max.conf<span class="w">  </span><span class="m">99</span>-protect-links.conf
</code></pre></div>
<p>Repeat the same steps for <code>/etc/sysctl.d/</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-57-1" name="__codelineno-57-1" href="#__codelineno-57-1"></a><span class="nb">cd</span><span class="w"> </span>/etc/sysctl.d/
<a id="__codelineno-57-2" name="__codelineno-57-2" href="#__codelineno-57-2"></a>sudo<span class="w"> </span>nano<span class="w"> </span><span class="m">100</span>-custom.conf
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-58-1" name="__codelineno-58-1" href="#__codelineno-58-1"></a><span class="n">net</span><span class="o">.</span><span class="n">ipv4</span><span class="o">.</span><span class="n">ip_forward</span><span class="o">=</span><span class="mi">1</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-59-1" name="__codelineno-59-1" href="#__codelineno-59-1"></a><span class="n">cyber</span><span class="nd">@Splunk</span><span class="p">:</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">sysctl</span><span class="o">.</span><span class="n">d</span><span class="err">$</span> <span class="n">ls</span>
<a id="__codelineno-59-2" name="__codelineno-59-2" href="#__codelineno-59-2"></a><span class="mi">100</span><span class="o">-</span><span class="n">custom</span><span class="o">.</span><span class="n">conf</span>           <span class="mi">10</span><span class="o">-</span><span class="n">ipv6</span><span class="o">-</span><span class="n">privacy</span><span class="o">.</span><span class="n">conf</span>      <span class="mi">10</span><span class="o">-</span><span class="n">magic</span><span class="o">-</span><span class="n">sysrq</span><span class="o">.</span><span class="n">conf</span>  <span class="mi">10</span><span class="o">-</span><span class="n">network</span><span class="o">-</span><span class="n">security</span><span class="o">.</span><span class="n">conf</span>  <span class="mi">10</span><span class="o">-</span><span class="n">zeropage</span><span class="o">.</span><span class="n">conf</span>  <span class="n">README</span><span class="o">.</span><span class="n">sysctl</span>
<a id="__codelineno-59-3" name="__codelineno-59-3" href="#__codelineno-59-3"></a><span class="mi">10</span><span class="o">-</span><span class="n">console</span><span class="o">-</span><span class="n">messages</span><span class="o">.</span><span class="n">conf</span>  <span class="mi">10</span><span class="o">-</span><span class="n">kernel</span><span class="o">-</span><span class="n">hardening</span><span class="o">.</span><span class="n">conf</span>  <span class="mi">10</span><span class="o">-</span><span class="nb">map</span><span class="o">-</span><span class="n">count</span><span class="o">.</span><span class="n">conf</span>    <span class="mi">10</span><span class="o">-</span><span class="n">ptrace</span><span class="o">.</span><span class="n">conf</span>            <span class="mi">99</span><span class="o">-</span><span class="n">sysctl</span><span class="o">.</span><span class="n">conf</span>
</code></pre></div>
<p>Create a Docker volume for SC4S disk buffer and state files.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-60-1" name="__codelineno-60-1" href="#__codelineno-60-1"></a><span class="n">sudo</span> <span class="n">docker</span> <span class="n">volume</span> <span class="n">create</span> <span class="n">splunk</span><span class="o">-</span><span class="n">sc4s</span><span class="o">-</span><span class="n">var</span>
</code></pre></div>
<p>Create directories to be used as a mount point for local overrides and configurations:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-61-1" name="__codelineno-61-1" href="#__codelineno-61-1"></a><span class="n">sudo</span> <span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">sc4s</span><span class="o">/</span><span class="n">local</span>
<a id="__codelineno-61-2" name="__codelineno-61-2" href="#__codelineno-61-2"></a><span class="n">sudo</span> <span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">sc4s</span><span class="o">/</span><span class="n">archive</span>
<a id="__codelineno-61-3" name="__codelineno-61-3" href="#__codelineno-61-3"></a><span class="n">sudo</span> <span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">sc4s</span><span class="o">/</span><span class="n">tls</span>
</code></pre></div>
<p>Create the environment file&nbsp;<code>/opt/sc4s/env_file</code>&nbsp;and replace the HEC_URL and HEC_TOKEN as necessary:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-62-1" name="__codelineno-62-1" href="#__codelineno-62-1"></a><span class="n">sudo</span> <span class="n">nano</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">sc4s</span><span class="o">/</span><span class="n">env_file</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-63-1" name="__codelineno-63-1" href="#__codelineno-63-1"></a><span class="n">SC4S_DEST_SPLUNK_HEC_DEFAULT_URL</span><span class="o">=</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.0.0.100</span><span class="p">:</span><span class="mi">8088</span>
<a id="__codelineno-63-2" name="__codelineno-63-2" href="#__codelineno-63-2"></a><span class="n">SC4S_DEST_SPLUNK_HEC_DEFAULT_TOKEN</span><span class="o">=</span><span class="p">(</span><span class="n">HEC_Token_value</span><span class="p">)</span>
<a id="__codelineno-63-3" name="__codelineno-63-3" href="#__codelineno-63-3"></a><span class="c1">#Uncomment the following line if using untrusted SSL certificates</span>
<a id="__codelineno-63-4" name="__codelineno-63-4" href="#__codelineno-63-4"></a><span class="n">SC4S_DEST_SPLUNK_HEC_DEFAULT_TLS_VERIFY</span><span class="o">=</span><span class="n">no</span>
</code></pre></div>
<h3 id="testing-sc4s"><strong>Testing SC4S</strong></h3>
<p>Enable and start SC4S. Verify SC4S is active and running (exit with <code>q</code>).</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-64-1" name="__codelineno-64-1" href="#__codelineno-64-1"></a><span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">daemon</span><span class="o">-</span><span class="n">reload</span>
<a id="__codelineno-64-2" name="__codelineno-64-2" href="#__codelineno-64-2"></a><span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">enable</span> <span class="n">sc4s</span>
<a id="__codelineno-64-3" name="__codelineno-64-3" href="#__codelineno-64-3"></a><span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">start</span> <span class="n">sc4s</span>
<a id="__codelineno-64-4" name="__codelineno-64-4" href="#__codelineno-64-4"></a><span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">status</span> <span class="n">sc4s</span>
</code></pre></div>
<p>Check Docker logs for errors:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-65-1" name="__codelineno-65-1" href="#__codelineno-65-1"></a><span class="n">sudo</span> <span class="n">docker</span> <span class="n">logs</span> <span class="n">SC4S</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-66-1" name="__codelineno-66-1" href="#__codelineno-66-1"></a><span class="c1">#Example Output</span>
<a id="__codelineno-66-2" name="__codelineno-66-2" href="#__codelineno-66-2"></a><span class="n">SC4S_ENV_CHECK_HEC</span><span class="p">:</span> <span class="n">Splunk</span> <span class="n">HEC</span> <span class="n">connection</span> <span class="n">test</span> <span class="n">successful</span> <span class="n">to</span> <span class="n">index</span><span class="o">=</span><span class="n">main</span> <span class="k">for</span> <span class="n">sourcetype</span><span class="o">=</span><span class="n">sc4s</span><span class="p">:</span><span class="n">fallback</span><span class="o">...</span>
<a id="__codelineno-66-3" name="__codelineno-66-3" href="#__codelineno-66-3"></a><span class="n">SC4S_ENV_CHECK_HEC</span><span class="p">:</span> <span class="n">Splunk</span> <span class="n">HEC</span> <span class="n">connection</span> <span class="n">test</span> <span class="n">successful</span> <span class="n">to</span> <span class="n">index</span><span class="o">=</span><span class="n">main</span> <span class="k">for</span> <span class="n">sourcetype</span><span class="o">=</span><span class="n">sc4s</span><span class="p">:</span><span class="n">events</span><span class="o">...</span>
<a id="__codelineno-66-4" name="__codelineno-66-4" href="#__codelineno-66-4"></a><span class="n">syslog</span><span class="o">-</span><span class="n">ng</span> <span class="n">checking</span> <span class="n">config</span>
<a id="__codelineno-66-5" name="__codelineno-66-5" href="#__codelineno-66-5"></a><span class="n">sc4s</span> <span class="n">version</span><span class="o">=</span><span class="mf">3.30.0</span>
<a id="__codelineno-66-6" name="__codelineno-66-6" href="#__codelineno-66-6"></a><span class="n">starting</span> <span class="n">goss</span>
<a id="__codelineno-66-7" name="__codelineno-66-7" href="#__codelineno-66-7"></a><span class="n">starting</span> <span class="n">syslog</span><span class="o">-</span><span class="n">ng</span>
</code></pre></div>
<p>Search on Splunk for successful installation of SC4S. Make sure to select All time.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-67-1" name="__codelineno-67-1" href="#__codelineno-67-1"></a><span class="nv">index</span><span class="o">=</span>*<span class="w"> </span><span class="nv">sourcetype</span><span class="o">=</span>sc4s:events<span class="w"> </span><span class="s2">"starting up"</span>
</code></pre></div>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2011.png" data-desc-position="bottom"><img alt="image.png" src="image%2011.png"></a></p>
<p>Send sample data to UDP port 514: </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-68-1" name="__codelineno-68-1" href="#__codelineno-68-1"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">"Hello SC4S"</span><span class="w"> </span>&gt;<span class="w"> </span>/dev/udp/10.0.0.100/514
</code></pre></div>
<p>Search in Splunk to verify successful receipt of sample data on UDP port 514:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-69-1" name="__codelineno-69-1" href="#__codelineno-69-1"></a><span class="nv">index</span><span class="o">=</span>*<span class="w"> </span><span class="s2">"Hello SC4S"</span>
</code></pre></div>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2012.png" data-desc-position="bottom"><img alt="image.png" src="image%2012.png"></a></p>
<p>Earlier, we configured FortiGate to send logs on UDP port 514. Since SC4S is configured to receive logs on UDP port 514, we should now see FortiGate logs. Verify that SC4S is receiving FortiGate event and traffic logs with source <code>sc4s</code>. It may take some time for the logs to appear.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-70-1" name="__codelineno-70-1" href="#__codelineno-70-1"></a><span class="nv">index</span><span class="o">=</span>*<span class="w"> </span><span class="nv">sourcetype</span><span class="o">=</span>fgt_event
</code></pre></div>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2013.png" data-desc-position="bottom"><img alt="image.png" src="image%2013.png"></a></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-71-1" name="__codelineno-71-1" href="#__codelineno-71-1"></a><span class="nv">index</span><span class="o">=</span>*<span class="w"> </span><span class="nv">sourcetype</span><span class="o">=</span>fgt_traffic
</code></pre></div>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2014.png" data-desc-position="bottom"><img alt="image.png" src="image%2014.png"></a></p>
<h2 id="ingesting-fortigate-logs-through-fortigate-app-option-2"><strong>Ingesting FortiGate Logs through FortiGate App (Option 2)</strong></h2>
<p>If SC4S does not work for your environment, another option to ingest FortiGate logs on Splunk is through FortiGate App. On Splunk web UI, navigate to Manage Apps, then Install from file. Upload the FortiGate App (tar archive) from <code>~/splunk-offline/apps</code> directory. Check the upgrade box. </p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2015.png" data-desc-position="bottom"><img alt="image.png" src="image%2015.png"></a></p>
<h3 id="adding-udp-data-input"><strong>Adding UDP Data Input</strong></h3>
<p>Navigate to Settings, Data Inputs, then UDP on Splunk Web UI. Click New Local UDP. For Port, enter <code>5514</code> and leave other parameters as is. We are using port 5514 for demonstration purposes as port 514 is being used by SC4S. If you are not using SC4S, you can put port 514 here.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2016.png" data-desc-position="bottom"><img alt="image.png" src="image%2016.png"></a></p>
<p>For Source type, search and select <code>fortigate_log</code> .</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2017.png" data-desc-position="bottom"><img alt="image.png" src="image%2017.png"></a></p>
<p>Click Review and Submit. If you get the error <code>UDP 514 is not available</code> use other UDP port (e.g. <code>5514</code>). Restart Splunk Enterprise as the <code>splunk</code> user for the change to take effect.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-72-1" name="__codelineno-72-1" href="#__codelineno-72-1"></a><span class="nb">cd</span><span class="w"> </span>/opt/splunk/bin
<a id="__codelineno-72-2" name="__codelineno-72-2" href="#__codelineno-72-2"></a>./splunk<span class="w"> </span>restart
</code></pre></div>
<h3 id="configuring-syslog-logging-on-fortigate-udp-5514"><strong>Configuring Syslog Logging on FortiGate (UDP 5514)</strong></h3>
<p>Configure <strong>FortiGate</strong> to send syslog to port 5514 by running the following command. Ensure you enter the correct port number. When prompted, confirm the port number.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-73-1" name="__codelineno-73-1" href="#__codelineno-73-1"></a>FGVMEVMBF57GNJF3<span class="w"> </span><span class="c1"># config log syslogd setting</span>
<a id="__codelineno-73-2" name="__codelineno-73-2" href="#__codelineno-73-2"></a>
<a id="__codelineno-73-3" name="__codelineno-73-3" href="#__codelineno-73-3"></a>FGVMEVMBF57GNJF3<span class="w"> </span><span class="o">(</span>setting<span class="o">)</span><span class="w"> </span><span class="c1"># set port 5514</span>
<a id="__codelineno-73-4" name="__codelineno-73-4" href="#__codelineno-73-4"></a>
<a id="__codelineno-73-5" name="__codelineno-73-5" href="#__codelineno-73-5"></a>FGVMEVMBF57GNJF3<span class="w"> </span><span class="o">(</span>setting<span class="o">)</span><span class="w"> </span><span class="c1"># show</span>
<a id="__codelineno-73-6" name="__codelineno-73-6" href="#__codelineno-73-6"></a>config<span class="w"> </span>log<span class="w"> </span>syslogd<span class="w"> </span>setting
<a id="__codelineno-73-7" name="__codelineno-73-7" href="#__codelineno-73-7"></a><span class="w">    </span><span class="nb">set</span><span class="w"> </span>status<span class="w"> </span><span class="nb">enable</span>
<a id="__codelineno-73-8" name="__codelineno-73-8" href="#__codelineno-73-8"></a><span class="w">    </span><span class="nb">set</span><span class="w"> </span>server<span class="w"> </span><span class="s2">"10.0.0.100"</span>
<a id="__codelineno-73-9" name="__codelineno-73-9" href="#__codelineno-73-9"></a><span class="w">    </span><span class="nb">set</span><span class="w"> </span>port<span class="w"> </span><span class="m">5514</span>
<a id="__codelineno-73-10" name="__codelineno-73-10" href="#__codelineno-73-10"></a><span class="w">    </span><span class="nb">set</span><span class="w"> </span>source-ip<span class="w"> </span><span class="s2">"10.0.0.1"</span>
<a id="__codelineno-73-11" name="__codelineno-73-11" href="#__codelineno-73-11"></a>end
<a id="__codelineno-73-12" name="__codelineno-73-12" href="#__codelineno-73-12"></a>
<a id="__codelineno-73-13" name="__codelineno-73-13" href="#__codelineno-73-13"></a>FGVMEVMBF57GNJF3<span class="w"> </span><span class="o">(</span>setting<span class="o">)</span><span class="w"> </span><span class="c1"># end</span>
<a id="__codelineno-73-14" name="__codelineno-73-14" href="#__codelineno-73-14"></a>Port<span class="w"> </span><span class="m">5514</span><span class="w"> </span>is<span class="w"> </span>different<span class="w"> </span>from<span class="w"> </span>default<span class="w"> </span>port<span class="w"> </span><span class="m">514</span>.
<a id="__codelineno-73-15" name="__codelineno-73-15" href="#__codelineno-73-15"></a>Confirm<span class="w"> </span>to<span class="w"> </span>use<span class="w"> </span>port<span class="w"> </span><span class="m">5514</span><span class="w"> </span>instead?
<a id="__codelineno-73-16" name="__codelineno-73-16" href="#__codelineno-73-16"></a>Do<span class="w"> </span>you<span class="w"> </span>want<span class="w"> </span>to<span class="w"> </span><span class="k">continue</span>?<span class="w"> </span><span class="o">(</span>y/n<span class="o">)</span>y
<a id="__codelineno-73-17" name="__codelineno-73-17" href="#__codelineno-73-17"></a>
<a id="__codelineno-73-18" name="__codelineno-73-18" href="#__codelineno-73-18"></a>Port<span class="w"> </span><span class="nb">set</span><span class="w"> </span>to<span class="w"> </span><span class="m">5514</span>
<a id="__codelineno-73-19" name="__codelineno-73-19" href="#__codelineno-73-19"></a>
<a id="__codelineno-73-20" name="__codelineno-73-20" href="#__codelineno-73-20"></a>FGVMEVMBF57GNJF3<span class="w"> </span><span class="c1"># </span>
</code></pre></div>
<h3 id="testing-fortigate-app"><strong>Testing FortiGate App</strong></h3>
<p>Navigate to Search &amp; Reporting on Splunk web UI. Search for <code>index=*</code> and verify that you can see <code>fortigate_traffic</code> and <code>fortigate_event</code> as source type. Verify that most recent logs source is <code>udp 5514</code>. If the source is still pointing to <code>sc4s</code>, restart the Splunk. </p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2018.png" data-desc-position="bottom"><img alt="image.png" src="image%2018.png"></a></p>
<p>Search for <code>index=* sourcetype=fortigate_traffic</code> and <code>index=* sourcetype=fortigate_traffic</code>. Verify that most recent logs source is <code>udp 5514</code> .</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2019.png" data-desc-position="bottom"><img alt="image.png" src="image%2019.png"></a></p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2020.png" data-desc-position="bottom"><img alt="image.png" src="image%2020.png"></a></p>
<h2 id="installing-sysmon-on-windows"><strong>Installing Sysmon on Windows</strong></h2>
<p>Download <a href="https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon">Sysmon</a> and <a href="https://github.com/olafhartong/sysmon-modular/blob/master/sysmonconfig.xml">sysmonconfig.xml</a>. Extract Sysmon.zip and move sysmonconfig.xml into the Sysmon folder where Sysmon.exe is located. Run PowerShell as Administrator and change directory to path where extracted Sysmon is located. Install Symon by running the following command:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-74-1" name="__codelineno-74-1" href="#__codelineno-74-1"></a>.<span class="se">\S</span>ysmon64.exe<span class="w"> </span>-accepteula<span class="w"> </span>-i<span class="w"> </span>sysmonconfig.xml
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-75-1" name="__codelineno-75-1" href="#__codelineno-75-1"></a><span class="c1">#Example output</span>
<a id="__codelineno-75-2" name="__codelineno-75-2" href="#__codelineno-75-2"></a>
<a id="__codelineno-75-3" name="__codelineno-75-3" href="#__codelineno-75-3"></a>PS<span class="w"> </span>C:<span class="se">\U</span>sers<span class="se">\A</span>dministrator<span class="se">\D</span>ownloads<span class="se">\S</span>ysmon<span class="se">\S</span>ysmon&gt;<span class="w"> </span>ls
<a id="__codelineno-75-4" name="__codelineno-75-4" href="#__codelineno-75-4"></a>
<a id="__codelineno-75-5" name="__codelineno-75-5" href="#__codelineno-75-5"></a><span class="w">    </span>Directory:<span class="w"> </span>C:<span class="se">\U</span>sers<span class="se">\A</span>dministrator<span class="se">\D</span>ownloads<span class="se">\S</span>ysmon<span class="se">\S</span>ysmon
<a id="__codelineno-75-6" name="__codelineno-75-6" href="#__codelineno-75-6"></a>
<a id="__codelineno-75-7" name="__codelineno-75-7" href="#__codelineno-75-7"></a>Mode<span class="w">                </span>LastWriteTime<span class="w">         </span>Length<span class="w"> </span>Name
<a id="__codelineno-75-8" name="__codelineno-75-8" href="#__codelineno-75-8"></a>----<span class="w">                </span>-------------<span class="w">         </span>------<span class="w"> </span>----
<a id="__codelineno-75-9" name="__codelineno-75-9" href="#__codelineno-75-9"></a>------<span class="w">        </span><span class="m">7</span>/23/2024<span class="w">   </span><span class="m">2</span>:08<span class="w"> </span>PM<span class="w">           </span><span class="m">7490</span><span class="w"> </span>Eula.txt
<a id="__codelineno-75-10" name="__codelineno-75-10" href="#__codelineno-75-10"></a>------<span class="w">        </span><span class="m">7</span>/23/2024<span class="w">   </span><span class="m">2</span>:08<span class="w"> </span>PM<span class="w">        </span><span class="m">8480560</span><span class="w"> </span>Sysmon.exe
<a id="__codelineno-75-11" name="__codelineno-75-11" href="#__codelineno-75-11"></a>------<span class="w">        </span><span class="m">7</span>/23/2024<span class="w">   </span><span class="m">2</span>:08<span class="w"> </span>PM<span class="w">        </span><span class="m">4563248</span><span class="w"> </span>Sysmon64.exe
<a id="__codelineno-75-12" name="__codelineno-75-12" href="#__codelineno-75-12"></a>------<span class="w">        </span><span class="m">7</span>/23/2024<span class="w">   </span><span class="m">2</span>:08<span class="w"> </span>PM<span class="w">        </span><span class="m">4993440</span><span class="w"> </span>Sysmon64a.exe
<a id="__codelineno-75-13" name="__codelineno-75-13" href="#__codelineno-75-13"></a>-a----<span class="w">        </span><span class="m">8</span>/26/2024<span class="w">   </span><span class="m">7</span>:31<span class="w"> </span>PM<span class="w">         </span><span class="m">123257</span><span class="w"> </span>sysmonconfig.xml
<a id="__codelineno-75-14" name="__codelineno-75-14" href="#__codelineno-75-14"></a>
<a id="__codelineno-75-15" name="__codelineno-75-15" href="#__codelineno-75-15"></a>PS<span class="w"> </span>C:<span class="se">\U</span>sers<span class="se">\A</span>dministrator<span class="se">\D</span>ownloads<span class="se">\S</span>ysmon<span class="se">\S</span>ysmon&gt;<span class="w"> </span>.<span class="se">\S</span>ysmon64.exe<span class="w"> </span>-accepteula<span class="w"> </span>-i<span class="w"> </span>.<span class="se">\s</span>ysmonconfig.xml
<a id="__codelineno-75-16" name="__codelineno-75-16" href="#__codelineno-75-16"></a>
<a id="__codelineno-75-17" name="__codelineno-75-17" href="#__codelineno-75-17"></a>System<span class="w"> </span>Monitor<span class="w"> </span>v15.15<span class="w"> </span>-<span class="w"> </span>System<span class="w"> </span>activity<span class="w"> </span>monitor
<a id="__codelineno-75-18" name="__codelineno-75-18" href="#__codelineno-75-18"></a>By<span class="w"> </span>Mark<span class="w"> </span>Russinovich<span class="w"> </span>and<span class="w"> </span>Thomas<span class="w"> </span>Garnier
<a id="__codelineno-75-19" name="__codelineno-75-19" href="#__codelineno-75-19"></a>Copyright<span class="w"> </span><span class="o">(</span>C<span class="o">)</span><span class="w"> </span><span class="m">2014</span>-2024<span class="w"> </span>Microsoft<span class="w"> </span>Corporation
<a id="__codelineno-75-20" name="__codelineno-75-20" href="#__codelineno-75-20"></a>Using<span class="w"> </span>libxml2.<span class="w"> </span>libxml2<span class="w"> </span>is<span class="w"> </span>Copyright<span class="w"> </span><span class="o">(</span>C<span class="o">)</span><span class="w"> </span><span class="m">1998</span>-2012<span class="w"> </span>Daniel<span class="w"> </span>Veillard.<span class="w"> </span>All<span class="w"> </span>Rights<span class="w"> </span>Reserved.
<a id="__codelineno-75-21" name="__codelineno-75-21" href="#__codelineno-75-21"></a>Sysinternals<span class="w"> </span>-<span class="w"> </span>www.sysinternals.com
<a id="__codelineno-75-22" name="__codelineno-75-22" href="#__codelineno-75-22"></a>
<a id="__codelineno-75-23" name="__codelineno-75-23" href="#__codelineno-75-23"></a>Loading<span class="w"> </span>configuration<span class="w"> </span>file<span class="w"> </span>with<span class="w"> </span>schema<span class="w"> </span>version<span class="w"> </span><span class="m">4</span>.50
<a id="__codelineno-75-24" name="__codelineno-75-24" href="#__codelineno-75-24"></a>Sysmon<span class="w"> </span>schema<span class="w"> </span>version:<span class="w"> </span><span class="m">4</span>.90
<a id="__codelineno-75-25" name="__codelineno-75-25" href="#__codelineno-75-25"></a>Configuration<span class="w"> </span>file<span class="w"> </span>validated.
<a id="__codelineno-75-26" name="__codelineno-75-26" href="#__codelineno-75-26"></a>Sysmon64<span class="w"> </span>installed.
<a id="__codelineno-75-27" name="__codelineno-75-27" href="#__codelineno-75-27"></a>SysmonDrv<span class="w"> </span>installed.
<a id="__codelineno-75-28" name="__codelineno-75-28" href="#__codelineno-75-28"></a>Starting<span class="w"> </span>SysmonDrv.
<a id="__codelineno-75-29" name="__codelineno-75-29" href="#__codelineno-75-29"></a>SysmonDrv<span class="w"> </span>started.
<a id="__codelineno-75-30" name="__codelineno-75-30" href="#__codelineno-75-30"></a>Starting<span class="w"> </span>Sysmon64..
<a id="__codelineno-75-31" name="__codelineno-75-31" href="#__codelineno-75-31"></a>Sysmon64<span class="w"> </span>started.
</code></pre></div>
<p>Verify that Sysmon is installed by checking Services (Sysmon64) and Windows Event Viewer (Applications and Services Logs &gt; Microsoft &gt; Windows &gt; Sysmon). </p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2021.png" data-desc-position="bottom"><img alt="image.png" src="image%2021.png"></a></p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2022.png" data-desc-position="bottom"><img alt="image.png" src="image%2022.png"></a></p>
<h2 id="installing-splunk-uf-on-windows"><strong>Installing Splunk UF on Windows</strong></h2>
<p>For installing the Splunk Universal Forwarder (UF) on Windows, there are three options:</p>
<p><strong>Option 1:</strong> Install with a Domain Account</p>
<p>This option worked successfully in my lab without any issues; however, it requires additional configuration steps.</p>
<p><strong>Option 2:</strong> Install with a Virtual Account (Annex 1)</p>
<p>This is Splunks recommended approach, but I encountered issues despite troubleshooting the errors.</p>
<p><strong>Option 3:</strong> Install with the Local System Account</p>
<p>While not a security best practice, this option works reliably without any issues.</p>
<p>This documentation covers <strong>Options 1 and 2</strong>, as Option 3 follows a similar process. Please choose the option that works best for your requirements.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="splunk3.png" data-desc-position="bottom"><img alt="splunk3.png" src="splunk3.png"></a></p>
<h2 id="installing-splunk-uf-with-a-domain-account-option-1"><strong>Installing Splunk UF with a Domain Account (Option 1)</strong></h2>
<h3 id="creating-a-domain-account"><strong>Creating a Domain Account</strong></h3>
<p>In this lab, WS2019 host is joined to a domain called <code>cyber.local</code> and promoted as a domain controller. This step is applicable to a domain-joined environment. Create a domain user called <code>splunk</code> and assign it as a member of <code>Event Log Readers Group</code>. This account will be used to run Splunk Forwarder. </p>
<ul>
<li>Go to Active Directory Users and Computers &gt; domain &gt; Users</li>
<li>Right-click Users &gt; New &gt; User</li>
<li>First name: splunk</li>
<li>Last name: (blank)</li>
<li>Full name: splunk</li>
<li>User logon name: splunk</li>
<li>Right-click splunk user &gt; Properties &gt; Member of &gt; Add &gt; put <code>Event Log Readers</code> and click Check Names &gt; OK &gt; Apply and OK</li>
</ul>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2023.png" data-desc-position="bottom"><img alt="image.png" src="image%2023.png"></a></p>
<h3 id="configuring-rdp-optional"><strong>Configuring RDP (Optional)</strong></h3>
<p>In this lab, RDP configuration was required for the <code>splunk</code> user to login to WS2019 host. This step is optional. Open Local Group Policy Editor by clicking Run &gt; type <code>gpedit.msc</code> . In the Local Group Policy Editor, navigate to Windows Settings &gt; Security Settings &gt; Local Policies &gt; User Rights Assignment &gt; Allow log on through Remote Desktop Services. Add user <code>splunk</code>.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2024.png" data-desc-position="bottom"><img alt="image.png" src="image%2024.png"></a></p>
<p>In the Local Group Policy Editor, navigate to Computer configuration &gt; Administrative Templates &gt; Windows Components &gt; Remote Desktop Services &gt; Remote Desktop Session Host &gt; Connections &gt; Allow users to connect remotely by using Remote Desktop Services &gt;Enabled.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2025.png" data-desc-position="bottom"><img alt="image.png" src="image%2025.png"></a></p>
<p>Navigate to Remote Desktop Session Host &gt; Security &gt; Require user authentication for remote connections by using Network Level Authentication &gt; Enabled.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2026.png" data-desc-position="bottom"><img alt="image.png" src="image%2026.png"></a></p>
<p>In Server Manager, go to Local Server. Make sure Remote Desktop is Enabled. Click <code>Enabled</code> next to Remote Desktop.  Click Select Users. Add user <code>splunk</code>.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2027.png" data-desc-position="bottom"><img alt="image.png" src="image%2027.png"></a></p>
<p>Enable inbound firewall rules related to Remote Desktop.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2028.png" data-desc-position="bottom"><img alt="image.png" src="image%2028.png"></a></p>
<p>RDP into <code>WS2019</code> host as the <code>splunk</code> user from another internal host.</p>
<h3 id="configuring-splunk-uf-on-windows"><strong>Configuring Splunk UF on Windows</strong></h3>
<p>Download and transfer the <a href="https://www.splunk.com/en_us/download/universal-forwarder.html">Splunk Universal Forwarder (UF) (msi) for Windows</a>. Run Universal Forwarder (msi), accept license, select on-premise Splunk Enterprise instance, and click Customize Options.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2029.png" data-desc-position="bottom"><img alt="image.png" src="image%2029.png"></a></p>
<p>Leave Path as default and click Next</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2030.png" data-desc-position="bottom"><img alt="image.png" src="image%2030.png"></a></p>
<p>Leave Certificate Password empty and click Next</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2031.png" data-desc-position="bottom"><img alt="image.png" src="image%2031.png"></a></p>
<p>Select Domain Account.  </p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2032.png" data-desc-position="bottom"><img alt="image.png" src="image%2032.png"></a></p>
<p>Specify domain\splunk and password for the account.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2033.png" data-desc-position="bottom"><img alt="image.png" src="image%2033.png"></a></p>
<p>Leave permissions as default.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2034.png" data-desc-position="bottom"><img alt="image.png" src="image%2034.png"></a></p>
<p>Leave everything unchecked and click Next.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2035.png" data-desc-position="bottom"><img alt="image.png" src="image%2035.png"></a></p>
<p>Create credentials for the administrator account. </p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2036.png" data-desc-position="bottom"><img alt="image.png" src="image%2036.png"></a></p>
<p>Enter IP address of Deployment Server (Splunk server) and port 8089. Note the IP address in the screenshot is different to the lab setup. </p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2037.png" data-desc-position="bottom"><img alt="image.png" src="image%2037.png"></a></p>
<p>Enter IP address of Receiving Indexer (Splunk server) and port 9997.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2038.png" data-desc-position="bottom"><img alt="image.png" src="image%2038.png"></a></p>
<p>Click Install. Click Finish after install is complete.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2039.png" data-desc-position="bottom"><img alt="image.png" src="image%2039.png"></a></p>
<h3 id="creating-a-new-outbound-firewall-rule"><strong>Creating a New Outbound Firewall Rule</strong></h3>
<p>Navigate to Windows Defender Firewall with Advanced Security. Right-click on Outbound Rules and select New Rule. Select Program as Rule Type.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2040.png" data-desc-position="bottom"><img alt="image.png" src="image%2040.png"></a></p>
<p>For program path, browse to C:\Program Files\SplunkUniversalForwarder\bin\splunkd.exe</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2041.png" data-desc-position="bottom"><img alt="image.png" src="image%2041.png"></a></p>
<p>Select Allow the Connection.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2042.png" data-desc-position="bottom"><img alt="image.png" src="image%2042.png"></a></p>
<p>Check all boxes for Domain, Private and Public.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2043.png" data-desc-position="bottom"><img alt="image.png" src="image%2043.png"></a></p>
<p>Name the rule as Splunk outbound</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2044.png" data-desc-position="bottom"><img alt="image.png" src="image%2044.png"></a></p>
<h3 id="verifying-agent-connection-on-windows"><strong>Verifying Agent Connection on Windows</strong></h3>
<p>Verify that yours Windows host is connected to the Deployment Server. On the Splunk Enterprise web UI, go to Settings &gt; Forwarder Management. You should be able to see your Windows client. </p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2045.png" data-desc-position="bottom"><img alt="image.png" src="image%2045.png"></a></p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2046.png" data-desc-position="bottom"><img alt="image.png" src="image%2046.png"></a></p>
<h2 id="installing-splunk-uf-on-linux"><strong>Installing Splunk UF on Linux</strong></h2>
<p>Download and transfer <a href="https://www.splunk.com/en_us/download/universal-forwarder.html">Splunk UF (tar archive) for Linux</a>. Unpack the tar archive to /opt directory as a standard user.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-76-1" name="__codelineno-76-1" href="#__codelineno-76-1"></a>sudo<span class="w"> </span>tar<span class="w"> </span>xvzf<span class="w"> </span>splunkforwarder*.tgz<span class="w"> </span>-C<span class="w"> </span>/opt
</code></pre></div>
<p>Create a user called <code>splunk</code> and change the ownership of <code>/opt/splunkforwarder</code> to the <code>splunk</code> user.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-77-1" name="__codelineno-77-1" href="#__codelineno-77-1"></a>sudo<span class="w"> </span>adduser<span class="w"> </span>splunk
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-78-1" name="__codelineno-78-1" href="#__codelineno-78-1"></a>sudo<span class="w"> </span>chown<span class="w"> </span>-R<span class="w"> </span>splunk:splunk<span class="w"> </span>/opt/splunkforwarder/
<a id="__codelineno-78-2" name="__codelineno-78-2" href="#__codelineno-78-2"></a><span class="nb">cd</span><span class="w"> </span>/opt
<a id="__codelineno-78-3" name="__codelineno-78-3" href="#__codelineno-78-3"></a>ls<span class="w"> </span>-la
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-79-1" name="__codelineno-79-1" href="#__codelineno-79-1"></a><span class="c1">#Example output</span>
<a id="__codelineno-79-2" name="__codelineno-79-2" href="#__codelineno-79-2"></a>total<span class="w"> </span><span class="m">12</span>
<a id="__codelineno-79-3" name="__codelineno-79-3" href="#__codelineno-79-3"></a>drwxr-xr-x<span class="w">  </span><span class="m">3</span><span class="w"> </span>root<span class="w">   </span>root<span class="w">   </span><span class="m">4096</span><span class="w"> </span>Feb<span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">11</span>:00<span class="w"> </span>.
<a id="__codelineno-79-4" name="__codelineno-79-4" href="#__codelineno-79-4"></a>drwxr-xr-x<span class="w"> </span><span class="m">23</span><span class="w"> </span>root<span class="w">   </span>root<span class="w">   </span><span class="m">4096</span><span class="w"> </span>Feb<span class="w">  </span><span class="m">1</span><span class="w"> </span><span class="m">03</span>:42<span class="w"> </span>..
<a id="__codelineno-79-5" name="__codelineno-79-5" href="#__codelineno-79-5"></a>drwxr-xr-x<span class="w">  </span><span class="m">9</span><span class="w"> </span>splunk<span class="w"> </span>splunk<span class="w"> </span><span class="m">4096</span><span class="w"> </span>Feb<span class="w"> </span><span class="m">21</span><span class="w"> </span><span class="m">07</span>:30<span class="w"> </span>splunkforwarder
</code></pre></div>
<h3 id="configuring-splunk-uf-on-linux"><strong>Configuring Splunk UF on Linux</strong></h3>
<p>Switch to <code>splunk</code> user and start Splunk UF. When prompted, create admin credentials.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-80-1" name="__codelineno-80-1" href="#__codelineno-80-1"></a>su<span class="w"> </span>splunk
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-81-1" name="__codelineno-81-1" href="#__codelineno-81-1"></a><span class="nb">cd</span><span class="w"> </span>/opt/splunkforwarder/bin
<a id="__codelineno-81-2" name="__codelineno-81-2" href="#__codelineno-81-2"></a>./splunk<span class="w"> </span>start<span class="w"> </span>--accept-license
</code></pre></div>
<p>In the <code>/opt/splunkforwarder/bin</code> directory, as the <code>splunk</code> user, run the following command to connect to Linux client (UF) the deployment server (Splunk Enterprise). </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-82-1" name="__codelineno-82-1" href="#__codelineno-82-1"></a>./splunk<span class="w"> </span><span class="nb">set</span><span class="w"> </span>deploy-poll<span class="w"> </span><span class="m">10</span>.0.0.100:8089
</code></pre></div>
<p>Verify that the deployment server's IP address in <code>deploymentclient.conf</code> (located in <code>/opt/splunkforwarder/etc/system/local/</code>) is correct.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-83-1" name="__codelineno-83-1" href="#__codelineno-83-1"></a>cat<span class="w"> </span>/opt/splunkforwarder/etc/system/local/deploymentclient.conf
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-84-1" name="__codelineno-84-1" href="#__codelineno-84-1"></a><span class="c1">#Example output</span>
<a id="__codelineno-84-2" name="__codelineno-84-2" href="#__codelineno-84-2"></a><span class="o">[</span>target-broker:deploymentServer<span class="o">]</span>
<a id="__codelineno-84-3" name="__codelineno-84-3" href="#__codelineno-84-3"></a><span class="nv">targetUri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span>.0.0.100:8089
</code></pre></div>
<p>Run the following command to add the forward-server as the Splunk Enterprise. We are essentially configuring UF to send logs to the listening port of Splunk Enterprise.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-85-1" name="__codelineno-85-1" href="#__codelineno-85-1"></a>./splunk<span class="w"> </span>add<span class="w"> </span>forward-server<span class="w"> </span><span class="m">10</span>.0.0.100:9997
</code></pre></div>
<p>Verify that the tcpout servers IP address in <code>outputs.conf</code> (located in <code>/opt/splunkforwarder/etc/system/local</code>) is correct.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-86-1" name="__codelineno-86-1" href="#__codelineno-86-1"></a>cat<span class="w"> </span>/opt/splunkforwarder/etc/system/local/outputs.conf
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-87-1" name="__codelineno-87-1" href="#__codelineno-87-1"></a><span class="c1">#Example output</span>
<a id="__codelineno-87-2" name="__codelineno-87-2" href="#__codelineno-87-2"></a><span class="o">[</span>tcpout<span class="o">]</span>
<a id="__codelineno-87-3" name="__codelineno-87-3" href="#__codelineno-87-3"></a><span class="nv">defaultGroup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>default-autolb-group
<a id="__codelineno-87-4" name="__codelineno-87-4" href="#__codelineno-87-4"></a>
<a id="__codelineno-87-5" name="__codelineno-87-5" href="#__codelineno-87-5"></a><span class="o">[</span>tcpout:default-autolb-group<span class="o">]</span>
<a id="__codelineno-87-6" name="__codelineno-87-6" href="#__codelineno-87-6"></a><span class="nv">server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span>.0.0.100:9997
<a id="__codelineno-87-7" name="__codelineno-87-7" href="#__codelineno-87-7"></a>
<a id="__codelineno-87-8" name="__codelineno-87-8" href="#__codelineno-87-8"></a><span class="o">[</span>tcpout-server://10.0.0.100:9997<span class="o">]</span>
</code></pre></div>
<p>Restart Splunk Forwarder for changes to take effect.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-88-1" name="__codelineno-88-1" href="#__codelineno-88-1"></a>./splunk<span class="w"> </span>restart
</code></pre></div>
<h3 id="verifying-agent-connection-on-linux"><strong>Verifying Agent Connection on Linux</strong></h3>
<p>On web UI of Splunk Enterprise, go to settings, forwarder management. We should be able to see our Linux client (UF). If Linux client doesnt appear, try refreshing the web browser or restart Splunk Enterprise.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2047.png" data-desc-position="bottom"><img alt="image.png" src="image%2047.png"></a></p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2048.png" data-desc-position="bottom"><img alt="image.png" src="image%2048.png"></a></p>
<h2 id="installing-splunk-apps"><strong>Installing Splunk Apps</strong></h2>
<p>Earlier, we downloaded the following Splunk Apps (tar archive files)</p>
<ul>
<li><a href="https://splunkbase.splunk.com/app/742">Splunk Add-on for MS Windows</a></li>
<li><a href="https://splunkbase.splunk.com/app/5709">Splunk Add-on for Sysmon</a></li>
<li><a href="https://splunkbase.splunk.com/app/2846">Fortinet FortiGate Add-on for Splunk</a> (optional: required if ingesting FortiGate logs through this app)</li>
<li><a href="https://splunkbase.splunk.com/app/833">Splunk Add-on for Unix and Linux</a></li>
</ul>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="4.png" data-desc-position="bottom"><img alt="4.png" src="4.png"></a></p>
<p>Install the add-ons (apps) on Splunk Enterprise web UI. Go to Apps &gt; Manage Apps &gt; Install app from file &gt; Upload the tar archive files. Check Upgrade app. </p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2049.png" data-desc-position="bottom"><img alt="image.png" src="image%2049.png"></a></p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2050.png" data-desc-position="bottom"><img alt="image.png" src="image%2050.png"></a></p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2051.png" data-desc-position="bottom"><img alt="image.png" src="image%2051.png"></a></p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2052.png" data-desc-position="bottom"><img alt="image.png" src="image%2052.png"></a></p>
<p>If prompted to set up the apps, click set up later.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2053.png" data-desc-position="bottom"><img alt="image.png" src="image%2053.png"></a></p>
<p>On terminal of the <strong>Splunk VM</strong> where <strong>Splunk Enterprise</strong> is installed, verify that there are Windows, Sysmon, Linux and FortiGate Apps in the <code>/opt/splunk/etc/apps</code> directory. Copy the apps to <code>/opt/splunk/etc/deployment-apps</code> directory.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-89-1" name="__codelineno-89-1" href="#__codelineno-89-1"></a><span class="nb">cd</span><span class="w"> </span>/opt/splunk/etc/apps
<a id="__codelineno-89-2" name="__codelineno-89-2" href="#__codelineno-89-2"></a>cp<span class="w"> </span>-r<span class="w"> </span>Splunk_TA_*<span class="w"> </span>/opt/splunk/etc/deployment-apps/
</code></pre></div>
<p>Verify that the apps are shown in the Splunk Enterprise web UI. Go to Settings &gt; Forwarder Management &gt; Configurations.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2054.png" data-desc-position="bottom"><img alt="image.png" src="image%2054.png"></a></p>
<h2 id="creating-indexes-for-apps"><strong>Creating Indexes for Apps</strong></h2>
<p>Create indexes on the web UI. Your index name must match with index name in <code>inputs.conf</code> in each app. Go to settings &gt; indexes &gt; New Index. </p>
<table>
<thead>
<tr>
<th><strong>Index Name</strong></th>
<th>wineventlog</th>
<th>sysmonlog</th>
<th>unixlog (optional)</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Index Data Type</strong></td>
<td>Events</td>
<td>Events</td>
<td>Events</td>
</tr>
<tr>
<td><strong>Max Size of entire Index</strong></td>
<td>1 GB (Default is 500 GB so adjust accordingly)</td>
<td>1 GB (Default is 500 GB so adjust accordingly)</td>
<td>1 GB (Default is 500 GB so adjust accordingly)</td>
</tr>
<tr>
<td><strong>Enable Reduction</strong></td>
<td>Enable (optional)</td>
<td>Enable (optional)</td>
<td>Enable (optional)</td>
</tr>
<tr>
<td><strong>Reduce tisdx files older than</strong></td>
<td>90 days</td>
<td>90 days</td>
<td>90 days</td>
</tr>
</tbody>
</table>
<p>Verify that indexes have been created and enabled.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2055.png" data-desc-position="bottom"><img alt="image.png" src="image%2055.png"></a></p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="Untitled.png" data-desc-position="bottom"><img alt="Untitled" src="Untitled.png"></a></p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2056.png" data-desc-position="bottom"><img alt="image.png" src="image%2056.png"></a></p>
<h2 id="configuring-linux-app"><strong>Configuring Linux App</strong></h2>
<h3 id="for-splunk-uf-v940-and-above"><strong>For Splunk UF v9.4.0 and above:</strong></h3>
<p>Navigate to Groups / Server Classes &gt; New server class. Add a new server class called nix and click Save.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2057.png" data-desc-position="bottom"><img alt="image.png" src="image%2057.png"></a></p>
<p>Click the nix server class. Navigate to Agents &gt; Edit agent assignment.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2058.png" data-desc-position="bottom"><img alt="image.png" src="image%2058.png"></a></p>
<p>Put * in Include, and filter by linux-x86_64. Click Preview and make sure you can see a tick next to the hostname of the client. Click Save.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2059.png" data-desc-position="bottom"><img alt="image.png" src="image%2059.png"></a></p>
<p>Navigate to nix server class configurations &gt; Edit configurations.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2060.png" data-desc-position="bottom"><img alt="image.png" src="image%2060.png"></a></p>
<p>Select Splunk_TA_nix, add to Assigned Applications, then click Save.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2061.png" data-desc-position="bottom"><img alt="image.png" src="image%2061.png"></a></p>
<p>On the nix server class configurations page, click Splunk_TA_nix.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2062.png" data-desc-position="bottom"><img alt="image.png" src="image%2062.png"></a></p>
<p>Click on the toggle switch for Restart Agent.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2063.png" data-desc-position="bottom"><img alt="image.png" src="image%2063.png"></a></p>
<p>Navigate back to the nix server class configurations page. Verify that the Deployment Status for Linux app shows as successful. This process may take some time, so try refreshing the page periodically.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2064.png" data-desc-position="bottom"><img alt="image.png" src="image%2064.png"></a></p>
<h3 id="for-older-versions-of-splunk-uf"><strong>For older versions of Splunk UF:</strong></h3>
<p>On the Forwarder Management page of the web UI, click Edit under Actions for Splunk_TA_nix. Select Restart Splunkd After Installation, create a New Server Class called nix, and click Save</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="Untitled%201.png" data-desc-position="bottom"><img alt="Untitled" src="Untitled%201.png"></a></p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="Untitled%202.png" data-desc-position="bottom"><img alt="Untitled" src="Untitled%202.png"></a></p>
<p>Click Add Apps and select Splunk_TA_nix. Click Save.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="Untitled%203.png" data-desc-position="bottom"><img alt="Untitled" src="Untitled%203.png"></a></p>
<p>Click Add Clients. Put * in include, and filter by linux-x86_64. Click Preview and Save. </p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2065.png" data-desc-position="bottom"><img alt="image.png" src="image%2065.png"></a></p>
<p>You should see Restart Splunkd in the After installation column. If only Enable App is shown, Edit each app and select Restart Splunkd. Verify the configuration in the Forwarder Management.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2066.png" data-desc-position="bottom"><img alt="image.png" src="image%2066.png"></a></p>
<p>If the settings are not applied try reloading the deployment server.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-90-1" name="__codelineno-90-1" href="#__codelineno-90-1"></a>./splunk<span class="w"> </span>reload<span class="w"> </span>deploy-server
</code></pre></div>
<h2 id="editing-config-files-for-linux-app"><strong>Editing Config Files for Linux App</strong></h2>
<p>On the Splunk VM where <strong>Splunk Enterprise</strong> is installed, change into <code>/opt/splunk/etc/deployment-apps/Splunk_TA_nix/local</code> <strong><em>*directory. Copy <code>app.conf</code>, <code>inputs.conf</code> and <code>props.conf</code> from <code>/opt/splunk/etc/deployment-apps/Splunk_TA_nix/default</code> </em></strong>*directory.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-91-1" name="__codelineno-91-1" href="#__codelineno-91-1"></a><span class="nb">cd</span><span class="w"> </span>/opt/splunk/etc/deployment-apps/Splunk_TA_nix/local
<a id="__codelineno-91-2" name="__codelineno-91-2" href="#__codelineno-91-2"></a>cp<span class="w"> </span>/opt/splunk/etc/deployment-apps/Splunk_TA_nix/default/app.conf<span class="w"> </span>.
<a id="__codelineno-91-3" name="__codelineno-91-3" href="#__codelineno-91-3"></a>cp<span class="w"> </span>/opt/splunk/etc/deployment-apps/Splunk_TA_nix/default/inputs.conf<span class="w"> </span>.
<a id="__codelineno-91-4" name="__codelineno-91-4" href="#__codelineno-91-4"></a>cp<span class="w"> </span>/opt/splunk/etc/deployment-apps/Splunk_TA_nix/default/props.conf<span class="w"> </span>.
</code></pre></div>
<p>Make the following changes to inputs.conf: </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-92-1" name="__codelineno-92-1" href="#__codelineno-92-1"></a>nano<span class="w"> </span>inputs.conf
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-93-1" name="__codelineno-93-1" href="#__codelineno-93-1"></a><span class="o">[</span>default<span class="o">]</span>
<a id="__codelineno-93-2" name="__codelineno-93-2" href="#__codelineno-93-2"></a><span class="nv">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>unixlog
<a id="__codelineno-93-3" name="__codelineno-93-3" href="#__codelineno-93-3"></a>...
<a id="__codelineno-93-4" name="__codelineno-93-4" href="#__codelineno-93-4"></a><span class="o">[</span>monitor:///var/log<span class="o">]</span>
<a id="__codelineno-93-5" name="__codelineno-93-5" href="#__codelineno-93-5"></a><span class="nv">whitelist</span><span class="o">=(</span><span class="se">\.</span>log<span class="p">|</span>log$<span class="p">|</span>messages<span class="p">|</span>secure<span class="p">|</span>auth<span class="p">|</span>mesg$<span class="p">|</span>cron$<span class="p">|</span>acpid$<span class="p">|</span><span class="se">\.</span>out<span class="o">)</span>
<a id="__codelineno-93-6" name="__codelineno-93-6" href="#__codelineno-93-6"></a><span class="nv">blacklist</span><span class="o">=(</span>lastlog<span class="p">|</span>anaconda<span class="se">\.</span>syslog<span class="o">)</span>
<a id="__codelineno-93-7" name="__codelineno-93-7" href="#__codelineno-93-7"></a><span class="nv">disabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
<a id="__codelineno-93-8" name="__codelineno-93-8" href="#__codelineno-93-8"></a>...
</code></pre></div>
<p>On the <strong>Ubuntu VM</strong> where <strong>Splunk UF</strong> is installed, navigate to <code>/opt/splunkforwarder/etc/apps/Splunk_TA_nix/local</code> directory. Copy app.conf, inputs.conf and props.conf from <code>/opt/splunkforwarder/etc/apps/Splunk_TA_nix/default</code> directory.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-94-1" name="__codelineno-94-1" href="#__codelineno-94-1"></a><span class="nb">cd</span><span class="w"> </span>/opt/splunkforwarder/etc/apps/Splunk_TA_nix/local
<a id="__codelineno-94-2" name="__codelineno-94-2" href="#__codelineno-94-2"></a>cp<span class="w"> </span>/opt/splunkforwarder/etc/apps/Splunk_TA_nix/default/app.conf<span class="w"> </span>.
<a id="__codelineno-94-3" name="__codelineno-94-3" href="#__codelineno-94-3"></a>cp<span class="w"> </span>/opt/splunkforwarder/etc/apps/Splunk_TA_nix/default/inputs.conf<span class="w"> </span>.
<a id="__codelineno-94-4" name="__codelineno-94-4" href="#__codelineno-94-4"></a>cp<span class="w"> </span>/opt/splunkforwarder/etc/apps/Splunk_TA_nix/default/props.conf<span class="w"> </span>.
</code></pre></div>
<p>Edit inputs.conf (same as above). Make the following changes to inputs.conf: </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-95-1" name="__codelineno-95-1" href="#__codelineno-95-1"></a>nano<span class="w"> </span>inputs.conf
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-96-1" name="__codelineno-96-1" href="#__codelineno-96-1"></a><span class="o">[</span>default<span class="o">]</span>
<a id="__codelineno-96-2" name="__codelineno-96-2" href="#__codelineno-96-2"></a><span class="nv">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>unixlog
<a id="__codelineno-96-3" name="__codelineno-96-3" href="#__codelineno-96-3"></a>...
<a id="__codelineno-96-4" name="__codelineno-96-4" href="#__codelineno-96-4"></a><span class="o">[</span>monitor:///var/log<span class="o">]</span>
<a id="__codelineno-96-5" name="__codelineno-96-5" href="#__codelineno-96-5"></a><span class="nv">whitelist</span><span class="o">=(</span><span class="se">\.</span>log<span class="p">|</span>log$<span class="p">|</span>messages<span class="p">|</span>secure<span class="p">|</span>auth<span class="p">|</span>mesg$<span class="p">|</span>cron$<span class="p">|</span>acpid$<span class="p">|</span><span class="se">\.</span>out<span class="o">)</span>
<a id="__codelineno-96-6" name="__codelineno-96-6" href="#__codelineno-96-6"></a><span class="nv">blacklist</span><span class="o">=(</span>lastlog<span class="p">|</span>anaconda<span class="se">\.</span>syslog<span class="o">)</span>
<a id="__codelineno-96-7" name="__codelineno-96-7" href="#__codelineno-96-7"></a><span class="nv">disabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
<a id="__codelineno-96-8" name="__codelineno-96-8" href="#__codelineno-96-8"></a>...
</code></pre></div>
<p>Restart Splunk Universal Forwarder.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-97-1" name="__codelineno-97-1" href="#__codelineno-97-1"></a><span class="nb">cd</span><span class="w"> </span>/opt/splunkforwarder/bin
<a id="__codelineno-97-2" name="__codelineno-97-2" href="#__codelineno-97-2"></a>./splunk<span class="w"> </span>restart
</code></pre></div>
<p>On the <strong>Ubuntu VM</strong> where <strong>Splunk UF</strong> is installed, recursively change the ownership of <code>/var/log</code> directory to <code>splunk:splunk</code> </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-98-1" name="__codelineno-98-1" href="#__codelineno-98-1"></a>sudo<span class="w"> </span>chown<span class="w"> </span>-R<span class="w"> </span>splunk:splunk<span class="w"> </span>/var/log
</code></pre></div>
<p>On the Splunk Enterprise web interface, verify that data is being indexed on <strong>unixlog</strong>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-99-1" name="__codelineno-99-1" href="#__codelineno-99-1"></a><span class="nv">index</span><span class="o">=</span><span class="s2">"unixlog"</span>
</code></pre></div>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2067.png" data-desc-position="bottom"><img alt="image.png" src="image%2067.png"></a></p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2068.png" data-desc-position="bottom"><img alt="image.png" src="image%2068.png"></a></p>
<h2 id="configuring-windows-and-sysmon-apps"><strong>Configuring Windows and Sysmon Apps</strong></h2>
<h3 id="for-splunk-v-940-and-above"><strong>For Splunk v 9.4.0 and above:</strong></h3>
<p>Navigate to Groups / Server Classes &gt; New server class. Add a new server class called win and click Save.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2069.png" data-desc-position="bottom"><img alt="image.png" src="image%2069.png"></a></p>
<p>Click the win server class. Navigate to Agents &gt; Edit agent assignment.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2070.png" data-desc-position="bottom"><img alt="image.png" src="image%2070.png"></a></p>
<p>Put * in Include, and filter by windows-x64. Click Preview and make sure you can see a tick next to the hostname of the client. Click Save.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2071.png" data-desc-position="bottom"><img alt="image.png" src="image%2071.png"></a></p>
<p>Navigate to win server class configurations &gt; Edit configurations.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2072.png" data-desc-position="bottom"><img alt="image.png" src="image%2072.png"></a></p>
<p>Add Apps and select Splunk_TA_windows and Splunk_TA_micorsoft_sysmon. Click Save.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2073.png" data-desc-position="bottom"><img alt="image.png" src="image%2073.png"></a></p>
<p>On the win server class configurations page, click Splunk_TA_windows.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2074.png" data-desc-position="bottom"><img alt="image.png" src="image%2074.png"></a></p>
<p>Click on the toggle switch for Restart Agent.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2075.png" data-desc-position="bottom"><img alt="image.png" src="image%2075.png"></a></p>
<p>Navigate back to the win server class configurations page and repeat the same process for Splunk_TA_micorsoft_sysmon. </p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2076.png" data-desc-position="bottom"><img alt="image.png" src="image%2076.png"></a></p>
<p>Navigate back to the win server class Configurations page. Verify that the Deployment Status for both the Windows and Sysmon apps shows as successful. This process may take some time, so try refreshing the page periodically.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2077.png" data-desc-position="bottom"><img alt="image.png" src="image%2077.png"></a></p>
<h3 id="for-older-versions-of-splunk"><strong>For older versions of Splunk:</strong></h3>
<p>On the Forwarder Management page of the web UI, click Edit under Actions for Splunk_TA_windows. Select Restart Splunkd After Installation, add New Server Class called win, and click Save</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="Untitled%204.png" data-desc-position="bottom"><img alt="Untitled" src="Untitled%204.png"></a></p>
<p>Click Add Apps and select Splunk_TA_windows and Splunk_TA_micorsoft_sysmon. Click Save.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2078.png" data-desc-position="bottom"><img alt="image.png" src="image%2078.png"></a></p>
<p>Click Add Clients. Put * in Include, and filter by windows-x64. Click Preview and Save.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2079.png" data-desc-position="bottom"><img alt="image.png" src="image%2079.png"></a></p>
<p>You should see Restart Splunkd in the After installation column. If only Enable App is shown, Edit each app and select Restart Splunkd.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2080.png" data-desc-position="bottom"><img alt="image.png" src="image%2080.png"></a></p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2081.png" data-desc-position="bottom"><img alt="image.png" src="image%2081.png"></a></p>
<p>Verify the configuration in the Forwarder Management.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2082.png" data-desc-position="bottom"><img alt="image.png" src="image%2082.png"></a></p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2083.png" data-desc-position="bottom"><img alt="image.png" src="image%2083.png"></a></p>
<p>If the configuration is not applied, try reloading the deployment-server</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-100-1" name="__codelineno-100-1" href="#__codelineno-100-1"></a>./splunk<span class="w"> </span>reload<span class="w"> </span>deploy-server
</code></pre></div>
<p>Verify that <code>/opt/splunk/etc/system/local/serverclass.conf</code> aligns with our configuration so far</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-101-1" name="__codelineno-101-1" href="#__codelineno-101-1"></a><span class="n">cat</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">splunk</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">serverclass</span><span class="o">.</span><span class="n">conf</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-102-1" name="__codelineno-102-1" href="#__codelineno-102-1"></a><span class="o">[</span>serverClass:win:app:Splunk_TA_microsoft_sysmon<span class="o">]</span>
<a id="__codelineno-102-2" name="__codelineno-102-2" href="#__codelineno-102-2"></a><span class="nv">restartSplunkWeb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
<a id="__codelineno-102-3" name="__codelineno-102-3" href="#__codelineno-102-3"></a><span class="nv">restartSplunkd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>
<a id="__codelineno-102-4" name="__codelineno-102-4" href="#__codelineno-102-4"></a><span class="nv">stateOnClient</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>enabled
<a id="__codelineno-102-5" name="__codelineno-102-5" href="#__codelineno-102-5"></a>
<a id="__codelineno-102-6" name="__codelineno-102-6" href="#__codelineno-102-6"></a><span class="o">[</span>serverClass:win:app:Splunk_TA_windows<span class="o">]</span>
<a id="__codelineno-102-7" name="__codelineno-102-7" href="#__codelineno-102-7"></a><span class="nv">restartSplunkWeb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
<a id="__codelineno-102-8" name="__codelineno-102-8" href="#__codelineno-102-8"></a><span class="nv">restartSplunkd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>
<a id="__codelineno-102-9" name="__codelineno-102-9" href="#__codelineno-102-9"></a><span class="nv">stateOnClient</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>enabled
<a id="__codelineno-102-10" name="__codelineno-102-10" href="#__codelineno-102-10"></a>
<a id="__codelineno-102-11" name="__codelineno-102-11" href="#__codelineno-102-11"></a><span class="o">[</span>serverClass:win<span class="o">]</span>
<a id="__codelineno-102-12" name="__codelineno-102-12" href="#__codelineno-102-12"></a><span class="nv">machineTypesFilter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>windows-x64
<a id="__codelineno-102-13" name="__codelineno-102-13" href="#__codelineno-102-13"></a>whitelist.0<span class="w"> </span><span class="o">=</span><span class="w"> </span>*
</code></pre></div>
<h2 id="editing-config-files-for-windows-app"><strong>Editing Config Files for Windows App</strong></h2>
<p>On the <strong>Splunk VM</strong> where <strong>Splunk Enterprise</strong> is installed, change into <code>opt/splunk/etc/deployment-apps/Splunk_TA_windows/local</code> directory</p>
<p>Copy <code>app.conf</code> <strong><em>*and <code>inputs.conf</code> from <code>/opt/splunk/etc/deployment-apps/Splunk_TA_windows/default</code> </em></strong>*directory</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-103-1" name="__codelineno-103-1" href="#__codelineno-103-1"></a><span class="nb">cd</span><span class="w"> </span>/opt/splunk/etc/deployment-apps/Splunk_TA_windows/local
<a id="__codelineno-103-2" name="__codelineno-103-2" href="#__codelineno-103-2"></a>cp<span class="w"> </span>/opt/splunk/etc/deployment-apps/Splunk_TA_windows/default/app.conf<span class="w"> </span>.
<a id="__codelineno-103-3" name="__codelineno-103-3" href="#__codelineno-103-3"></a>cp<span class="w"> </span>/opt/splunk/etc/deployment-apps/Splunk_TA_windows/default/inputs.conf<span class="w"> </span>.
</code></pre></div>
<p>Make the following changes to <code>inputs.conf</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-104-1" name="__codelineno-104-1" href="#__codelineno-104-1"></a><span class="n">nano</span> <span class="n">inputs</span><span class="o">.</span><span class="n">conf</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-105-1" name="__codelineno-105-1" href="#__codelineno-105-1"></a><span class="o">[</span>default<span class="o">]</span>
<a id="__codelineno-105-2" name="__codelineno-105-2" href="#__codelineno-105-2"></a><span class="nv">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>wineventlog
<a id="__codelineno-105-3" name="__codelineno-105-3" href="#__codelineno-105-3"></a>
<a id="__codelineno-105-4" name="__codelineno-105-4" href="#__codelineno-105-4"></a><span class="c1">###### OS Logs ######</span>
<a id="__codelineno-105-5" name="__codelineno-105-5" href="#__codelineno-105-5"></a><span class="o">[</span>WinEventLog://Application<span class="o">]</span>
<a id="__codelineno-105-6" name="__codelineno-105-6" href="#__codelineno-105-6"></a><span class="nv">disabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
<a id="__codelineno-105-7" name="__codelineno-105-7" href="#__codelineno-105-7"></a><span class="nv">start_from</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>oldest
<a id="__codelineno-105-8" name="__codelineno-105-8" href="#__codelineno-105-8"></a><span class="nv">current_only</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
<a id="__codelineno-105-9" name="__codelineno-105-9" href="#__codelineno-105-9"></a><span class="nv">checkpointInterval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span>
<a id="__codelineno-105-10" name="__codelineno-105-10" href="#__codelineno-105-10"></a><span class="nv">renderXml</span><span class="o">=</span><span class="nb">false</span><span class="w"> </span>
<a id="__codelineno-105-11" name="__codelineno-105-11" href="#__codelineno-105-11"></a>
<a id="__codelineno-105-12" name="__codelineno-105-12" href="#__codelineno-105-12"></a><span class="o">[</span>WinEventLog://Security<span class="o">]</span>
<a id="__codelineno-105-13" name="__codelineno-105-13" href="#__codelineno-105-13"></a><span class="nv">disabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
<a id="__codelineno-105-14" name="__codelineno-105-14" href="#__codelineno-105-14"></a><span class="nv">start_from</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>oldest
<a id="__codelineno-105-15" name="__codelineno-105-15" href="#__codelineno-105-15"></a><span class="nv">current_only</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
<a id="__codelineno-105-16" name="__codelineno-105-16" href="#__codelineno-105-16"></a><span class="nv">evt_resolve_ad_obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>
<a id="__codelineno-105-17" name="__codelineno-105-17" href="#__codelineno-105-17"></a><span class="nv">checkpointInterval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span>
<a id="__codelineno-105-18" name="__codelineno-105-18" href="#__codelineno-105-18"></a><span class="nv">blacklist1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">EventCode</span><span class="o">=</span><span class="s2">"4662"</span><span class="w"> </span><span class="nv">Message</span><span class="o">=</span><span class="s2">"Object Type:(?!\s*groupPolicyContainer)"</span>
<a id="__codelineno-105-19" name="__codelineno-105-19" href="#__codelineno-105-19"></a><span class="nv">blacklist2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">EventCode</span><span class="o">=</span><span class="s2">"566"</span><span class="w"> </span><span class="nv">Message</span><span class="o">=</span><span class="s2">"Object Type:(?!\s*groupPolicyContainer)"</span>
<a id="__codelineno-105-20" name="__codelineno-105-20" href="#__codelineno-105-20"></a><span class="nv">renderXml</span><span class="o">=</span><span class="nb">false</span><span class="w"> </span>
<a id="__codelineno-105-21" name="__codelineno-105-21" href="#__codelineno-105-21"></a>
<a id="__codelineno-105-22" name="__codelineno-105-22" href="#__codelineno-105-22"></a><span class="o">[</span>WinEventLog://System<span class="o">]</span>
<a id="__codelineno-105-23" name="__codelineno-105-23" href="#__codelineno-105-23"></a><span class="nv">disabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
<a id="__codelineno-105-24" name="__codelineno-105-24" href="#__codelineno-105-24"></a><span class="nv">start_from</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>oldest
<a id="__codelineno-105-25" name="__codelineno-105-25" href="#__codelineno-105-25"></a><span class="nv">current_only</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
<a id="__codelineno-105-26" name="__codelineno-105-26" href="#__codelineno-105-26"></a><span class="nv">checkpointInterval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span>
<a id="__codelineno-105-27" name="__codelineno-105-27" href="#__codelineno-105-27"></a><span class="nv">renderXml</span><span class="o">=</span><span class="nb">false</span>
</code></pre></div>
<p>On WS2019 host where Splunk Universal Forwarder is configured, navigate to <code>C:\Program Files\SplunkUniversalForwarder\etc\apps\Splunk_TA_windows\local</code> . Copy <code>app.conf</code> and <code>inputs.conf</code> from <code>C:\Program Files\SplunkUniversalForwarder\etc\apps\Splunk_TA_windows\default</code> . Edit <code>inputs.conf</code> (same as above). Open the Notepad or Wordpad as administrator and edit the inputs.conf file.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2084.png" data-desc-position="bottom"><img alt="image.png" src="image%2084.png"></a></p>
<p>Restart Splunk Universal Forwarder. On PowerShell, change directory into <code>C:\program files\SplunkUniversalForwarder\bin</code> . Run <code>./splunk restart</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-106-1" name="__codelineno-106-1" href="#__codelineno-106-1"></a><span class="nb">cd </span><span class="s2">"C:\program files\SplunkUniversalForwarder\bin"</span>
<a id="__codelineno-106-2" name="__codelineno-106-2" href="#__codelineno-106-2"></a><span class="p">./</span><span class="n">splunk</span> <span class="n">restart</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-107-1" name="__codelineno-107-1" href="#__codelineno-107-1"></a><span class="c">#Example output</span>
<a id="__codelineno-107-2" name="__codelineno-107-2" href="#__codelineno-107-2"></a><span class="nb">PS </span><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">Administrator</span><span class="p">&gt;</span> <span class="nb">cd </span><span class="s2">"C:\program files\SplunkUniversalForwarder\bin"</span>
<a id="__codelineno-107-3" name="__codelineno-107-3" href="#__codelineno-107-3"></a><span class="nb">PS </span><span class="n">C</span><span class="p">:\</span><span class="n">program</span> <span class="n">files</span><span class="p">\</span><span class="n">SplunkUniversalForwarder</span><span class="p">\</span><span class="n">bin</span><span class="p">&gt;</span> <span class="p">./</span><span class="n">splunk</span> <span class="n">restart</span>
<a id="__codelineno-107-4" name="__codelineno-107-4" href="#__codelineno-107-4"></a><span class="n">SplunkForwarder</span><span class="p">:</span> <span class="n">Stopped</span>
<a id="__codelineno-107-5" name="__codelineno-107-5" href="#__codelineno-107-5"></a>
<a id="__codelineno-107-6" name="__codelineno-107-6" href="#__codelineno-107-6"></a><span class="n">Splunk</span><span class="p">&gt;</span> <span class="n">Another</span> <span class="n">one</span><span class="p">.</span>
<a id="__codelineno-107-7" name="__codelineno-107-7" href="#__codelineno-107-7"></a>
<a id="__codelineno-107-8" name="__codelineno-107-8" href="#__codelineno-107-8"></a><span class="n">Checking</span> <span class="n">prerequisites</span><span class="p">...</span>
<a id="__codelineno-107-9" name="__codelineno-107-9" href="#__codelineno-107-9"></a>        <span class="n">Checking</span> <span class="n">mgmt</span> <span class="n">port</span> <span class="p">[</span><span class="n">8089</span><span class="p">]:</span> <span class="n">open</span>
<a id="__codelineno-107-10" name="__codelineno-107-10" href="#__codelineno-107-10"></a>        <span class="n">Checking</span> <span class="n">conf</span> <span class="n">files</span> <span class="k">for</span> <span class="n">problems</span><span class="p">...</span>
<a id="__codelineno-107-11" name="__codelineno-107-11" href="#__codelineno-107-11"></a>        <span class="n">Done</span>
<a id="__codelineno-107-12" name="__codelineno-107-12" href="#__codelineno-107-12"></a>        <span class="n">Checking</span> <span class="k">default</span> <span class="n">conf</span> <span class="n">files</span> <span class="k">for</span> <span class="n">edits</span><span class="p">...</span>
<a id="__codelineno-107-13" name="__codelineno-107-13" href="#__codelineno-107-13"></a>        <span class="n">Validating</span> <span class="n">installed</span> <span class="n">files</span> <span class="n">against</span> <span class="n">hashes</span> <span class="n">from</span> <span class="s1">'C:\program files\SplunkUniversalForwarder\splunkforwarder-9.3.0-51ccf43db5bd-windows-64-manifest'</span>
<a id="__codelineno-107-14" name="__codelineno-107-14" href="#__codelineno-107-14"></a>        <span class="n">All</span> <span class="n">installed</span> <span class="n">files</span> <span class="n">intact</span><span class="p">.</span>
<a id="__codelineno-107-15" name="__codelineno-107-15" href="#__codelineno-107-15"></a>        <span class="n">Done</span>
<a id="__codelineno-107-16" name="__codelineno-107-16" href="#__codelineno-107-16"></a><span class="n">All</span> <span class="n">preliminary</span> <span class="n">checks</span> <span class="n">passed</span><span class="p">.</span>
<a id="__codelineno-107-17" name="__codelineno-107-17" href="#__codelineno-107-17"></a>
<a id="__codelineno-107-18" name="__codelineno-107-18" href="#__codelineno-107-18"></a><span class="n">Starting</span> <span class="n">splunk</span> <span class="n">server</span> <span class="n">daemon</span> <span class="p">(</span><span class="n">splunkd</span><span class="p">)...</span>
<a id="__codelineno-107-19" name="__codelineno-107-19" href="#__codelineno-107-19"></a>
<a id="__codelineno-107-20" name="__codelineno-107-20" href="#__codelineno-107-20"></a><span class="n">SplunkForwarder</span><span class="p">:</span> <span class="n">Starting</span> <span class="p">(</span><span class="n">pid</span> <span class="n">2328</span><span class="p">)</span>
<a id="__codelineno-107-21" name="__codelineno-107-21" href="#__codelineno-107-21"></a><span class="n">Done</span>
</code></pre></div>
<p>Verify that data is being forwarded on <strong>wineventlog</strong> index. On web UI, navigate to Settings &gt; Indexes and refresh the page. Go to Apps &gt; Search &amp; Reporting &gt; Search for <code>index=wineventlog</code> .</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-108-1" name="__codelineno-108-1" href="#__codelineno-108-1"></a><span class="nv">index</span><span class="o">=</span><span class="s2">"wineventlog"</span>
</code></pre></div>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2085.png" data-desc-position="bottom"><img alt="image.png" src="image%2085.png"></a></p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2086.png" data-desc-position="bottom"><img alt="image.png" src="image%2086.png"></a></p>
<p>If the logs are not being indexed, try refreshing the web UI. </p>
<h2 id="editing-config-files-for-sysmon-app"><strong>Editing Config Files for Sysmon App</strong></h2>
<p>On the <strong>Splunk VM</strong> where <strong>Splunk Enterprise</strong> is installed, change into <code>/opt/splunk/etc/deployment-apps/Splunk_TA_microsoft_sysmon/local</code> ****directory. Copy <code>app.conf</code> and <code>inputs.conf</code> from <code>/opt/splunk/etc/deployment-apps/Splunk_TA_microsoft_sysmon/default</code> directory.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-109-1" name="__codelineno-109-1" href="#__codelineno-109-1"></a><span class="nb">cd</span><span class="w"> </span>/opt/splunk/etc/deployment-apps/Splunk_TA_microsoft_sysmon/local
<a id="__codelineno-109-2" name="__codelineno-109-2" href="#__codelineno-109-2"></a>cp<span class="w"> </span>/opt/splunk/etc/deployment-apps/Splunk_TA_microsoft_sysmon/default/app.conf<span class="w"> </span>.
<a id="__codelineno-109-3" name="__codelineno-109-3" href="#__codelineno-109-3"></a>cp<span class="w"> </span>/opt/splunk/etc/deployment-apps/Splunk_TA_microsoft_sysmon/default/inputs.conf<span class="w"> </span>.
</code></pre></div>
<p>Make the following changes to <code>inputs.conf</code> . Your index name must match with the index name you created earlier</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-110-1" name="__codelineno-110-1" href="#__codelineno-110-1"></a><span class="n">nano</span> <span class="n">inputs</span><span class="o">.</span><span class="n">conf</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-111-1" name="__codelineno-111-1" href="#__codelineno-111-1"></a><span class="o">[</span>default<span class="o">]</span>
<a id="__codelineno-111-2" name="__codelineno-111-2" href="#__codelineno-111-2"></a><span class="nv">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>sysmonlog
<a id="__codelineno-111-3" name="__codelineno-111-3" href="#__codelineno-111-3"></a>
<a id="__codelineno-111-4" name="__codelineno-111-4" href="#__codelineno-111-4"></a><span class="o">[</span>WinEventLog://Microsoft-Windows-Sysmon/Operational<span class="o">]</span>
<a id="__codelineno-111-5" name="__codelineno-111-5" href="#__codelineno-111-5"></a><span class="nv">disabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span>
<a id="__codelineno-111-6" name="__codelineno-111-6" href="#__codelineno-111-6"></a><span class="nv">renderXml</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>
<a id="__codelineno-111-7" name="__codelineno-111-7" href="#__codelineno-111-7"></a><span class="nb">source</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>XmlWinEventLog:Microsoft-Windows-Sysmon/Operational
<a id="__codelineno-111-8" name="__codelineno-111-8" href="#__codelineno-111-8"></a>
<a id="__codelineno-111-9" name="__codelineno-111-9" href="#__codelineno-111-9"></a><span class="o">[</span>WinEventLog://WEC-Sysmon<span class="o">]</span>
<a id="__codelineno-111-10" name="__codelineno-111-10" href="#__codelineno-111-10"></a><span class="nv">disabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span>
<a id="__codelineno-111-11" name="__codelineno-111-11" href="#__codelineno-111-11"></a><span class="nv">renderXml</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>
<a id="__codelineno-111-12" name="__codelineno-111-12" href="#__codelineno-111-12"></a><span class="nb">source</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>XmlWinEventLog:Microsoft-Windows-Sysmon/Operational
<a id="__codelineno-111-13" name="__codelineno-111-13" href="#__codelineno-111-13"></a><span class="nv">sourcetype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>XmlWinEventLog:WEC-Sysmon
<a id="__codelineno-111-14" name="__codelineno-111-14" href="#__codelineno-111-14"></a><span class="nv">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>WinEventLogForwardHost
</code></pre></div>
<p>On WS2019 host where Splunk Universal Forwarder is configured, navigate to </p>
<p><code>C:\Program Files\SplunkUniversalForwarder\etc\apps\Splunk_TA_microsoft_sysmon\local</code> . Copy <code>app.conf</code> and <code>inputs.conf</code> from <code>C:\Program Files\SplunkUniversalForwarder\etc\apps\Splunk_TA_microsoft_sysmon\default</code> . Edit <code>inputs.conf</code> (same as above) </p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2087.png" data-desc-position="bottom"><img alt="image.png" src="image%2087.png"></a></p>
<p>Restart Splunk Universal Forwarder. On PowerShell, change directory into <code>C:\program files\SplunkUniversalForwarder\bin</code> . Run <code>./splunk restart</code> .</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-112-1" name="__codelineno-112-1" href="#__codelineno-112-1"></a><span class="nb">cd </span><span class="s2">"C:\program files\SplunkUniversalForwarder\bin"</span>
<a id="__codelineno-112-2" name="__codelineno-112-2" href="#__codelineno-112-2"></a><span class="p">./</span><span class="n">splunk</span> <span class="n">restart</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-113-1" name="__codelineno-113-1" href="#__codelineno-113-1"></a><span class="c">#Example output</span>
<a id="__codelineno-113-2" name="__codelineno-113-2" href="#__codelineno-113-2"></a><span class="nb">PS </span><span class="n">C</span><span class="p">:\</span><span class="n">program</span> <span class="n">files</span><span class="p">\</span><span class="n">SplunkUniversalForwarder</span><span class="p">\</span><span class="n">bin</span><span class="p">&gt;</span> <span class="p">./</span><span class="n">splunk</span> <span class="n">restart</span>
<a id="__codelineno-113-3" name="__codelineno-113-3" href="#__codelineno-113-3"></a><span class="n">SplunkForwarder</span><span class="p">:</span> <span class="n">Stopped</span>
<a id="__codelineno-113-4" name="__codelineno-113-4" href="#__codelineno-113-4"></a>
<a id="__codelineno-113-5" name="__codelineno-113-5" href="#__codelineno-113-5"></a><span class="n">Splunk</span><span class="p">&gt;</span> <span class="n">Another</span> <span class="n">one</span><span class="p">.</span>
<a id="__codelineno-113-6" name="__codelineno-113-6" href="#__codelineno-113-6"></a>
<a id="__codelineno-113-7" name="__codelineno-113-7" href="#__codelineno-113-7"></a><span class="n">Checking</span> <span class="n">prerequisites</span><span class="p">...</span>
<a id="__codelineno-113-8" name="__codelineno-113-8" href="#__codelineno-113-8"></a>        <span class="n">Checking</span> <span class="n">mgmt</span> <span class="n">port</span> <span class="p">[</span><span class="n">8089</span><span class="p">]:</span> <span class="n">open</span>
<a id="__codelineno-113-9" name="__codelineno-113-9" href="#__codelineno-113-9"></a>        <span class="n">Checking</span> <span class="n">conf</span> <span class="n">files</span> <span class="k">for</span> <span class="n">problems</span><span class="p">...</span>
<a id="__codelineno-113-10" name="__codelineno-113-10" href="#__codelineno-113-10"></a>        <span class="n">Done</span>
<a id="__codelineno-113-11" name="__codelineno-113-11" href="#__codelineno-113-11"></a>        <span class="n">Checking</span> <span class="k">default</span> <span class="n">conf</span> <span class="n">files</span> <span class="k">for</span> <span class="n">edits</span><span class="p">...</span>
<a id="__codelineno-113-12" name="__codelineno-113-12" href="#__codelineno-113-12"></a>        <span class="n">Validating</span> <span class="n">installed</span> <span class="n">files</span> <span class="n">against</span> <span class="n">hashes</span> <span class="n">from</span> <span class="s1">'C:\program files\SplunkUniversalForwarder\splunkforwarder-9.3.0-51ccf43db5bd-windows-64-manifest'</span>
<a id="__codelineno-113-13" name="__codelineno-113-13" href="#__codelineno-113-13"></a>        <span class="n">All</span> <span class="n">installed</span> <span class="n">files</span> <span class="n">intact</span><span class="p">.</span>
<a id="__codelineno-113-14" name="__codelineno-113-14" href="#__codelineno-113-14"></a>        <span class="n">Done</span>
<a id="__codelineno-113-15" name="__codelineno-113-15" href="#__codelineno-113-15"></a><span class="n">All</span> <span class="n">preliminary</span> <span class="n">checks</span> <span class="n">passed</span><span class="p">.</span>
<a id="__codelineno-113-16" name="__codelineno-113-16" href="#__codelineno-113-16"></a>
<a id="__codelineno-113-17" name="__codelineno-113-17" href="#__codelineno-113-17"></a><span class="n">Starting</span> <span class="n">splunk</span> <span class="n">server</span> <span class="n">daemon</span> <span class="p">(</span><span class="n">splunkd</span><span class="p">)...</span>
<a id="__codelineno-113-18" name="__codelineno-113-18" href="#__codelineno-113-18"></a>
<a id="__codelineno-113-19" name="__codelineno-113-19" href="#__codelineno-113-19"></a><span class="n">SplunkForwarder</span><span class="p">:</span> <span class="n">Starting</span> <span class="p">(</span><span class="n">pid</span> <span class="n">4824</span><span class="p">)</span>
<a id="__codelineno-113-20" name="__codelineno-113-20" href="#__codelineno-113-20"></a><span class="n">Done</span>
<a id="__codelineno-113-21" name="__codelineno-113-21" href="#__codelineno-113-21"></a>
<a id="__codelineno-113-22" name="__codelineno-113-22" href="#__codelineno-113-22"></a><span class="nb">PS </span><span class="n">C</span><span class="p">:\</span><span class="n">program</span> <span class="n">files</span><span class="p">\</span><span class="n">SplunkUniversalForwarder</span><span class="p">\</span><span class="n">bin</span><span class="p">&gt;</span>
</code></pre></div>
<p>Verify that Sysmon logs are being indexed. </p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2088.png" data-desc-position="bottom"><img alt="image.png" src="image%2088.png"></a></p>
<p>Search for <code>index=sysmonlog source=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-114-1" name="__codelineno-114-1" href="#__codelineno-114-1"></a><span class="nv">index</span><span class="o">=</span>sysmonlog<span class="w"> </span><span class="nv">source</span><span class="o">=</span>XmlWinEventLog:Microsoft-Windows-Sysmon/Operational
</code></pre></div>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2089.png" data-desc-position="bottom"><img alt="image.png" src="image%2089.png"></a></p>
<h2 id="annex-installing-splunk-uf-on-windows-with-a-virtual-account"><strong>Annex: Installing Splunk UF on Windows with a Virtual Account</strong></h2>
<p>Selecting Virtual Account will create a service account called <code>NT SERVICE\SplunkForwarder</code>. For Sysmon Log Forwarding to work, <code>NT SERVCIE\SplunkForwarder</code> must be assigned as a member of Event Log Readers group through Group Policy. If your Windows host is not joined to a domain and you have technical issues with the Virtual Account, use Local System but note that this is not best security practice. </p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2090.png" data-desc-position="bottom"><img alt="image.png" src="image%2090.png"></a></p>
<p>Leave the values as default and click Next</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2091.png" data-desc-position="bottom"><img alt="image.png" src="image%2091.png"></a></p>
<p>Leave the values as default and click Next (Windows Event Logs forwarding will be configured later).</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2092.png" data-desc-position="bottom"><img alt="image.png" src="image%2092.png"></a></p>
<p>Create admin credentials.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2036.png" data-desc-position="bottom"><img alt="image.png" src="image%2036.png"></a></p>
<p>Enter IP address of your Deployment Server (Splunk server) and port 8089.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2037.png" data-desc-position="bottom"><img alt="image.png" src="image%2037.png"></a></p>
<p>Enter IP address of your Receiving Indexer (Splunk server) and port 9997.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2038.png" data-desc-position="bottom"><img alt="image.png" src="image%2038.png"></a></p>
<p>Click Next and finish install. Navigate to C:\Program Files\SplunkUniversalForwarder. Right-click and select properties. Verify that Splunk Universal Forwarder is configured to run by virtual account SplunkForwarder.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2093.png" data-desc-position="bottom"><img alt="image.png" src="image%2093.png"></a></p>
<p>Open Group Policy Management. Right click on domain name and select Create a GPO in this domain and link it here.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2094.png" data-desc-position="bottom"><img alt="image.png" src="image%2094.png"></a></p>
<p>Name it as Restricted Groups.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2095.png" data-desc-position="bottom"><img alt="image.png" src="image%2095.png"></a></p>
<p>Right click on Restricted Groups and click Edit.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2096.png" data-desc-position="bottom"><img alt="image.png" src="image%2096.png"></a></p>
<p>Navigate to Restricted Groups and Add Group.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2097.png" data-desc-position="bottom"><img alt="image.png" src="image%2097.png"></a></p>
<p>Click Browse.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2098.png" data-desc-position="bottom"><img alt="image.png" src="image%2098.png"></a></p>
<p>Type event log readers and click Check Names. Make sure that the names is underlined. Click OK.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%2099.png" data-desc-position="bottom"><img alt="image.png" src="image%2099.png"></a></p>
<p>Add NT SERVICE\SplunkForwarder as a member of this group. Click OK. Click Apply and OK.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%20100.png" data-desc-position="bottom"><img alt="image.png" src="image%20100.png"></a></p>
<p>Verify the configuration.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%20101.png" data-desc-position="bottom"><img alt="image.png" src="image%20101.png"></a></p>
<p>On Command Prompt as Administrator run the following command to update Group Policy:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-115-1" name="__codelineno-115-1" href="#__codelineno-115-1"></a><span class="n">gpupdate</span> <span class="p">/</span><span class="n">force</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-116-1" name="__codelineno-116-1" href="#__codelineno-116-1"></a><span class="c">#Example output</span>
<a id="__codelineno-116-2" name="__codelineno-116-2" href="#__codelineno-116-2"></a><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">Administrator</span><span class="p">&gt;</span><span class="n">gpupdate</span> <span class="p">/</span><span class="n">force</span>
<a id="__codelineno-116-3" name="__codelineno-116-3" href="#__codelineno-116-3"></a><span class="n">Updating</span> <span class="n">policy</span><span class="p">...</span>
<a id="__codelineno-116-4" name="__codelineno-116-4" href="#__codelineno-116-4"></a>
<a id="__codelineno-116-5" name="__codelineno-116-5" href="#__codelineno-116-5"></a><span class="n">Computer</span> <span class="n">Policy</span> <span class="n">update</span> <span class="n">has</span> <span class="n">completed</span> <span class="n">successfully</span><span class="p">.</span>
<a id="__codelineno-116-6" name="__codelineno-116-6" href="#__codelineno-116-6"></a><span class="n">User</span> <span class="n">Policy</span> <span class="n">update</span> <span class="n">has</span> <span class="n">completed</span> <span class="n">successfully</span><span class="p">.</span>
</code></pre></div>
<p>Restart Splunk UF. If Sysmon logs are not being ingested by Splunk, check Channel Access setting for Sysmon. It is likely that SplunkForwarder is not added to the Channel Access.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-117-1" name="__codelineno-117-1" href="#__codelineno-117-1"></a><span class="n">wevtutil</span> <span class="nb">gl </span><span class="s2">"Microsoft-Windows-Sysmon/Operational"</span>
</code></pre></div>
<p>Get SecurityIdentifier(sid) of SplunkForwarder by running this PowerShell script.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-118-1" name="__codelineno-118-1" href="#__codelineno-118-1"></a><span class="nv">$user</span> <span class="p">=</span> <span class="no">[System.Security.Principal.NTAccount]</span><span class="s2">"NT SERVICE\SplunkForwarder"</span>
<a id="__codelineno-118-2" name="__codelineno-118-2" href="#__codelineno-118-2"></a><span class="nv">$sid</span> <span class="p">=</span> <span class="nv">$user</span><span class="p">.</span><span class="n">Translate</span><span class="p">(</span><span class="no">[System.Security.Principal.SecurityIdentifier]</span><span class="p">)</span>
<a id="__codelineno-118-3" name="__codelineno-118-3" href="#__codelineno-118-3"></a><span class="nb">Write-Output</span> <span class="nv">$sid</span><span class="p">.</span><span class="n">Value</span>
</code></pre></div>
<p>Add SplunkForwarder to Channel Access by running the command below. Add your sid of SplunkForwarder</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-119-1" name="__codelineno-119-1" href="#__codelineno-119-1"></a><span class="n">wevtutil</span> <span class="n">sl</span> <span class="s2">"Microsoft-Windows-Sysmon/Operational"</span> <span class="o">/</span><span class="n">ca</span><span class="p">:</span><span class="s2">"O:BAG:SYD:(A;;0x2;;;S-1-15-2-1)(A;;0x2;;;S-1-5-80-972488765-139171986-783781252-3188962990-3730692313)(A;;0xf0007;;;SY)(A;;0x7;;;BA)(A;;0x1;;;BO)(A;;0x1;;;SO)(A;;0x1;;;S-1-5-32-573)"</span>
</code></pre></div>
<p>Restart Splunk UF.</p>
<h2 id="introduction-to-splunk"><strong>Introduction to Splunk</strong></h2>
<p>Splunk offers free training. You will need to create a user account to access <a href="https://www.splunk.com/en_us/training/course-catalog.html?sort=Newest&amp;filters=filterGroup1FreeCourses">free training materials</a>. The following content is available from the free course Introduction to Splunk. Alternatively, same contents are available from <a href="https://www.youtube.com/@SplunkHowTo">SplunkHowTo YouTube channel</a>.</p>
<p><strong>Refer to Ingesting FortiGate Logs through SC4S and configure Syslog Logging on FortiGate on port 514.</strong> </p>
<h3 id="attack-simulation"><strong>Attack Simulation</strong></h3>
<p>Run nmap scan against FortiGate VMs internal IP address. From the nmap scan result, we can see that port 22 for ssh is open and belongs to FortiGate. </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-120-1" name="__codelineno-120-1" href="#__codelineno-120-1"></a>nmap<span class="w"> </span>-sC<span class="w"> </span>-sV<span class="w"> </span><span class="m">10</span>.0.0.1<span class="w"> </span>-v
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-121-1" name="__codelineno-121-1" href="#__codelineno-121-1"></a><span class="c1">#Example output</span>
<a id="__codelineno-121-2" name="__codelineno-121-2" href="#__codelineno-121-2"></a>PORT<span class="w">    </span>STATE<span class="w">  </span>SERVICE<span class="w">   </span>VERSION
<a id="__codelineno-121-3" name="__codelineno-121-3" href="#__codelineno-121-3"></a><span class="m">22</span>/tcp<span class="w">  </span>open<span class="w">   </span>ssh<span class="w">       </span>FortiSSH<span class="w"> </span><span class="o">(</span>protocol<span class="w"> </span><span class="m">2</span>.0<span class="o">)</span>
<a id="__codelineno-121-4" name="__codelineno-121-4" href="#__codelineno-121-4"></a><span class="p">|</span><span class="w"> </span>ssh-hostkey:<span class="w"> </span>
<a id="__codelineno-121-5" name="__codelineno-121-5" href="#__codelineno-121-5"></a><span class="p">|</span><span class="w">   </span><span class="m">256</span><span class="w"> </span><span class="m">63</span>:3a:d1:25:e2:97:c3:52:e8:00:77:b5:0f:db:2d:9a<span class="w"> </span><span class="o">(</span>ECDSA<span class="o">)</span>
<a id="__codelineno-121-6" name="__codelineno-121-6" href="#__codelineno-121-6"></a><span class="p">|</span><span class="w">   </span><span class="m">384</span><span class="w"> </span><span class="m">41</span>:0d:b6:d0:af:43:08:fe:5b:64:e3:de:7f:80:6c:82<span class="w"> </span><span class="o">(</span>ECDSA<span class="o">)</span>
<a id="__codelineno-121-7" name="__codelineno-121-7" href="#__codelineno-121-7"></a><span class="p">|</span><span class="w">   </span><span class="m">521</span><span class="w"> </span>1f:ac:5e:96:a2:70:a5:ea:f2:3f:e4:12:fd:23:aa:94<span class="w"> </span><span class="o">(</span>ECDSA<span class="o">)</span>
<a id="__codelineno-121-8" name="__codelineno-121-8" href="#__codelineno-121-8"></a><span class="p">|</span>_<span class="w">  </span><span class="m">256</span><span class="w"> </span><span class="m">45</span>:77:22:18:b8:13:bb:6d:60:bf:87:91:95:f3:d9:02<span class="w"> </span><span class="o">(</span>ED25519<span class="o">)</span>
<a id="__codelineno-121-9" name="__codelineno-121-9" href="#__codelineno-121-9"></a><span class="m">113</span>/tcp<span class="w"> </span>closed<span class="w"> </span>ident
<a id="__codelineno-121-10" name="__codelineno-121-10" href="#__codelineno-121-10"></a><span class="m">443</span>/tcp<span class="w"> </span>open<span class="w">   </span>ssl/https
<a id="__codelineno-121-11" name="__codelineno-121-11" href="#__codelineno-121-11"></a><span class="p">|</span><span class="w"> </span>ssl-cert:<span class="w"> </span>Subject:<span class="w"> </span><span class="nv">commonName</span><span class="o">=</span>FortiGate/organizationName<span class="o">=</span>Fortinet<span class="w"> </span>Ltd./stateOrProvinceName<span class="o">=</span>California/countryName<span class="o">=</span>US
<a id="__codelineno-121-12" name="__codelineno-121-12" href="#__codelineno-121-12"></a><span class="p">|</span><span class="w"> </span>Subject<span class="w"> </span>Alternative<span class="w"> </span>Name:<span class="w"> </span>IP<span class="w"> </span>Address:192.168.1.10,<span class="w"> </span>IP<span class="w"> </span>Address:10.0.0.1
<a id="__codelineno-121-13" name="__codelineno-121-13" href="#__codelineno-121-13"></a><span class="p">|</span><span class="w"> </span>Issuer:<span class="w"> </span><span class="nv">commonName</span><span class="o">=</span>FGVMEVMBF57GNJF3/organizationName<span class="o">=</span>Fortinet/stateOrProvinceName<span class="o">=</span>California/countryName<span class="o">=</span>US
<a id="__codelineno-121-14" name="__codelineno-121-14" href="#__codelineno-121-14"></a><span class="p">|</span><span class="w"> </span>Public<span class="w"> </span>Key<span class="w"> </span>type:<span class="w"> </span>rsa
<a id="__codelineno-121-15" name="__codelineno-121-15" href="#__codelineno-121-15"></a><span class="p">|</span><span class="w"> </span>Public<span class="w"> </span>Key<span class="w"> </span>bits:<span class="w"> </span><span class="m">2048</span>
<a id="__codelineno-121-16" name="__codelineno-121-16" href="#__codelineno-121-16"></a><span class="p">|</span><span class="w"> </span>Signature<span class="w"> </span>Algorithm:<span class="w"> </span>sha256WithRSAEncryption
<a id="__codelineno-121-17" name="__codelineno-121-17" href="#__codelineno-121-17"></a><span class="p">|</span><span class="w"> </span>Not<span class="w"> </span>valid<span class="w"> </span>before:<span class="w"> </span><span class="m">2025</span>-02-25T22:28:01
<a id="__codelineno-121-18" name="__codelineno-121-18" href="#__codelineno-121-18"></a><span class="p">|</span><span class="w"> </span>Not<span class="w"> </span>valid<span class="w"> </span>after:<span class="w">  </span><span class="m">2027</span>-05-31T22:28:01
<a id="__codelineno-121-19" name="__codelineno-121-19" href="#__codelineno-121-19"></a><span class="p">|</span><span class="w"> </span>MD5:<span class="w">   </span><span class="m">1757</span>:d25d:ec8e:5eae:92ef:1b01:91a6:9fb1
<a id="__codelineno-121-20" name="__codelineno-121-20" href="#__codelineno-121-20"></a><span class="p">|</span>_SHA-1:<span class="w"> </span><span class="m">9246</span>:9b61:fbab:1a64:aeac:da55:7ebf:277f:05e5:65ec
<a id="__codelineno-121-21" name="__codelineno-121-21" href="#__codelineno-121-21"></a>&lt;SNIP&gt;
</code></pre></div>
<p>Create a usernames text file containing default usernames for FortiGate. Create a passwords text file containing passwords.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-122-1" name="__codelineno-122-1" href="#__codelineno-122-1"></a>nano<span class="w"> </span>usernames.txt
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-123-1" name="__codelineno-123-1" href="#__codelineno-123-1"></a>admin
<a id="__codelineno-123-2" name="__codelineno-123-2" href="#__codelineno-123-2"></a>administrator
<a id="__codelineno-123-3" name="__codelineno-123-3" href="#__codelineno-123-3"></a>adm
<a id="__codelineno-123-4" name="__codelineno-123-4" href="#__codelineno-123-4"></a>fortigate
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-124-1" name="__codelineno-124-1" href="#__codelineno-124-1"></a>nano<span class="w"> </span>passwords.txt
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-125-1" name="__codelineno-125-1" href="#__codelineno-125-1"></a>P@ssw0rd
<a id="__codelineno-125-2" name="__codelineno-125-2" href="#__codelineno-125-2"></a>password
<a id="__codelineno-125-3" name="__codelineno-125-3" href="#__codelineno-125-3"></a>password123
<a id="__codelineno-125-4" name="__codelineno-125-4" href="#__codelineno-125-4"></a>qwerty
<a id="__codelineno-125-5" name="__codelineno-125-5" href="#__codelineno-125-5"></a>admin
</code></pre></div>
<p>Using the usernames and passwords text file, run Hydra to perform a brute-force attack on FortiGate's SSH service.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-126-1" name="__codelineno-126-1" href="#__codelineno-126-1"></a>hydra<span class="w"> </span>-L<span class="w"> </span>usernames.txt<span class="w"> </span>-P<span class="w"> </span>passwords.txt<span class="w"> </span>ssh://10.0.0.1<span class="w"> </span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-127-1" name="__codelineno-127-1" href="#__codelineno-127-1"></a><span class="c1">#Example output</span>
<a id="__codelineno-127-2" name="__codelineno-127-2" href="#__codelineno-127-2"></a>$<span class="w"> </span>hydra<span class="w"> </span>-L<span class="w"> </span>usernames.txt<span class="w"> </span>-P<span class="w"> </span>passwords.txt<span class="w"> </span>ssh://10.0.0.1<span class="w"> </span>
<a id="__codelineno-127-3" name="__codelineno-127-3" href="#__codelineno-127-3"></a>
<a id="__codelineno-127-4" name="__codelineno-127-4" href="#__codelineno-127-4"></a>Hydra<span class="w"> </span>v9.5<span class="w"> </span><span class="o">(</span>c<span class="o">)</span><span class="w"> </span><span class="m">2023</span><span class="w"> </span>by<span class="w"> </span>van<span class="w"> </span>Hauser/THC<span class="w"> </span><span class="p">&amp;</span><span class="w"> </span>David<span class="w"> </span>Maciejak<span class="w"> </span>-<span class="w"> </span>Please<span class="w"> </span><span class="k">do</span><span class="w"> </span>not<span class="w"> </span>use<span class="w"> </span><span class="k">in</span><span class="w"> </span>military<span class="w"> </span>or<span class="w"> </span>secret<span class="w"> </span>service<span class="w"> </span>organizations,<span class="w"> </span>or<span class="w"> </span><span class="k">for</span><span class="w"> </span>illegal<span class="w"> </span>purposes<span class="w"> </span><span class="o">(</span>this<span class="w"> </span>is<span class="w"> </span>non-binding,<span class="w"> </span>these<span class="w"> </span>***<span class="w"> </span>ignore<span class="w"> </span>laws<span class="w"> </span>and<span class="w"> </span>ethics<span class="w"> </span>anyway<span class="o">)</span>.
<a id="__codelineno-127-5" name="__codelineno-127-5" href="#__codelineno-127-5"></a>
<a id="__codelineno-127-6" name="__codelineno-127-6" href="#__codelineno-127-6"></a>Hydra<span class="w"> </span><span class="o">(</span>https://github.com/vanhauser-thc/thc-hydra<span class="o">)</span><span class="w"> </span>starting<span class="w"> </span>at<span class="w"> </span><span class="m">2025</span>-02-27<span class="w"> </span><span class="m">14</span>:25:56
<a id="__codelineno-127-7" name="__codelineno-127-7" href="#__codelineno-127-7"></a><span class="o">[</span>WARNING<span class="o">]</span><span class="w"> </span>Many<span class="w"> </span>SSH<span class="w"> </span>configurations<span class="w"> </span>limit<span class="w"> </span>the<span class="w"> </span>number<span class="w"> </span>of<span class="w"> </span>parallel<span class="w"> </span>tasks,<span class="w"> </span>it<span class="w"> </span>is<span class="w"> </span>recommended<span class="w"> </span>to<span class="w"> </span>reduce<span class="w"> </span>the<span class="w"> </span>tasks:<span class="w"> </span>use<span class="w"> </span>-t<span class="w"> </span><span class="m">4</span>
<a id="__codelineno-127-8" name="__codelineno-127-8" href="#__codelineno-127-8"></a><span class="o">[</span>DATA<span class="o">]</span><span class="w"> </span>max<span class="w"> </span><span class="m">16</span><span class="w"> </span>tasks<span class="w"> </span>per<span class="w"> </span><span class="m">1</span><span class="w"> </span>server,<span class="w"> </span>overall<span class="w"> </span><span class="m">16</span><span class="w"> </span>tasks,<span class="w"> </span><span class="m">24</span><span class="w"> </span>login<span class="w"> </span>tries<span class="w"> </span><span class="o">(</span>l:4/p:6<span class="o">)</span>,<span class="w"> </span>~2<span class="w"> </span>tries<span class="w"> </span>per<span class="w"> </span>task
<a id="__codelineno-127-9" name="__codelineno-127-9" href="#__codelineno-127-9"></a><span class="o">[</span>DATA<span class="o">]</span><span class="w"> </span>attacking<span class="w"> </span>ssh://10.0.0.1:22/
<a id="__codelineno-127-10" name="__codelineno-127-10" href="#__codelineno-127-10"></a><span class="o">[</span><span class="m">22</span><span class="o">][</span>ssh<span class="o">]</span><span class="w"> </span>host:<span class="w"> </span><span class="m">10</span>.0.0.1<span class="w">   </span>login:<span class="w"> </span>admin<span class="w">   </span>password:<span class="w"> </span>admin
<a id="__codelineno-127-11" name="__codelineno-127-11" href="#__codelineno-127-11"></a><span class="o">[</span>ERROR<span class="o">]</span><span class="w"> </span>ssh<span class="w"> </span>target<span class="w"> </span>does<span class="w"> </span>not<span class="w"> </span>support<span class="w"> </span>password<span class="w"> </span>auth
<a id="__codelineno-127-12" name="__codelineno-127-12" href="#__codelineno-127-12"></a><span class="o">[</span>ERROR<span class="o">]</span><span class="w"> </span>ssh<span class="w"> </span>target<span class="w"> </span>does<span class="w"> </span>not<span class="w"> </span>support<span class="w"> </span>password<span class="w"> </span>auth
<a id="__codelineno-127-13" name="__codelineno-127-13" href="#__codelineno-127-13"></a><span class="o">[</span>ERROR<span class="o">]</span><span class="w"> </span>ssh<span class="w"> </span>target<span class="w"> </span>does<span class="w"> </span>not<span class="w"> </span>support<span class="w"> </span>password<span class="w"> </span>auth
<a id="__codelineno-127-14" name="__codelineno-127-14" href="#__codelineno-127-14"></a><span class="o">[</span>ERROR<span class="o">]</span><span class="w"> </span>ssh<span class="w"> </span>target<span class="w"> </span>does<span class="w"> </span>not<span class="w"> </span>support<span class="w"> </span>password<span class="w"> </span>auth
<a id="__codelineno-127-15" name="__codelineno-127-15" href="#__codelineno-127-15"></a><span class="o">[</span>ERROR<span class="o">]</span><span class="w"> </span>ssh<span class="w"> </span>target<span class="w"> </span>does<span class="w"> </span>not<span class="w"> </span>support<span class="w"> </span>password<span class="w"> </span>auth
<a id="__codelineno-127-16" name="__codelineno-127-16" href="#__codelineno-127-16"></a><span class="o">[</span>ERROR<span class="o">]</span><span class="w"> </span>ssh<span class="w"> </span>target<span class="w"> </span>does<span class="w"> </span>not<span class="w"> </span>support<span class="w"> </span>password<span class="w"> </span>auth
<a id="__codelineno-127-17" name="__codelineno-127-17" href="#__codelineno-127-17"></a><span class="o">[</span>ERROR<span class="o">]</span><span class="w"> </span>ssh<span class="w"> </span>target<span class="w"> </span>does<span class="w"> </span>not<span class="w"> </span>support<span class="w"> </span>password<span class="w"> </span>auth
<a id="__codelineno-127-18" name="__codelineno-127-18" href="#__codelineno-127-18"></a><span class="o">[</span>ERROR<span class="o">]</span><span class="w"> </span>ssh<span class="w"> </span>target<span class="w"> </span>does<span class="w"> </span>not<span class="w"> </span>support<span class="w"> </span>password<span class="w"> </span>auth
<a id="__codelineno-127-19" name="__codelineno-127-19" href="#__codelineno-127-19"></a><span class="o">[</span>ERROR<span class="o">]</span><span class="w"> </span>ssh<span class="w"> </span>target<span class="w"> </span>does<span class="w"> </span>not<span class="w"> </span>support<span class="w"> </span>password<span class="w"> </span>auth
<a id="__codelineno-127-20" name="__codelineno-127-20" href="#__codelineno-127-20"></a><span class="o">[</span>ERROR<span class="o">]</span><span class="w"> </span>ssh<span class="w"> </span>target<span class="w"> </span>does<span class="w"> </span>not<span class="w"> </span>support<span class="w"> </span>password<span class="w"> </span>auth
<a id="__codelineno-127-21" name="__codelineno-127-21" href="#__codelineno-127-21"></a><span class="o">[</span>ERROR<span class="o">]</span><span class="w"> </span>all<span class="w"> </span>children<span class="w"> </span>were<span class="w"> </span>disabled<span class="w"> </span>due<span class="w"> </span>too<span class="w"> </span>many<span class="w"> </span>connection<span class="w"> </span>errors
<a id="__codelineno-127-22" name="__codelineno-127-22" href="#__codelineno-127-22"></a><span class="m">0</span><span class="w"> </span>of<span class="w"> </span><span class="m">1</span><span class="w"> </span>target<span class="w"> </span>successfully<span class="w"> </span>completed,<span class="w"> </span><span class="m">1</span><span class="w"> </span>valid<span class="w"> </span>password<span class="w"> </span>found
<a id="__codelineno-127-23" name="__codelineno-127-23" href="#__codelineno-127-23"></a><span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Writing<span class="w"> </span>restore<span class="w"> </span>file<span class="w"> </span>because<span class="w"> </span><span class="m">2</span><span class="w"> </span>server<span class="w"> </span>scans<span class="w"> </span>could<span class="w"> </span>not<span class="w"> </span>be<span class="w"> </span>completed
<a id="__codelineno-127-24" name="__codelineno-127-24" href="#__codelineno-127-24"></a><span class="o">[</span>ERROR<span class="o">]</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>target<span class="w"> </span>was<span class="w"> </span>disabled<span class="w"> </span>because<span class="w"> </span>of<span class="w"> </span>too<span class="w"> </span>many<span class="w"> </span>errors
<a id="__codelineno-127-25" name="__codelineno-127-25" href="#__codelineno-127-25"></a><span class="o">[</span>ERROR<span class="o">]</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>targets<span class="w"> </span>did<span class="w"> </span>not<span class="w"> </span><span class="nb">complete</span>
<a id="__codelineno-127-26" name="__codelineno-127-26" href="#__codelineno-127-26"></a>Hydra<span class="w"> </span><span class="o">(</span>https://github.com/vanhauser-thc/thc-hydra<span class="o">)</span><span class="w"> </span>finished<span class="w"> </span>at<span class="w"> </span><span class="m">2025</span>-02-27<span class="w"> </span><span class="m">14</span>:25:57
</code></pre></div>
<p>To generate failed login events from multiple different hosts, SSH into the FortiGate using a valid username but a random password. </p>
<p>From Splunk and Ubuntu VM:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-128-1" name="__codelineno-128-1" href="#__codelineno-128-1"></a>ssh<span class="w"> </span>admin@10.0.0.1
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-129-1" name="__codelineno-129-1" href="#__codelineno-129-1"></a><span class="c1">#Example output</span>
<a id="__codelineno-129-2" name="__codelineno-129-2" href="#__codelineno-129-2"></a>The<span class="w"> </span>authenticity<span class="w"> </span>of<span class="w"> </span>host<span class="w"> </span><span class="s1">'10.0.0.1 (10.0.0.1)'</span><span class="w"> </span>can<span class="s1">'t be established.</span>
<a id="__codelineno-129-3" name="__codelineno-129-3" href="#__codelineno-129-3"></a><span class="s1">ED25519 key fingerprint is SHA256:zuocT3kebXHrIVyokxu2EKQTKhuxG/ikAQb2K+uZY54.</span>
<a id="__codelineno-129-4" name="__codelineno-129-4" href="#__codelineno-129-4"></a><span class="s1">This key is not known by any other names.</span>
<a id="__codelineno-129-5" name="__codelineno-129-5" href="#__codelineno-129-5"></a><span class="s1">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span>
<a id="__codelineno-129-6" name="__codelineno-129-6" href="#__codelineno-129-6"></a><span class="s1">Warning: Permanently added '</span><span class="m">10</span>.0.0.1<span class="s1">' (ED25519) to the list of known hosts.</span>
<a id="__codelineno-129-7" name="__codelineno-129-7" href="#__codelineno-129-7"></a><span class="s1">admin@10.0.0.1'</span>s<span class="w"> </span>password:<span class="w"> </span>
<a id="__codelineno-129-8" name="__codelineno-129-8" href="#__codelineno-129-8"></a>Permission<span class="w"> </span>denied,<span class="w"> </span>please<span class="w"> </span>try<span class="w"> </span>again.
<a id="__codelineno-129-9" name="__codelineno-129-9" href="#__codelineno-129-9"></a>admin@10.0.0.1<span class="s1">'s password: </span>
<a id="__codelineno-129-10" name="__codelineno-129-10" href="#__codelineno-129-10"></a><span class="s1">Permission denied, please try again.</span>
<a id="__codelineno-129-11" name="__codelineno-129-11" href="#__codelineno-129-11"></a><span class="s1">admin@10.0.0.1'</span>s<span class="w"> </span>password:<span class="w"> </span>
<a id="__codelineno-129-12" name="__codelineno-129-12" href="#__codelineno-129-12"></a>Received<span class="w"> </span>disconnect<span class="w"> </span>from<span class="w"> </span><span class="m">10</span>.0.0.1<span class="w"> </span>port<span class="w"> </span><span class="m">22</span>:2:<span class="w"> </span>Too<span class="w"> </span>many<span class="w"> </span>authentication<span class="w"> </span>failures
<a id="__codelineno-129-13" name="__codelineno-129-13" href="#__codelineno-129-13"></a>Disconnected<span class="w"> </span>from<span class="w"> </span><span class="m">10</span>.0.0.1<span class="w"> </span>port<span class="w"> </span><span class="m">22</span>
</code></pre></div>
<p>To generate login successful events, SSH into FortiGate using a valid credentials. You will need to wait until the connection is reset by FortiGate.</p>
<p>From Splunk and Ubuntu VM:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-130-1" name="__codelineno-130-1" href="#__codelineno-130-1"></a>ssh<span class="w"> </span>admin@10.0.0.1
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-131-1" name="__codelineno-131-1" href="#__codelineno-131-1"></a>WARNING:<span class="w"> </span>File<span class="w"> </span>System<span class="w"> </span>Check<span class="w"> </span>Recommended!<span class="w"> </span>An<span class="w"> </span>unsafe<span class="w"> </span>reboot<span class="w"> </span>may<span class="w"> </span>have<span class="w"> </span>caused<span class="w"> </span>an<span class="w"> </span>inconsistency<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>disk<span class="w"> </span>drive.
<a id="__codelineno-131-2" name="__codelineno-131-2" href="#__codelineno-131-2"></a>It<span class="w"> </span>is<span class="w"> </span>strongly<span class="w"> </span>recommended<span class="w"> </span>that<span class="w"> </span>you<span class="w"> </span>check<span class="w"> </span>the<span class="w"> </span>file<span class="w"> </span>system<span class="w"> </span>consistency<span class="w"> </span>before<span class="w"> </span>proceeding.
<a id="__codelineno-131-3" name="__codelineno-131-3" href="#__codelineno-131-3"></a>Please<span class="w"> </span>run<span class="w"> </span><span class="s1">'execute disk list'</span><span class="w"> </span>and<span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="s1">'execute disk scan &lt;ref#&gt;'</span>.
<a id="__codelineno-131-4" name="__codelineno-131-4" href="#__codelineno-131-4"></a>Note:<span class="w"> </span>The<span class="w"> </span>device<span class="w"> </span>will<span class="w"> </span>reboot<span class="w"> </span>and<span class="w"> </span>scan<span class="w"> </span>the<span class="w"> </span>disk<span class="w"> </span>during<span class="w"> </span>startup.<span class="w"> </span>This<span class="w"> </span>may<span class="w"> </span>take<span class="w"> </span>up<span class="w"> </span>to<span class="w"> </span>an<span class="w"> </span>hour.
<a id="__codelineno-131-5" name="__codelineno-131-5" href="#__codelineno-131-5"></a>FGVMEVMBF57GNJF3<span class="w"> </span><span class="c1"># exit</span>
<a id="__codelineno-131-6" name="__codelineno-131-6" href="#__codelineno-131-6"></a>Connection<span class="w"> </span>to<span class="w"> </span><span class="m">10</span>.0.0.1<span class="w"> </span>closed.
</code></pre></div>
<h3 id="creating-reports"><strong>Creating Reports</strong></h3>
<p>On Splunk Enterprise web UI, search for login failed events on FortiGate.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-132-1" name="__codelineno-132-1" href="#__codelineno-132-1"></a><span class="n">index</span><span class="o">=*</span> <span class="n">sourcetype</span><span class="o">=</span><span class="s2">"fortigate_event"</span> <span class="n">login</span> <span class="n">failed</span>
</code></pre></div>
<p>Select <strong>srcip</strong> from Interesting Fields, then select Top values.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%20102.png" data-desc-position="bottom"><img alt="image.png" src="image%20102.png"></a></p>
<p>This will visualise data as a bar chart. Save As Report.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%20103.png" data-desc-position="bottom"><img alt="image.png" src="image%20103.png"></a></p>
<p>Set Title as <strong>Security_Report_Failed_SSH_Login_Attempts.</strong> Set Content as Bar Chart. Select Yes for Time Range Picker. Click Save.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%20104.png" data-desc-position="bottom"><img alt="image.png" src="image%20104.png"></a></p>
<p>Select View</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%20105.png" data-desc-position="bottom"><img alt="image.png" src="image%20105.png"></a></p>
<p>Select Time Range as All time and click Reports.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%20106.png" data-desc-position="bottom"><img alt="image.png" src="image%20106.png"></a></p>
<p>Edit Permissions for Security_Report_Failed_SSH_Login_Attempts.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%20107.png" data-desc-position="bottom"><img alt="image.png" src="image%20107.png"></a></p>
<p>Select following options:</p>
<ul>
<li>Display For App</li>
<li>Run As User</li>
<li>Assign Read to Everyone</li>
</ul>
<p>Click Save</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%20108.png" data-desc-position="bottom"><img alt="image.png" src="image%20108.png"></a></p>
<p>Edit Schedule (optional). Scheduling Report can reduce strain on your environment caused by repeatedly running new ad-hoc searches. Select Schedule and Time Range of your preference (leave as default). Click Save.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%20109.png" data-desc-position="bottom"><img alt="image.png" src="image%20109.png"></a></p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%20110.png" data-desc-position="bottom"><img alt="image.png" src="image%20110.png"></a></p>
<h3 id="creating-alerts"><strong>Creating Alerts</strong></h3>
<p>On Splunk Enterprise web UI, search for Admin login failed events on FortiGate.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-133-1" name="__codelineno-133-1" href="#__codelineno-133-1"></a><span class="nv">index</span><span class="o">=</span>*<span class="w"> </span><span class="nv">sourcetype</span><span class="o">=</span><span class="s2">"fortigate_event"</span><span class="w"> </span>login<span class="w"> </span>failed
</code></pre></div>
<p>Save As Alert</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%20111.png" data-desc-position="bottom"><img alt="image.png" src="image%20111.png"></a></p>
<p>Set Title as FortiGate Login Failures. Set Permissions to Private. Set Alert type as Schedules to Run every hours and Expire after 24 hours. Set Trigger Conditions to trigger alert when Number of Results is greater than 10 and trigger Once. Select Throttle (after an alert is triggered, subsequent alerts will not be triggered until after the throttle period). Suppress trigger for 60 seconds. Set Trigger Actions to Add to Trigger Alerts with High Severity. Click Save. </p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%20112.png" data-desc-position="bottom"><img alt="image.png" src="image%20112.png"></a></p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%20113.png" data-desc-position="bottom"><img alt="image.png" src="image%20113.png"></a></p>
<p>Click Permissions</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%20114.png" data-desc-position="bottom"><img alt="image.png" src="image%20114.png"></a></p>
<p>Select Display For App. Assign Read access to Everyone. Click Save.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%20115.png" data-desc-position="bottom"><img alt="image.png" src="image%20115.png"></a></p>
<p>Select Edit Alert again</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%20116.png" data-desc-position="bottom"><img alt="image.png" src="image%20116.png"></a></p>
<p>Change Alert type to Real-time. Suppress all fields containing field value by entering a asterisk. Click Save.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%20117.png" data-desc-position="bottom"><img alt="image.png" src="image%20117.png"></a></p>
<p>Click Triggered Alerts.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%20118.png" data-desc-position="bottom"><img alt="image.png" src="image%20118.png"></a></p>
<p>Alternatively, Triggered Alerts can be viewed on the Activity tab (Activity &gt; Triggered Alerts). If you dont see your alerts, manually trigger alerts by running Hydra on Kali VM. </p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%20119.png" data-desc-position="bottom"><img alt="image.png" src="image%20119.png"></a></p>
<p>Alerts and Reports can also be viewed from Setting &gt; Searches, reports, and alerts</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%20120.png" data-desc-position="bottom"><img alt="image.png" src="image%20120.png"></a></p>
<h3 id="creating-dashboards"><strong>Creating Dashboards</strong></h3>
<p>On Splunk Enterprise web UI, search for login failed events on FortiGate.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-134-1" name="__codelineno-134-1" href="#__codelineno-134-1"></a><span class="n">index</span><span class="o">=*</span> <span class="n">sourcetype</span><span class="o">=</span><span class="s2">"fortigate_event"</span> <span class="n">login</span> <span class="n">failed</span>
</code></pre></div>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%20121.png" data-desc-position="bottom"><img alt="image.png" src="image%20121.png"></a></p>
<p>From the Interesting Fields panel, Select more fields. </p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%20122.png" data-desc-position="bottom"><img alt="image.png" src="image%20122.png"></a></p>
<p>Search for user and select user_name, then close the window.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%20123.png" data-desc-position="bottom"><img alt="image.png" src="image%20123.png"></a></p>
<p>The selected <strong>user_name</strong> field should now appear in the selected fields. Select <strong>user_name</strong> then top values. </p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%20124.png" data-desc-position="bottom"><img alt="image.png" src="image%20124.png"></a></p>
<p>This will generate a Visualisation that is most suitable for our data.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%20125.png" data-desc-position="bottom"><img alt="image.png" src="image%20125.png"></a></p>
<p>Select Bar Chart and select Pie Chart.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%20126.png" data-desc-position="bottom"><img alt="image.png" src="image%20126.png"></a></p>
<p>Select Save As, then New Dashboard.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%20127.png" data-desc-position="bottom"><img alt="image.png" src="image%20127.png"></a></p>
<p>Set Dashboard Title as FortiGate Logins and leave Permissions as Private. Select Classic Dashboards (we will explore Dashboard Studio later). Set Panel Title as Failed Logins by User. Set Visualization Type as Pie Chart. Save to Dashboard. </p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%20128.png" data-desc-position="bottom"><img alt="image.png" src="image%20128.png"></a></p>
<p>View Dashboard</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%20129.png" data-desc-position="bottom"><img alt="image.png" src="image%20129.png"></a></p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%20130.png" data-desc-position="bottom"><img alt="image.png" src="image%20130.png"></a></p>
<p>Go back to Search and search for FortiGate login events (not login failed). </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-135-1" name="__codelineno-135-1" href="#__codelineno-135-1"></a><span class="nv">index</span><span class="o">=</span>*<span class="w"> </span><span class="nv">sourcetype</span><span class="o">=</span><span class="s2">"fortigate_event"</span><span class="w"> </span>login
</code></pre></div>
<p>In the Interesting Fields panel, select logdesc, then Top values by time</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%20131.png" data-desc-position="bottom"><img alt="image.png" src="image%20131.png"></a></p>
<p>This shows the login trends over time as a line chart.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%20132.png" data-desc-position="bottom"><img alt="image.png" src="image%20132.png"></a></p>
<p>Select Format, then Legend. Select Legend Position as Left. This positions the legend to the left. </p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%20133.png" data-desc-position="bottom"><img alt="image.png" src="image%20133.png"></a></p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%20134.png" data-desc-position="bottom"><img alt="image.png" src="image%20134.png"></a></p>
<p>Select General. Select Min/Max in Show Data Values. This shows data values on the peak of the graph.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%20135.png" data-desc-position="bottom"><img alt="image.png" src="image%20135.png"></a></p>
<p>Save As Existing Dashboard. Select FortiGate Logins. Save to Dashboard.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%20136.png" data-desc-position="bottom"><img alt="image.png" src="image%20136.png"></a></p>
<p>View Dashboard</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%20137.png" data-desc-position="bottom"><img alt="image.png" src="image%20137.png"></a></p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%20138.png" data-desc-position="bottom"><img alt="image.png" src="image%20138.png"></a></p>
<p>Click Edit on top right. Add Panel. Select New from Report. Select Security_Report_Failed_SSH_Login_Attempts. Select Add to Dashboard</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%20139.png" data-desc-position="bottom"><img alt="image.png" src="image%20139.png"></a></p>
<p>Drag and Drop Bar Chart next to the Pie Chart. Edit Drilldown on the Pie Chart.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%20140.png" data-desc-position="bottom"><img alt="image.png" src="image%20140.png"></a></p>
<p>Set Drilldown Action On click to Link to Search. Click Apply.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%20141.png" data-desc-position="bottom"><img alt="image.png" src="image%20141.png"></a></p>
<p>Save the Dashboard.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%20142.png" data-desc-position="bottom"><img alt="image.png" src="image%20142.png"></a></p>
<p>Since we configured Link to Search, clicking 'admin' on the pie chart will redirect you to the Search and Reporting page with the search query automatically populated.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%20143.png" data-desc-position="bottom"><img alt="image.png" src="image%20143.png"></a></p>
<h3 id="cloning-in-dashboard-studio"><strong>Cloning in Dashboard Studio</strong></h3>
<p>While the FortiGate Logins Dashboard is open, select Clone in Dashboard Studio.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%20144.png" data-desc-position="bottom"><img alt="image.png" src="image%20144.png"></a></p>
<p>Set Title as FortiGate Logins - Dashboard Studio. Select Grid layout. Click Convert &amp; Save.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%20145.png" data-desc-position="bottom"><img alt="image.png" src="image%20145.png"></a></p>
<p>Click Save. If Save button is greyed out, toggle Add submit button then click Save. Click View. We have successfully cloned the dashboard in dashboard studio.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%20146.png" data-desc-position="bottom"><img alt="image.png" src="image%20146.png"></a></p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="image%20147.png" data-desc-position="bottom"><img alt="image.png" src="image%20147.png"></a></p>
<h1 id="references">References</h1>
<ul>
<li>https://youtu.be/gNeF_mT6Eng?si=No3aBK1EDt_LuK80</li>
<li>https://youtu.be/Wze0yXsMKVM?si=N6Y4iW3m5ewxD1Hv</li>
<li>https://youtu.be/Iol1CHyv23A?si=ZWXFI-QOZVA8BUaa</li>
<li>https://youtu.be/zFosqdAadJg?si=mn5HtZHhud3jkcPR</li>
<li>https://docs.splunk.com/Documentation/Splunk/9.3.0/Installation/Whatsinthismanual</li>
<li>https://community.splunk.com/t5/Getting-Data-In/Sysmon-events-not-getting-indexed/m-p/688793?lightbox-message-images-688793=31015i33DABC9A02E482CD#M114683</li>
<li>https://youtu.be/1Ur3xDNaE4s?si=Dfh4-4PDkOccbnTR</li>
<li>https://splunk.github.io/splunk-connect-for-syslog/main/</li>
<li>https://gitlab.com/J-C-B/community-splunk-scripts/-/tree/master/</li>
<li>https://youtu.be/zWkGVnsNY8M?si=9iNqCFLlktpQq6qQ</li>
<li>https://youtu.be/Xepw_Xk9HX8?si=-D53cGVAs7Ckcrp6</li>
<li>https://youtu.be/8jvEmAmQNug?si=tc2tzJh4uOG9I62V</li>
<li>https://youtu.be/uQUAvY5M3RU?si=JKk_M_60LLsvk0w6</li>
<li>https://youtu.be/2kU1ZTAZphY?si=H3zP0QD9m8MmL2bG</li>
</ul>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer">
        
          
          <a href="../understanding-SIEM/understanding-SIEM.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Understanding SIEM">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Understanding SIEM
              </div>
            </div>
          </a>
        
        
          
          <a href="../wazuh/wazuh.html" class="md-footer__link md-footer__link--next" aria-label="Next: Wazuh">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Wazuh
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"></path></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
       20242026 <a href="https://github.com/cyberdefencekit" target="_blank" rel="noopener">Cyber Defence Kit by Joseph Jee</a>

    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/cyberdefencekit" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M202.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M496 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"></path></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["content.code.annotate", "content.code.copy", "content.tabs.link", "header.autohide", "announce.dismiss", "navigation.footer", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "navigation.expand", "search.highlight", "search.share", "search.suggest", "toc.integrate"], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  
<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(()=>{ lightbox.reload(); });
</script></body></html>