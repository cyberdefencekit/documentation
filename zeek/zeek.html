
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../wireshark/wireshark.html">
      
      
        <link rel="next" href="../zui/zui.html">
      
      
      <link rel="icon" href="../images/Cyber Defence Kit logo.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.11">
    
    
      
        <title>Zeek - Cyber Defence Kit</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
        <script src="https://unpkg.com/iframe-worker/shim"></script>
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="Zeek - Cyber Defence Kit" >
      
        <meta  property="og:description"  content="None" >
      
        <meta  property="og:image"  content="./assets/images/social/zeek/zeek.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="None" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="Zeek - Cyber Defence Kit" >
      
        <meta  name="twitter:description"  content="None" >
      
        <meta  name="twitter:image"  content="./assets/images/social/zeek/zeek.png" >
      
    
    
   <link href="../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="light-blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#zeek" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="Cyber Defence Kit" class="md-header__button md-logo" aria-label="Cyber Defence Kit" data-md-component="logo">
      
  <img src="../images/Cyber Defence Kit logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Cyber Defence Kit
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Zeek
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="light-blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="light-blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../index.html" class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../CDK-explained/CDK-explained.html" class="md-tabs__link">
          
  
  
    
  
  About CDK

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../understanding-SIEM/understanding-SIEM.html" class="md-tabs__link">
          
  
  
    
  
  SIEM

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../understanding-IDS-IPS/understanding-IDS-IPS.html" class="md-tabs__link">
          
  
  
    
  
  IDS/IPS

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../understanding-SIRP/understanding-SIRP.html" class="md-tabs__link">
          
  
  
    
  
  SIRP

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../understanding-SOAR/understanding-SOAR.html" class="md-tabs__link">
          
  
  
    
  
  SOAR

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../understanding-NTA/understanding-NTA.html" class="md-tabs__link">
          
  
  
    
  
  NTA

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../understanding-DFIR/understanding-DFIR.html" class="md-tabs__link">
          
  
  
    
  
  DFIR

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../understanding-EDR/understanding-EDR.html" class="md-tabs__link">
          
  
  
    
  
  EDR

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../caldera/caldera.html" class="md-tabs__link">
          
  
  
    
  
  MITRE

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../splunk-cheat-sheet/splunk-cheat-sheet.html" class="md-tabs__link">
          
  
  
    
  
  Cheat Sheets

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="Cyber Defence Kit" class="md-nav__button md-logo" aria-label="Cyber Defence Kit" data-md-component="logo">
      
  <img src="../images/Cyber Defence Kit logo.png" alt="logo">

    </a>
    Cyber Defence Kit
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    About CDK
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            About CDK
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../CDK-explained/CDK-explained.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cyber Defence Kit Explained
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    SIEM
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            SIEM
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../understanding-SIEM/understanding-SIEM.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Understanding SIEM
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../splunk/splunk.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Splunk
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wazuh/wazuh.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Wazuh
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    IDS/IPS
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            IDS/IPS
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../understanding-IDS-IPS/understanding-IDS-IPS.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Understanding IDS/IPS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../snort/snort.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Snort
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../suricata/suricata.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Suricata
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    SIRP
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            SIRP
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../understanding-SIRP/understanding-SIRP.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Understanding SIRP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../thehive/thehive.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TheHive
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../iris/iris.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    IRIS
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    SOAR
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            SOAR
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../understanding-SOAR/understanding-SOAR.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Understanding SOAR
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../shuffle/shuffle.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Shuffle
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    NTA
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            NTA
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../understanding-NTA/understanding-NTA.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Understanding NTA
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wireshark/wireshark.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Wireshark
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Zeek
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="zeek.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Zeek
    
  </span>
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#lab-setup-for-proof-of-concept" class="md-nav__link">
    <span class="md-ellipsis">
      Lab Setup for Proof of Concept
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#install-zeek-offline" class="md-nav__link">
    <span class="md-ellipsis">
      Install Zeek offline
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduction-to-zeek" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction to Zeek
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Introduction to Zeek">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#managing-zeek-with-zeekcontrol" class="md-nav__link">
    <span class="md-ellipsis">
      Managing Zeek with ZeekControl
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#browsing-log-files" class="md-nav__link">
    <span class="md-ellipsis">
      Browsing Log Files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zeek-as-a-command-line-utility" class="md-nav__link">
    <span class="md-ellipsis">
      Zeek as a Command-Line Utility
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monitoring-live-traffic" class="md-nav__link">
    <span class="md-ellipsis">
      Monitoring Live Traffic
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reading-packet-capture-pcap-files" class="md-nav__link">
    <span class="md-ellipsis">
      Reading Packet Capture (pcap) Files
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#zeek-log-formats-and-inspection" class="md-nav__link">
    <span class="md-ellipsis">
      Zeek Log Formats and Inspection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Zeek Log Formats and Inspection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#working-with-a-sample-trace" class="md-nav__link">
    <span class="md-ellipsis">
      Working with a Sample Trace
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zeek-tsv-format-logs" class="md-nav__link">
    <span class="md-ellipsis">
      Zeek TSV Format Logs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zeek-tsv-format-and-zeek-cut" class="md-nav__link">
    <span class="md-ellipsis">
      Zeek TSV Format and zeek-cut
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zeek-json-format-logs" class="md-nav__link">
    <span class="md-ellipsis">
      Zeek JSON Format Logs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zeek-json-format-and-jq" class="md-nav__link">
    <span class="md-ellipsis">
      Zeek JSON Format and jq
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#zeek-to-suricata-integration-via-pcap-files" class="md-nav__link">
    <span class="md-ellipsis">
      Zeek to Suricata Integration via PCAP Files
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#zeeks-intelligence-framework" class="md-nav__link">
    <span class="md-ellipsis">
      Zeek’s Intelligence Framework
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Zeek’s Intelligence Framework">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quick-start" class="md-nav__link">
    <span class="md-ellipsis">
      Quick Start
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../zui/zui.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Zui
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    DFIR
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            DFIR
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../understanding-DFIR/understanding-DFIR.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Understanding DFIR
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../velociraptor/velociraptor.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Velociraptor
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    EDR
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            EDR
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../understanding-EDR/understanding-EDR.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Understanding EDR
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../auroralite/auroralite.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Aurora Lite
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    MITRE
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            MITRE
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../caldera/caldera.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Caldera
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../navigator/navigator.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MITRE ATT&CK Navigator
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Cheat Sheets
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            Cheat Sheets
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../splunk-cheat-sheet/splunk-cheat-sheet.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Splunk
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../velociraptor-cheat-sheet/velociraptor-cheat-sheet.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Velociraptor
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="zeek"><strong>Zeek</strong></h1>
<p>Zeek is an open-source network analysis framework and security monitoring tool. Zeek provides deep visibility into network traffic and enables organisations to detect and respond to security threats in real-time. Unlike traditional intrusion detection systems (IDS) that rely primarily on signature matching, Zeek offers a more flexible and comprehensive approach by analysing network behaviors and events.</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/B1p_SGjQCzw?si=yhcOb56BBHp_sZxX" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

<h2 id="lab-setup-for-proof-of-concept"><strong>Lab Setup for Proof of Concept</strong></h2>
<p>In this proof of concept, the Ubuntu host simulated a compromised machine by visiting non-malicious websites, such as testmyids.org and Reddit, with Reddit being treated as malicious to trigger alerts in a safe and controlled environment. To demonstrate Zeek to Suricata integration via PCAP files, Zeek was installed on the same host as Suricata.</p>
<table>
<thead>
<tr>
<th><strong>Host</strong></th>
<th><strong>OS</strong></th>
<th><strong>Role</strong></th>
<th><strong>IP Address</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Fortigate</td>
<td>Fortios 7.6.0</td>
<td>Firewall/Router</td>
<td>192.168.1.111 (WAN) / 10.0.0.1 (LAN)</td>
</tr>
<tr>
<td>Suricata</td>
<td>Ubuntu 22.04 LTS</td>
<td>Suricata and Zeek</td>
<td>10.0.0.27</td>
</tr>
</tbody>
</table>
<p><a class="glightbox" href="Zeek.drawio.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Zeek.drawio.png" src="Zeek.drawio.png" /></a></p>
<h2 id="install-zeek-offline"><strong>Install Zeek offline</strong></h2>
<p>On an Ubuntu machine with internet connection:</p>
<p>Make a folder called zeek-offline and change permission of the directory. </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>mkdir<span class="w"> </span>zeek-offline
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="nb">cd</span><span class="w"> </span>zeek-offline
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>sudo<span class="w"> </span>chmod<span class="w"> </span><span class="m">755</span><span class="w"> </span>~/zeek-offline/
</code></pre></div>
<p>Add the Zeek repository and download the Zeek package and its dependencies:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="n">echo</span> <span class="s1">&#39;deb http://download.opensuse.org/repositories/security:/zeek/xUbuntu_22.04/ /&#39;</span> <span class="o">|</span> <span class="n">sudo</span> <span class="n">tee</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">apt</span><span class="o">/</span><span class="n">sources</span><span class="o">.</span><span class="n">list</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">security</span><span class="p">:</span><span class="n">zeek</span><span class="o">.</span><span class="n">list</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="n">curl</span> <span class="o">-</span><span class="n">fsSL</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">download</span><span class="o">.</span><span class="n">opensuse</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">repositories</span><span class="o">/</span><span class="n">security</span><span class="p">:</span><span class="n">zeek</span><span class="o">/</span><span class="n">xUbuntu_22</span><span class="mf">.04</span><span class="o">/</span><span class="n">Release</span><span class="o">.</span><span class="n">key</span> <span class="o">|</span> <span class="n">gpg</span> <span class="o">--</span><span class="n">dearmor</span> <span class="o">|</span> <span class="n">sudo</span> <span class="n">tee</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">apt</span><span class="o">/</span><span class="n">trusted</span><span class="o">.</span><span class="n">gpg</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">security_zeek</span><span class="o">.</span><span class="n">gpg</span> <span class="o">&gt;</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">null</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="n">sudo</span> <span class="n">apt</span> <span class="n">update</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="o">--</span><span class="n">download</span><span class="o">-</span><span class="n">only</span> <span class="n">zeek</span> 
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">download</span> <span class="n">zeek</span><span class="o">-</span><span class="n">core</span> <span class="n">zeekctl</span> <span class="n">zeek</span><span class="o">-</span><span class="n">core</span><span class="o">-</span><span class="n">dev</span> <span class="n">zeek</span><span class="o">-</span><span class="n">spicy</span><span class="o">-</span><span class="n">dev</span> <span class="n">zeek</span><span class="o">-</span><span class="n">zkg</span> <span class="n">zeek</span><span class="o">-</span><span class="n">client</span> \
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="n">libbroker</span><span class="o">-</span><span class="n">dev</span> <span class="n">libpcap</span><span class="o">-</span><span class="n">dev</span> <span class="n">libssl</span><span class="o">-</span><span class="n">dev</span> <span class="n">zlib1g</span><span class="o">-</span><span class="n">dev</span> <span class="n">libmaxminddb</span><span class="o">-</span><span class="n">dev</span> <span class="n">python3</span><span class="o">-</span><span class="n">semantic</span><span class="o">-</span><span class="n">version</span> <span class="n">python3</span><span class="o">-</span><span class="n">git</span> <span class="n">zeek</span><span class="o">-</span><span class="n">btest</span> <span class="n">zeek</span><span class="o">-</span><span class="n">btest</span><span class="o">-</span><span class="n">data</span> \
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="n">libpcap0</span><span class="mf">.8</span><span class="o">-</span><span class="n">dev</span> <span class="n">libssl3</span><span class="o">=</span><span class="mf">3.0.2</span><span class="o">-</span><span class="mi">0</span><span class="n">ubuntu1</span><span class="mf">.18</span> <span class="n">git</span> <span class="n">python3</span><span class="o">-</span><span class="n">gitdb</span> <span class="n">libc6</span><span class="o">-</span><span class="n">dev</span> \
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="n">liberror</span><span class="o">-</span><span class="n">perl</span> <span class="n">git</span><span class="o">-</span><span class="n">man</span> <span class="n">libdbus</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">dev</span> <span class="n">python3</span><span class="o">-</span><span class="n">smmap</span> <span class="n">rpcsvc</span><span class="o">-</span><span class="n">proto</span> <span class="n">libtirpc</span><span class="o">-</span><span class="n">dev</span> \
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="n">libc</span><span class="o">-</span><span class="n">dev</span><span class="o">-</span><span class="nb">bin</span> <span class="n">linux</span><span class="o">-</span><span class="n">libc</span><span class="o">-</span><span class="n">dev</span> <span class="n">libcrypt</span><span class="o">-</span><span class="n">dev</span> <span class="n">libnsl</span><span class="o">-</span><span class="n">dev</span> <span class="n">pkg</span><span class="o">-</span><span class="n">config</span> <span class="n">libdpkg</span><span class="o">-</span><span class="n">perl</span> \
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="n">zeek</span><span class="o">-</span><span class="n">aux</span>
</code></pre></div>
<p><strong>Note</strong>: if you get a permission denied error, run the command again. </p>
<p>Make a directory called curl and change permission of the directory. </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>mkdir<span class="w"> </span>curl
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="nb">cd</span><span class="w"> </span>curl
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>sudo<span class="w"> </span>chmod<span class="w"> </span><span class="m">755</span><span class="w"> </span>~/curl/
</code></pre></div>
<p>Download curl and its dependencies.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">download</span> <span class="n">curl</span> <span class="n">libc6</span> <span class="n">libcurl4</span> <span class="n">zlib1g</span>
</code></pre></div>
<p>Transferzeek-offline and curl to an Ubuntu host without internet access.</p>
<p>Install curl:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="n">cd</span> <span class="n">curl</span><span class="o">-</span><span class="n">packages</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="n">sudo</span> <span class="n">dpkg</span> <span class="o">-</span><span class="n">i</span> <span class="o">*</span>
</code></pre></div>
<p>Install Zeek:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="n">cd</span> <span class="n">zeek</span><span class="o">-</span><span class="n">offline</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="n">sudo</span> <span class="n">dpkg</span> <span class="o">-</span><span class="n">i</span> <span class="o">*</span>
</code></pre></div>
<h2 id="introduction-to-zeek"><strong>Introduction to Zeek</strong></h2>
<h3 id="managing-zeek-with-zeekcontrol"><strong>Managing Zeek with ZeekControl</strong></h3>
<p>ZeekControl is an interactive shell for easily operating/managing Zeek installations on a single system or even across multiple systems in a traffic-monitoring cluster.</p>
<p>In <code>/opt/zeek/etc/node.cfg</code>, set the right interface to monitor.</p>
<p>For example:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="n">nano</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">zeek</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">node</span><span class="o">.</span><span class="n">cfg</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="p">[</span><span class="n">zeek</span><span class="p">]</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="nb">type</span><span class="o">=</span><span class="n">standalone</span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="n">host</span><span class="o">=</span><span class="n">localhost</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="n">interface</span><span class="o">=</span><span class="n">ens32</span>   <span class="c1"># change this according to your listening interface in ifconfig</span>
</code></pre></div>
<p>[Optional but recommended]: In <code>/opt/zeek/etc/networks.cfg</code>, add networks that Zeek will consider local to the monitored environment. More on this <a href="https://docs.zeek.org/en/v7.0.1/quickstart.html#local-site-customization">below</a>.</p>
<p>[Optional]: In <code>/opt/zeek/etc/zeekctl.cfg</code>, change the <code>MailTo</code> email address to a desired recipient and the <code>LogRotationInterval</code> to a desired log archival frequency.</p>
<p>Now start the ZeekControl shell like:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="n">cd</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">zeek</span><span class="o">/</span><span class="nb">bin</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="n">sudo</span> <span class="o">./</span><span class="n">zeekctl</span>
</code></pre></div>
<p>Since this is the first-time use of the shell, perform an initial installation of the ZeekControl configuration:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="p">[</span><span class="n">ZeekControl</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">install</span>
</code></pre></div>
<p>Then start up a Zeek instance:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="p">[</span><span class="n">ZeekControl</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">start</span>
</code></pre></div>
<p>There is another ZeekControl command, <code>deploy</code>, that combines the above two steps and can be run after any changes to Zeek policy scripts or the ZeekControl configuration. Note that the <code>check</code> command is available to validate a modified configuration before installing it.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="p">[</span><span class="n">ZeekControl</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">deploy</span>
</code></pre></div>
<p>If there are errors while trying to start the Zeek instance, you can view the details with the <code>diag</code> command. If started successfully, the Zeek instance will begin analyzing traffic according to a default policy and output the results in <code>/opt/zeek/logs/current</code> directory.</p>
<p>You can leave it running for now, but to stop this Zeek instance you would do:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="p">[</span><span class="n">ZeekControl</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">stop</span>
</code></pre></div>
<p>Once Zeek is stopped, the log files in the <code>/opt/zeek/logs/current</code> directory are compressed and moved into the current day named folder inside the <code>/opt/zeek/logs</code> directory.</p>
<h3 id="browsing-log-files"><strong>Browsing Log Files</strong></h3>
<p>By default, logs are written out in human-readable (ASCII) format and data is organized into columns (tab-delimited). Logs that are part of the current rotation interval are accumulated in <code>/opt/zeek/logs/current/</code> (if Zeek is not running, the directory will be empty). For example, the <code>http.log</code> contains the results of Zeek HTTP protocol analysis. Here are the first few columns of <code>http.log</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="c1"># ts              uid              orig_h     orig_p   resp_h         resp_p</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="m">1726175258</span>.283795<span class="w">   </span>ClWVdk6JZxaBGiba1<span class="w">   </span><span class="m">10</span>.0.0.25<span class="w">    </span><span class="m">36768</span><span class="w">    </span><span class="m">91</span>.189.91.48<span class="w">   </span><span class="m">80</span>
</code></pre></div>
<p>Logs that deal with analysis of a network protocol will often start like this: a timestamp, a unique connection identifier (UID), and a connection 4-tuple (originator host/port and responder host/port). The UID can be used to identify and correlate all logged activity (possibly across multiple log files) associated with a given connection 4-tuple over its lifetime.</p>
<p>The remaining columns of protocol-specific logs then detail the protocol-dependent activity that’s occurring. E.g. <code>http.log</code>’s next few columns (shortened for brevity) show a request to the root of Zeek website:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="c1"># method   host         uri  referrer  user_agent</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>GET<span class="w">        </span>zeek.org<span class="w">  </span>/<span class="w">    </span>-<span class="w">         </span>&lt;...&gt;Chrome/12.0.742.122&lt;...&gt;
</code></pre></div>
<p>Apart from the conventional network protocol specific log files, Zeek also generates other important log files based on the network traffic statistics, interesting activity captured in the traffic, and detection focused log files. Some logs that are worth explicit mention:</p>
<ul>
<li>
<p><code>conn.log</code></p>
<p>Contains an entry for every connection seen on the wire, with basic properties such as time and duration, originator and responder IP addresses, services and ports, payload size, and much more. This log provides a comprehensive record of the network’s activity.</p>
</li>
<li>
<p><code>notice.log</code></p>
<p>Identifies specific activity that Zeek recognises as potentially interesting, odd, or bad. In Zeek-speak, such activity is called a “notice”.</p>
</li>
<li>
<p><code>known_services.log</code></p>
<p>This log file contains the services detected on the local network and are known to be actively used by the clients on the network. It helps in enumerating what all services are observed on a local network and if they all are intentional and known to the network administrator.</p>
</li>
<li>
<p><code>weird.log</code></p>
<p>Contains unusual or exceptional activity that can indicate malformed connections, traffic that doesn’t conform to a particular protocol, malfunctioning or misconfigured hardware/services, or even an attacker attempting to avoid/confuse a sensor.</p>
</li>
</ul>
<p>By default, ZeekControl regularly takes all the logs from <code>/opt/zeek/logs/current</code> and archives/compresses them to a directory named by date, e.g. <code>/opt/zeek/logs/2021-01-01</code>. The frequency at which this is done can be configured via the <code>LogRotationInterval</code> option in <code>/opt/zeek/etc/zeekctl.cfg</code>. The default is every hour.</p>
<h3 id="zeek-as-a-command-line-utility"><strong>Zeek as a Command-Line Utility</strong></h3>
<p>If you prefer not to use ZeekControl (e.g., you don’t need its automation and management features), here’s how to directly control Zeek for your analysis activities from the command line for both live traffic and offline working from traces.</p>
<h3 id="monitoring-live-traffic"><strong>Monitoring Live Traffic</strong></h3>
<p>Analysing live traffic from an interface is simple:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>zeek<span class="w"> </span>-i<span class="w"> </span>ens32<span class="w"> </span>&lt;list<span class="w"> </span>of<span class="w"> </span>scripts<span class="w"> </span>to<span class="w"> </span>load&gt;
</code></pre></div>
<p><code>ens32</code> should be replaced by the interface on which you want to monitor the traffic. The standard base scripts will be loaded and enabled by default. A list of additional scripts can be provided in the command as indicated above by <code>&lt;list of scripts to load&gt;</code>. Any such scripts supplied as space-separated files or paths will be loaded by Zeek in addition to the standard base scripts.</p>
<p>Zeek will output log files into the current working directory.</p>
<h3 id="reading-packet-capture-pcap-files"><strong>Reading Packet Capture (pcap) Files</strong></h3>
<p>When you want to do offline analysis of already captured pcap files, Zeek is a very handy tool to analyse the pcap and gives a high level holistic view of the traffic captured in the pcap.</p>
<p>If you want to capture packets from an interface and write them to a file to later analyse it with Zeek, then it can be done like this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>sudo<span class="w"> </span>tcpdump<span class="w"> </span>-i<span class="w"> </span>ens32<span class="w"> </span>-s<span class="w"> </span><span class="m">0</span><span class="w"> </span>-w<span class="w"> </span>sample.pcap
</code></pre></div>
<p>Where <code>ens32</code> should be replaced by the correct interface for your system, for example as shown by the <strong>ifconfig</strong> command. (The <code>-s 0</code> argument tells it to capture whole packets; in cases where it is not supported, use <code>-s 65535</code> instead).</p>
<p>After capturing traffic for a while, kill the tcpdump (with <em>ctrl-c</em>), and tell Zeek to perform all the default analysis on the capture:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>/opt/zeek/bin/zeek<span class="w"> </span>-r<span class="w"> </span>sample.pcap
</code></pre></div>
<p>Zeek will output log files into the current working directory. </p>
<p>To specify the output directory for logs, you can set <code>Log::default_logdir</code> on the command line:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>mkdir<span class="w"> </span>output_directory
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>/opt/zeek/bin/zeek<span class="w"> </span>-r<span class="w"> </span>sample.pcap<span class="w"> </span>Log::default_logdir<span class="o">=</span>output_directory
</code></pre></div>
<p>If no logs are generated for a pcap, try to run the pcap with <code>-C</code> to tell Zeek to ignore invalid IP Checksums:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>/opt/zeek/bin/zeek<span class="w"> </span>–C<span class="w"> </span>–r<span class="w"> </span>sample.pcap
</code></pre></div>
<p>If you are interested in more detection, you can load the <code>local.zeek</code> script that is included as a suggested configuration:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>zeek<span class="w"> </span>-r<span class="w"> </span>sample.pcap<span class="w"> </span><span class="nb">local</span>
</code></pre></div>
<p>If you want to run a custom or an extra script (assuming it’s in the default search path, more on this in the next section) to detect any particular behavior in the pcap, run Zeek with following command:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>zeek<span class="w"> </span>–r<span class="w"> </span>sample.pcap<span class="w"> </span>my-script.zeek
</code></pre></div>
<h2 id="zeek-log-formats-and-inspection"><strong>Zeek Log Formats and Inspection</strong></h2>
<p>Zeek creates a variety of logs when run in its default configuration. This data can be intimidating for a first-time user. In this section, we will process a sample packet trace with Zeek, and take a brief look at the sorts of logs Zeek creates. We will look at logs created in the traditional format, as well as logs in JSON format. We will also introduce a few command-line tools to examine Zeek logs.</p>
<h3 id="working-with-a-sample-trace"><strong>Working with a Sample Trace</strong></h3>
<p>For the examples that follow, we will use Zeek on a Linux system to process network traffic captured and stored to disk. We saved this trace file earlier in packet capture (PCAP) format as <code>sample.pcap</code>. The command line protocol analyser Tcpdump, which ships with most Unix-like distributions, summarises the contents of this file.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>tcpdump<span class="w"> </span>-n<span class="w"> </span>-r<span class="w"> </span>sample.pcap
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>reading<span class="w"> </span>from<span class="w"> </span>file<span class="w"> </span>sample.pcap,<span class="w"> </span>link-type<span class="w"> </span>EN10MB<span class="w"> </span><span class="o">(</span>Ethernet<span class="o">)</span>,<span class="w"> </span>snapshot<span class="w"> </span>length<span class="w"> </span><span class="m">262144</span>
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="m">16</span>:29:30.278903<span class="w"> </span>IP6<span class="w"> </span>fe80::11bb:1eb2:4e66:8cb2.5353<span class="w"> </span>&gt;<span class="w"> </span>ff02::fb.5353:<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">[</span>2q<span class="o">]</span><span class="w"> </span>PTR<span class="w"> </span><span class="o">(</span>QM<span class="o">)</span>?<span class="w"> </span>_ipp._tcp.local.<span class="w"> </span>PTR<span class="w"> </span><span class="o">(</span>QM<span class="o">)</span>?<span class="w"> </span>_ipps._tcp.local.<span class="w"> </span><span class="o">(</span><span class="m">45</span><span class="o">)</span>
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="m">16</span>:29:30.279490<span class="w"> </span>IP<span class="w"> </span><span class="m">10</span>.0.0.20.5353<span class="w"> </span>&gt;<span class="w"> </span><span class="m">224</span>.0.0.251.5353:<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">[</span>2q<span class="o">]</span><span class="w"> </span>PTR<span class="w"> </span><span class="o">(</span>QM<span class="o">)</span>?<span class="w"> </span>_ipp._tcp.local.<span class="w"> </span>PTR<span class="w"> </span><span class="o">(</span>QM<span class="o">)</span>?<span class="w"> </span>_ipps._tcp.local.<span class="w"> </span><span class="o">(</span><span class="m">45</span><span class="o">)</span>
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="m">16</span>:29:30.739547<span class="w"> </span>IP<span class="w"> </span><span class="m">10</span>.0.0.25.38596<span class="w"> </span>&gt;<span class="w"> </span><span class="m">10</span>.0.0.20.1514:<span class="w"> </span>Flags<span class="w"> </span><span class="o">[</span>.<span class="o">]</span>,<span class="w"> </span>seq<span class="w"> </span><span class="m">3895547640</span>:3895549088,<span class="w"> </span>ack<span class="w"> </span><span class="m">1070210661</span>,<span class="w"> </span>win<span class="w"> </span><span class="m">502</span>,<span class="w"> </span>options<span class="w"> </span><span class="o">[</span>nop,nop,TS<span class="w"> </span>val<span class="w"> </span><span class="m">3662342600</span><span class="w"> </span>ecr<span class="w"> </span><span class="m">1031616358</span><span class="o">]</span>,<span class="w"> </span>length<span class="w"> </span><span class="m">1448</span>
<a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a><span class="m">16</span>:29:30.739583<span class="w"> </span>IP<span class="w"> </span><span class="m">10</span>.0.0.25.38596<span class="w"> </span>&gt;<span class="w"> </span><span class="m">10</span>.0.0.20.1514:<span class="w"> </span>Flags<span class="w"> </span><span class="o">[</span>P.<span class="o">]</span>,<span class="w"> </span>seq<span class="w"> </span><span class="m">1448</span>:2350,<span class="w"> </span>ack<span class="w"> </span><span class="m">1</span>,<span class="w"> </span>win<span class="w"> </span><span class="m">502</span>,<span class="w"> </span>options<span class="w"> </span><span class="o">[</span>nop,nop,TS<span class="w"> </span>val<span class="w"> </span><span class="m">3662342600</span><span class="w"> </span>ecr<span class="w"> </span><span class="m">1031616358</span><span class="o">]</span>,<span class="w"> </span>length<span class="w"> </span><span class="m">902</span>
<a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a><span class="m">16</span>:29:30.740370<span class="w"> </span>IP<span class="w"> </span><span class="m">10</span>.0.0.20.1514<span class="w"> </span>&gt;<span class="w"> </span><span class="m">10</span>.0.0.25.38596:<span class="w"> </span>Flags<span class="w"> </span><span class="o">[</span>.<span class="o">]</span>,<span class="w"> </span>ack<span class="w"> </span><span class="m">2350</span>,<span class="w"> </span>win<span class="w"> </span><span class="m">7056</span>,<span class="w"> </span>options<span class="w"> </span><span class="o">[</span>nop,nop,TS<span class="w"> </span>val<span class="w"> </span><span class="m">1031618362</span><span class="w"> </span>ecr<span class="w"> </span><span class="m">3662342600</span><span class="o">]</span>,<span class="w"> </span>length<span class="w"> </span><span class="m">0</span>
<a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a><span class="m">16</span>:29:32.741070<span class="w"> </span>IP<span class="w"> </span><span class="m">10</span>.0.0.25.38596<span class="w"> </span>&gt;<span class="w"> </span><span class="m">10</span>.0.0.20.1514:<span class="w"> </span>Flags<span class="w"> </span><span class="o">[</span>P.<span class="o">]</span>,<span class="w"> </span>seq<span class="w"> </span><span class="m">2350</span>:2652,<span class="w"> </span>ack<span class="w"> </span><span class="m">1</span>,<span class="w"> </span>win<span class="w"> </span><span class="m">502</span>,<span class="w"> </span>options<span class="w"> </span><span class="o">[</span>nop,nop,TS<span class="w"> </span>val<span class="w"> </span><span class="m">3662344602</span><span class="w"> </span>ecr<span class="w"> </span><span class="m">1031618362</span><span class="o">]</span>,<span class="w"> </span>length<span class="w"> </span><span class="m">302</span>
<a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a><span class="m">16</span>:29:32.742172<span class="w"> </span>IP<span class="w"> </span><span class="m">10</span>.0.0.20.1514<span class="w"> </span>&gt;<span class="w"> </span><span class="m">10</span>.0.0.25.38596:<span class="w"> </span>Flags<span class="w"> </span><span class="o">[</span>.<span class="o">]</span>,<span class="w"> </span>ack<span class="w"> </span><span class="m">2652</span>,<span class="w"> </span>win<span class="w"> </span><span class="m">7056</span>,<span class="w"> </span>options<span class="w"> </span><span class="o">[</span>nop,nop,TS<span class="w"> </span>val<span class="w"> </span><span class="m">1031620364</span><span class="w"> </span>ecr<span class="w"> </span><span class="m">3662344602</span><span class="o">]</span>,<span class="w"> </span>length<span class="w"> </span><span class="m">0</span>
<a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a><span class="m">16</span>:29:32.744648<span class="w"> </span>IP<span class="w"> </span><span class="m">10</span>.0.0.20.1514<span class="w"> </span>&gt;<span class="w"> </span><span class="m">10</span>.0.0.25.38596:<span class="w"> </span>Flags<span class="w"> </span><span class="o">[</span>P.<span class="o">]</span>,<span class="w"> </span>seq<span class="w"> </span><span class="m">1</span>:90,<span class="w"> </span>ack<span class="w"> </span><span class="m">2652</span>,<span class="w"> </span>win<span class="w"> </span><span class="m">7056</span>,<span class="w"> </span>options<span class="w"> </span><span class="o">[</span>nop,nop,TS<span class="w"> </span>val<span class="w"> </span><span class="m">1031620366</span><span class="w"> </span>ecr<span class="w"> </span><span class="m">3662344602</span><span class="o">]</span>,<span class="w"> </span>length<span class="w"> </span><span class="m">89</span>
<a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a>...
</code></pre></div>
<p>Rather than run Zeek against a live interface, we will ask Zeek to digest this trace. This process allows us to vary Zeek’s run-time operation, keeping the traffic constant.</p>
<p>First we make two directories to store the log files that Zeek will produce. Then we will move into the “default” directory.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>mkdir<span class="w"> </span>default
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>mkdir<span class="w"> </span>json
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="nb">cd</span><span class="w"> </span>default/
</code></pre></div>
<h3 id="zeek-tsv-format-logs"><strong>Zeek TSV Format Logs</strong></h3>
<p>From this location on disk, we tell Zeek to digest the <code>sample.pcap</code> file.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>zeek<span class="w"> </span>-C<span class="w"> </span>-r<span class="w"> </span>../sample.pcap
</code></pre></div>
<p>The <code>-r</code> flag tells Zeek where to find the trace of interest.</p>
<p>The <code>-C</code> flag tells Zeek to ignore any TCP checksum errors. This happens on many systems due to a feature called “checksum offloading,” but it does not affect our analysis.</p>
<p>Zeek completes its task without reporting anything to the command line. This is standard Unix-like behavior. Using the <strong>ls</strong> command we see what files Zeek created when processing the trace.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>root@Suricata:/home/cyber/test_pcap/default#<span class="w"> </span>ls<span class="w"> </span>-al
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>total<span class="w"> </span><span class="m">36</span>
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>drwxr-xr-x<span class="w"> </span><span class="m">2</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">4096</span><span class="w"> </span>Sep<span class="w"> </span><span class="m">13</span><span class="w"> </span><span class="m">16</span>:38<span class="w"> </span>.
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a>drwxr-xr-x<span class="w"> </span><span class="m">5</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">4096</span><span class="w"> </span>Sep<span class="w"> </span><span class="m">13</span><span class="w"> </span><span class="m">16</span>:37<span class="w"> </span>..
<a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a>-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">1673</span><span class="w"> </span>Sep<span class="w"> </span><span class="m">13</span><span class="w"> </span><span class="m">16</span>:38<span class="w"> </span>conn.log
<a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a>-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">1499</span><span class="w"> </span>Sep<span class="w"> </span><span class="m">13</span><span class="w"> </span><span class="m">16</span>:38<span class="w"> </span>dns.log
<a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a>-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">1037</span><span class="w"> </span>Sep<span class="w"> </span><span class="m">13</span><span class="w"> </span><span class="m">16</span>:38<span class="w"> </span>files.log
<a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a>-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">1281</span><span class="w"> </span>Sep<span class="w"> </span><span class="m">13</span><span class="w"> </span><span class="m">16</span>:38<span class="w"> </span>http.log
<a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a>-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w">  </span><span class="m">802</span><span class="w"> </span>Sep<span class="w"> </span><span class="m">13</span><span class="w"> </span><span class="m">16</span>:38<span class="w"> </span>ntp.log
<a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a>-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w">  </span><span class="m">278</span><span class="w"> </span>Sep<span class="w"> </span><span class="m">13</span><span class="w"> </span><span class="m">16</span>:38<span class="w"> </span>packet_filter.log
<a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a>-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">2919</span><span class="w"> </span>Sep<span class="w"> </span><span class="m">13</span><span class="w"> </span><span class="m">16</span>:38<span class="w"> </span>syslog.log
</code></pre></div>
<p>Zeek created five files. We will look at the contents of Zeek log data in detail in later sections. For now, we will take a quick look at each file, beginning with the <code>conn.log</code>.</p>
<p>We use the <strong>cat</strong> command to show the contents of each log.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>cat<span class="w"> </span>conn.log
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="c1">#separator \x09</span>
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="c1">#set_separator  ,</span>
<a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a><span class="c1">#empty_field    (empty)</span>
<a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a><span class="c1">#unset_field    -</span>
<a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a><span class="c1">#path   conn</span>
<a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a><span class="c1">#open   2024-09-13-16-38-11</span>
<a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a><span class="c1">#fields ts  uid id.orig_h   id.orig_p   id.resp_h   id.resp_p   proto   service duration    orig_bytes  resp_bytes  conn_state  local_orig  local_resp  missed_bytes    history orig_pkts   orig_ip_bytes   resp_pkts   resp_ip_bytes   tunnel_parents</span>
<a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a><span class="c1">#types  time    string  addr    port    addr    port    enum    string  interval    count   count   string  bool    bool    count   string  count   count   count   count   set[string]</span>
<a id="__codelineno-28-9" name="__codelineno-28-9" href="#__codelineno-28-9"></a><span class="m">1726201770</span>.278903<span class="w">   </span>CTJy3z1weA4svLHlMi<span class="w">  </span>fe80::11bb:1eb2:4e66:8cb2<span class="w">   </span><span class="m">5353</span><span class="w">    </span>ff02::fb<span class="w">    </span><span class="m">5353</span><span class="w">    </span>udp<span class="w"> </span>dns<span class="w"> </span>-<span class="w">   </span>-<span class="w">   </span>-<span class="w">   </span>S0<span class="w">  </span>T<span class="w">   </span>F<span class="w">   </span><span class="m">0</span><span class="w">   </span>D<span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">9300</span><span class="w">    </span>-
<a id="__codelineno-28-10" name="__codelineno-28-10" href="#__codelineno-28-10"></a><span class="m">1726201770</span>.279490<span class="w">   </span>C7y3kf3wLnGC8eMFoj<span class="w">  </span><span class="m">10</span>.0.0.20<span class="w">   </span><span class="m">5353</span><span class="w">    </span><span class="m">224</span>.0.0.251<span class="w"> </span><span class="m">5353</span><span class="w">    </span>udp<span class="w"> </span>dns<span class="w"> </span>-<span class="w">   </span>-<span class="w">   </span>-<span class="w">   </span>S0<span class="w">  </span>T<span class="w">   </span>F<span class="w">   </span><span class="m">0</span><span class="w">   </span>D<span class="w">   </span><span class="m">1</span><span class="w">   </span><span class="m">73</span><span class="w">  </span><span class="m">0</span><span class="w">   </span><span class="m">0</span><span class="w">   </span>-
<a id="__codelineno-28-11" name="__codelineno-28-11" href="#__codelineno-28-11"></a><span class="m">1726201774</span>.886295<span class="w">   </span>CXetZefExG72gUZBg<span class="w">   </span><span class="m">10</span>.0.0.25<span class="w">   </span><span class="m">37842</span><span class="w">   </span><span class="m">8</span>.8.8.8<span class="w"> </span><span class="m">53</span><span class="w">  </span>udp<span class="w"> </span>dns<span class="w"> </span><span class="m">0</span>.071811<span class="w">    </span><span class="m">43</span><span class="w">  </span><span class="m">107</span><span class="w"> </span>SF<span class="w">  </span>T<span class="w">   </span>F<span class="w">   </span><span class="m">0</span><span class="w">   </span>Dd<span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">71</span><span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">135</span>-
<a id="__codelineno-28-12" name="__codelineno-28-12" href="#__codelineno-28-12"></a><span class="m">1726201774</span>.886782<span class="w">   </span>Cw9GHy49hDbEZja5N4<span class="w">  </span><span class="m">10</span>.0.0.25<span class="w">   </span><span class="m">54819</span><span class="w">   </span><span class="m">8</span>.8.8.8<span class="w"> </span><span class="m">53</span><span class="w">  </span>udp<span class="w"> </span>dns<span class="w"> </span><span class="m">0</span>.105430<span class="w">    </span><span class="m">43</span><span class="w">  </span><span class="m">267</span><span class="w"> </span>SF<span class="w">  </span>T<span class="w">   </span>F<span class="w">   </span><span class="m">0</span><span class="w">   </span>Dd<span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">71</span><span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">295</span>-
<a id="__codelineno-28-13" name="__codelineno-28-13" href="#__codelineno-28-13"></a><span class="m">1726201776</span>.494923<span class="w">   </span>CoOFuY2lG5sn40Cx4h<span class="w">  </span><span class="m">10</span>.0.0.25<span class="w">   </span><span class="m">51716</span><span class="w">   </span><span class="m">65</span>.9.141.86<span class="w"> </span><span class="m">80</span><span class="w">  </span>tcp<span class="w"> </span>http<span class="w">    </span><span class="m">0</span>.095743<span class="w">    </span><span class="m">92</span><span class="w">  </span><span class="m">538</span><span class="w"> </span>SF<span class="w">  </span>T<span class="w">   </span>F<span class="w">   </span><span class="m">0</span><span class="w">   </span>ShADadFf<span class="w">    </span><span class="m">7</span><span class="w">   </span><span class="m">4645</span><span class="w">    </span><span class="m">806</span><span class="w"> </span>-
<a id="__codelineno-28-14" name="__codelineno-28-14" href="#__codelineno-28-14"></a><span class="m">1726201776</span>.229030<span class="w">   </span>CSHUEK1r1ZslFXj9Ea<span class="w">  </span><span class="m">10</span>.0.0.1<span class="w">    </span><span class="m">19274</span><span class="w">   </span><span class="m">10</span>.0.0.25<span class="w">   </span><span class="m">514</span><span class="w"> </span>udp<span class="w"> </span>syslog<span class="w">  </span><span class="m">1</span>.999178<span class="w">    </span><span class="m">2392</span><span class="w">    </span><span class="m">0</span><span class="w">   </span>S0<span class="w">  </span>T<span class="w">   </span>T<span class="w">   </span><span class="m">0</span><span class="w">   </span>D<span class="w">   </span><span class="m">3</span><span class="w">   </span><span class="m">2476</span><span class="w">    </span><span class="m">0</span><span class="w">   </span><span class="m">0</span>-
<a id="__codelineno-28-15" name="__codelineno-28-15" href="#__codelineno-28-15"></a><span class="m">1726201776</span>.995145<span class="w">   </span>CY5BY43UhmmrHShwJg<span class="w">  </span><span class="m">10</span>.0.0.20<span class="w">   </span><span class="m">34602</span><span class="w">   </span><span class="m">185</span>.125.190.58<span class="w">  </span><span class="m">123</span><span class="w"> </span>udp<span class="w"> </span>ntp<span class="w"> </span><span class="m">0</span>.282631<span class="w">    </span><span class="m">48</span><span class="w">  </span><span class="m">48</span><span class="w">  </span>SF<span class="w">  </span>T<span class="w">   </span>F<span class="w">   </span><span class="m">0</span><span class="w">   </span>Dd<span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">76</span><span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">76</span><span class="w">  </span>-
<a id="__codelineno-28-16" name="__codelineno-28-16" href="#__codelineno-28-16"></a><span class="m">1726201774</span>.994946<span class="w">   </span>Cf7ViS38Dir6S2Sp24<span class="w">  </span><span class="m">10</span>.0.0.25<span class="w">   </span><span class="m">37652</span><span class="w">   </span><span class="m">65</span>.9.141.86<span class="w"> </span><span class="m">80</span><span class="w">  </span>tcp<span class="w"> </span>http<span class="w">    </span><span class="m">0</span>.108029<span class="w">    </span><span class="m">92</span><span class="w">  </span><span class="m">538</span><span class="w"> </span>SF<span class="w">  </span>T<span class="w">   </span>F<span class="w">   </span><span class="m">0</span><span class="w">   </span>ShADadFf<span class="w">    </span><span class="m">6</span><span class="w">   </span><span class="m">4124</span><span class="w">    </span><span class="m">754</span><span class="w"> </span>-
<a id="__codelineno-28-17" name="__codelineno-28-17" href="#__codelineno-28-17"></a><span class="m">1726201775</span>.764476<span class="w">   </span>CFRepo2KqxbrWWYUr1<span class="w">  </span><span class="m">10</span>.0.0.25<span class="w">   </span><span class="m">54034</span><span class="w">   </span><span class="m">65</span>.9.141.117<span class="w">    </span><span class="m">80</span><span class="w">  </span>tcp<span class="w"> </span>http<span class="w">    </span><span class="m">0</span>.079561<span class="w">    </span><span class="m">92</span><span class="w">  </span><span class="m">538</span><span class="w"> </span>SF<span class="w">  </span>T<span class="w">   </span>F<span class="w">   </span><span class="m">0</span><span class="w">   </span>ShADadFf<span class="w">    </span><span class="m">7</span><span class="w">   </span><span class="m">4645</span><span class="w">    </span><span class="m">806</span><span class="w"> </span>-
<a id="__codelineno-28-18" name="__codelineno-28-18" href="#__codelineno-28-18"></a><span class="m">1726201770</span>.739547<span class="w">   </span>CXYKK42G1Ga2LvFmh3<span class="w">  </span><span class="m">10</span>.0.0.25<span class="w">   </span><span class="m">38596</span><span class="w">   </span><span class="m">10</span>.0.0.20<span class="w">   </span><span class="m">1514</span><span class="w">    </span>tcp<span class="w"> </span>-<span class="w">   </span><span class="m">8</span>.024697<span class="w">    </span><span class="m">13178</span><span class="w">   </span><span class="m">89</span><span class="w">  </span>OTH<span class="w"> </span>T<span class="w">   </span>T<span class="w">   </span><span class="m">0</span><span class="w">   </span>DadA<span class="w">    </span><span class="m">16</span><span class="w">  </span><span class="m">14010</span><span class="w">   </span><span class="m">11661</span><span class="w">   </span>-
<a id="__codelineno-28-19" name="__codelineno-28-19" href="#__codelineno-28-19"></a><span class="c1">#close  2024-09-13-16-38-11</span>
</code></pre></div>
<p>Next we look at Zeek’s <code>dns.log</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a>cat<span class="w"> </span>dns.log
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="c1">#separator \x09</span>
<a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a><span class="c1">#set_separator  ,</span>
<a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a><span class="c1">#empty_field    (empty)</span>
<a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a><span class="c1">#unset_field    -</span>
<a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a><span class="c1">#path   dns</span>
<a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a><span class="c1">#open   2024-09-13-16-38-11</span>
<a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a><span class="c1">#fields ts  uid id.orig_h   id.orig_p   id.resp_h   id.resp_p   proto   trans_id    rtt query   qclass  qclass_name qtype   qtype_name  rcode   rcode_name  AATC    RD  RA  Z   answers TTLs    rejected</span>
<a id="__codelineno-30-8" name="__codelineno-30-8" href="#__codelineno-30-8"></a><span class="c1">#types  time    string  addr    port    addr    port    enum    count   interval    string  count   string  count   string  count   string  bool    bool    bool    bool    count   vector[string]  vector[interval]    bool</span>
<a id="__codelineno-30-9" name="__codelineno-30-9" href="#__codelineno-30-9"></a><span class="m">1726201774</span>.886295<span class="w">   </span>CXetZefExG72gUZBg<span class="w">   </span><span class="m">10</span>.0.0.25<span class="w">   </span><span class="m">37842</span><span class="w">   </span><span class="m">8</span>.8.8.8<span class="w"> </span><span class="m">53</span><span class="w">  </span>udp<span class="w"> </span><span class="m">27806</span><span class="w">   </span><span class="m">0</span>.071811<span class="w">    </span>testmynids.org<span class="w">  </span><span class="m">1</span><span class="w">   </span>C_INTERNET<span class="w">  </span><span class="m">1</span><span class="w">   </span>A<span class="w">   </span><span class="m">0</span><span class="w">   </span>NOERROR<span class="w"> </span>F<span class="w">   </span>F<span class="w">   </span>TT<span class="w">  </span><span class="m">0</span><span class="w">   </span><span class="m">65</span>.9.141.86,65.9.141.96,65.9.141.53,65.9.141.117<span class="w">    </span><span class="m">60</span>.000000,60.000000,60.000000,60.000000<span class="w"> </span>F
<a id="__codelineno-30-10" name="__codelineno-30-10" href="#__codelineno-30-10"></a><span class="m">1726201774</span>.886782<span class="w">   </span>Cw9GHy49hDbEZja5N4<span class="w">  </span><span class="m">10</span>.0.0.25<span class="w">   </span><span class="m">54819</span><span class="w">   </span><span class="m">8</span>.8.8.8<span class="w"> </span><span class="m">53</span><span class="w">  </span>udp<span class="w"> </span><span class="m">60281</span><span class="w">   </span><span class="m">0</span>.105430<span class="w">    </span>testmynids.org<span class="w">  </span><span class="m">1</span><span class="w">   </span>C_INTERNET<span class="w">  </span><span class="m">28</span><span class="w">  </span>AAAA<span class="w">    </span><span class="m">0</span><span class="w">   </span>NOERROR<span class="w"> </span>F<span class="w">   </span>F<span class="w">   </span>TT<span class="w">  </span><span class="m">0</span><span class="w">   </span><span class="m">2600</span>:9000:204b:f000:18:30b3:e400:93a1,2600:9000:204b:4400:18:30b3:e400:93a1,2600:9000:204b:ea00:18:30b3:e400:93a1,2600:9000:204b:a00:18:30b3:e400:93a1,2600:9000:204b:2e00:18:30b3:e400:93a1,2600:9000:204b:6000:18:30b3:e400:93a1,2600:9000:204b:7a00:18:30b3:e400:93a1,2600:9000:204b:ee00:18:30b3:e400:93a1<span class="w">  </span><span class="m">60</span>.000000,60.000000,60.000000,60.000000,60.000000,60.000000,60.000000,60.000000<span class="w"> </span>F
<a id="__codelineno-30-11" name="__codelineno-30-11" href="#__codelineno-30-11"></a><span class="m">1726201770</span>.278903<span class="w">   </span>CTJy3z1weA4svLHlMi<span class="w">  </span>fe80::11bb:1eb2:4e66:8cb2<span class="w">   </span><span class="m">5353</span><span class="w">    </span>ff02::fb<span class="w">    </span><span class="m">5353</span><span class="w">    </span>udp<span class="w"> </span><span class="m">0</span><span class="w">   </span>-<span class="w">   </span>_ipps._tcp.local<span class="w">    </span><span class="m">1</span><span class="w">   </span>C_INTERNET<span class="w">  </span><span class="m">12</span><span class="w">  </span>PTR<span class="w"> </span>-<span class="w">   </span>-F<span class="w">  </span>F<span class="w">   </span>F<span class="w">   </span>F<span class="w">   </span><span class="m">0</span><span class="w">   </span>-<span class="w">   </span>-<span class="w">   </span>F
<a id="__codelineno-30-12" name="__codelineno-30-12" href="#__codelineno-30-12"></a><span class="m">1726201770</span>.279490<span class="w">   </span>C7y3kf3wLnGC8eMFoj<span class="w">  </span><span class="m">10</span>.0.0.20<span class="w">   </span><span class="m">5353</span><span class="w">    </span><span class="m">224</span>.0.0.251<span class="w"> </span><span class="m">5353</span><span class="w">    </span>udp<span class="w"> </span><span class="m">0</span><span class="w">   </span>-<span class="w">   </span>_ipps._tcp.local<span class="w">    </span><span class="m">1</span><span class="w">   </span>C_INTERNET<span class="w">  </span><span class="m">12</span><span class="w">  </span>PTR<span class="w"> </span>-<span class="w">   </span>-<span class="w">   </span>F<span class="w">   </span>FF<span class="w">  </span>F<span class="w">   </span><span class="m">0</span><span class="w">   </span>-<span class="w">   </span>-<span class="w">   </span>F
<a id="__codelineno-30-13" name="__codelineno-30-13" href="#__codelineno-30-13"></a><span class="c1">#close  2024-09-13-16-38-11</span>
</code></pre></div>
<p>Next we look at Zeek’s <code>files.log</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>cat<span class="w"> </span>files.log
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="c1">#separator \x09</span>
<a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a><span class="c1">#set_separator  ,</span>
<a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a><span class="c1">#empty_field    (empty)</span>
<a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a><span class="c1">#unset_field    -</span>
<a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a><span class="c1">#path   files</span>
<a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a><span class="c1">#open   2024-09-13-16-38-11</span>
<a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a><span class="c1">#fields ts  fuid    uid id.orig_h   id.orig_p   id.resp_h   id.resp_p   source  depth   analyzers   mime_type   filename    duration    local_orig  is_orig seen_bytes  total_bytes missing_bytes   overflow_bytes  timedout    parent_fuid md5 sha1    sha256  extracted   extracted_cutoff    extracted_size</span>
<a id="__codelineno-32-8" name="__codelineno-32-8" href="#__codelineno-32-8"></a><span class="c1">#types  time    string  string  addr    port    addr    port    string  count   set[string] string  string  interval    bool    bool    count   count   count   count   bool    string  string  string  string  string  bool    count</span>
<a id="__codelineno-32-9" name="__codelineno-32-9" href="#__codelineno-32-9"></a><span class="m">1726201775</span>.068874<span class="w">   </span>FQzmmA4txLAELVk6ug<span class="w">  </span>Cf7ViS38Dir6S2Sp24<span class="w">  </span><span class="m">10</span>.0.0.25<span class="w">   </span><span class="m">37652</span><span class="w">   </span><span class="m">65</span>.9.141.86<span class="w"> </span><span class="m">80</span><span class="w">  </span>HTTP<span class="w">    </span><span class="m">0</span><span class="w">   </span><span class="o">(</span>empty<span class="o">)</span><span class="w"> </span>text/plain<span class="w">  </span>-<span class="w">   </span><span class="m">0</span>.000000<span class="w">    </span>F<span class="w">   </span>F<span class="w">   </span><span class="m">3939</span><span class="w">    </span><span class="m">0</span><span class="w">   </span><span class="m">0</span><span class="w">   </span>F<span class="w">   </span>-<span class="w">   </span>-<span class="w">   </span>-<span class="w">   </span>-<span class="w">   </span>-<span class="w">   </span>-<span class="w">   </span>-
<a id="__codelineno-32-10" name="__codelineno-32-10" href="#__codelineno-32-10"></a><span class="m">1726201775</span>.817226<span class="w">   </span>FrH7ji2KqzLDHybjXe<span class="w">  </span>CFRepo2KqxbrWWYUr1<span class="w">  </span><span class="m">10</span>.0.0.25<span class="w">   </span><span class="m">54034</span><span class="w">   </span><span class="m">65</span>.9.141.117<span class="w">    </span><span class="m">80</span><span class="w">  </span>HTTP<span class="w">    </span><span class="m">0</span><span class="w">   </span><span class="o">(</span>empty<span class="o">)</span><span class="w"> </span>text/plain<span class="w">  </span>-<span class="w">   </span><span class="m">0</span>.000000<span class="w">    </span>F<span class="w">   </span>F<span class="w">   </span><span class="m">3939</span><span class="w">    </span><span class="m">0</span><span class="w">   </span><span class="m">0</span><span class="w">   </span>F<span class="w">   </span>-<span class="w">   </span>-<span class="w">   </span>-<span class="w">   </span>-<span class="w">   </span>-<span class="w">   </span>-<span class="w">   </span>-
<a id="__codelineno-32-11" name="__codelineno-32-11" href="#__codelineno-32-11"></a><span class="m">1726201776</span>.568082<span class="w">   </span>FEyCzJ3xbrSmbOSCN9<span class="w">  </span>CoOFuY2lG5sn40Cx4h<span class="w">  </span><span class="m">10</span>.0.0.25<span class="w">   </span><span class="m">51716</span><span class="w">   </span><span class="m">65</span>.9.141.86<span class="w"> </span><span class="m">80</span><span class="w">  </span>HTTP<span class="w">    </span><span class="m">0</span><span class="w">   </span><span class="o">(</span>empty<span class="o">)</span><span class="w"> </span>text/plain<span class="w">  </span>-<span class="w">   </span><span class="m">0</span>.000000<span class="w">    </span>F<span class="w">   </span>F<span class="w">   </span><span class="m">3939</span><span class="w">    </span><span class="m">0</span><span class="w">   </span><span class="m">0</span><span class="w">   </span>F<span class="w">   </span>-<span class="w">   </span>-<span class="w">   </span>-<span class="w">   </span>-<span class="w">   </span>-<span class="w">   </span>-<span class="w">   </span>-
<a id="__codelineno-32-12" name="__codelineno-32-12" href="#__codelineno-32-12"></a><span class="c1">#close  2024-09-13-16-38-11</span>
</code></pre></div>
<p>Next we look at Zeek’s <code>http.log</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a>cat<span class="w"> </span>http.log
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="c1">#separator \x09</span>
<a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a><span class="c1">#set_separator  ,</span>
<a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a><span class="c1">#empty_field    (empty)</span>
<a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a><span class="c1">#unset_field    -</span>
<a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a><span class="c1">#path   http</span>
<a id="__codelineno-34-6" name="__codelineno-34-6" href="#__codelineno-34-6"></a><span class="c1">#open   2024-09-13-16-38-11</span>
<a id="__codelineno-34-7" name="__codelineno-34-7" href="#__codelineno-34-7"></a><span class="c1">#fields ts  uid id.orig_h   id.orig_p   id.resp_h   id.resp_p   trans_depth method  host    uri referrer    version user_agent  origin  request_body_len    response_body_len   status_code status_msg  info_code   info_msg    tags    username    password    proxied orig_fuids  orig_filenames  orig_mime_types resp_fuids  resp_filenames  resp_mime_types</span>
<a id="__codelineno-34-8" name="__codelineno-34-8" href="#__codelineno-34-8"></a><span class="c1">#types  time    string  addr    port    addr    port    count   string  string  string  string  string  string  string  count   count   count   string  count   string  set[enum]   string  string  set[string] vector[string]  vector[string]  vector[string]  vector[string]  vector[string]  vector[string]</span>
<a id="__codelineno-34-9" name="__codelineno-34-9" href="#__codelineno-34-9"></a><span class="m">1726201775</span>.010870<span class="w">   </span>Cf7ViS38Dir6S2Sp24<span class="w">  </span><span class="m">10</span>.0.0.25<span class="w">   </span><span class="m">37652</span><span class="w">   </span><span class="m">65</span>.9.141.86<span class="w"> </span><span class="m">80</span><span class="w">  </span><span class="m">1</span><span class="w">   </span>GET<span class="w"> </span>testmynids.org<span class="w">  </span>/uid/index.html<span class="w"> </span>-<span class="w">   </span><span class="m">1</span>.1<span class="w"> </span>curl/7.81.0<span class="w"> </span>-<span class="w">   </span><span class="m">0</span><span class="w">   </span><span class="m">39</span><span class="w">  </span>200OK<span class="w">   </span>-<span class="w">   </span>-<span class="w">   </span><span class="o">(</span>empty<span class="o">)</span><span class="w"> </span>-<span class="w">   </span>-<span class="w">   </span>-<span class="w">   </span>-<span class="w">   </span>-<span class="w">   </span>-<span class="w">   </span>FQzmmA4txLAELVk6ug<span class="w">  </span>-<span class="w">   </span>text/plain
<a id="__codelineno-34-10" name="__codelineno-34-10" href="#__codelineno-34-10"></a><span class="m">1726201775</span>.794614<span class="w">   </span>CFRepo2KqxbrWWYUr1<span class="w">  </span><span class="m">10</span>.0.0.25<span class="w">   </span><span class="m">54034</span><span class="w">   </span><span class="m">65</span>.9.141.117<span class="w">    </span><span class="m">80</span><span class="w">  </span><span class="m">1</span><span class="w">   </span>GET<span class="w"> </span>testmynids.org<span class="w">  </span>/uid/index.html<span class="w"> </span>-<span class="w">   </span><span class="m">1</span>.1<span class="w"> </span>curl/7.81.0<span class="w"> </span>-<span class="w">   </span><span class="m">0</span><span class="w">   </span><span class="m">39</span><span class="w">  </span>200OK<span class="w">   </span>-<span class="w">   </span>-<span class="w">   </span><span class="o">(</span>empty<span class="o">)</span><span class="w"> </span>-<span class="w">   </span>-<span class="w">   </span>-<span class="w">   </span>-<span class="w">   </span>-<span class="w">   </span>-<span class="w">   </span>FrH7ji2KqzLDHybjXe<span class="w">  </span>-<span class="w">   </span>text/plain
<a id="__codelineno-34-11" name="__codelineno-34-11" href="#__codelineno-34-11"></a><span class="m">1726201776</span>.528222<span class="w">   </span>CoOFuY2lG5sn40Cx4h<span class="w">  </span><span class="m">10</span>.0.0.25<span class="w">   </span><span class="m">51716</span><span class="w">   </span><span class="m">65</span>.9.141.86<span class="w"> </span><span class="m">80</span><span class="w">  </span><span class="m">1</span><span class="w">   </span>GET<span class="w"> </span>testmynids.org<span class="w">  </span>/uid/index.html<span class="w"> </span>-<span class="w">   </span><span class="m">1</span>.1<span class="w"> </span>curl/7.81.0<span class="w"> </span>-<span class="w">   </span><span class="m">0</span><span class="w">   </span><span class="m">39</span><span class="w">  </span>200OK<span class="w">   </span>-<span class="w">   </span>-<span class="w">   </span><span class="o">(</span>empty<span class="o">)</span><span class="w"> </span>-<span class="w">   </span>-<span class="w">   </span>-<span class="w">   </span>-<span class="w">   </span>-<span class="w">   </span>-<span class="w">   </span>FEyCzJ3xbrSmbOSCN9<span class="w">  </span>-<span class="w">   </span>text/plain
<a id="__codelineno-34-12" name="__codelineno-34-12" href="#__codelineno-34-12"></a><span class="c1">#close  2024-09-13-16-38-11</span>
</code></pre></div>
<p>Finally, we look at Zeek’s <code>packet_filter.log</code>. This log shows any filters that Zeek applied when processing the trace.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a>cat<span class="w"> </span>packet_filter.log
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="c1">#separator \x09</span>
<a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a><span class="c1">#set_separator  ,</span>
<a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a><span class="c1">#empty_field    (empty)</span>
<a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a><span class="c1">#unset_field    -</span>
<a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a><span class="c1">#path   packet_filter</span>
<a id="__codelineno-36-6" name="__codelineno-36-6" href="#__codelineno-36-6"></a><span class="c1">#open   2024-09-13-16-38-11</span>
<a id="__codelineno-36-7" name="__codelineno-36-7" href="#__codelineno-36-7"></a><span class="c1">#fields ts  node    filter  init    success failure_reason</span>
<a id="__codelineno-36-8" name="__codelineno-36-8" href="#__codelineno-36-8"></a><span class="c1">#types  time    string  string  bool    bool    string</span>
<a id="__codelineno-36-9" name="__codelineno-36-9" href="#__codelineno-36-9"></a><span class="m">1726202291</span>.728926<span class="w">   </span>zeek<span class="w">    </span>ip<span class="w"> </span>or<span class="w"> </span>not<span class="w"> </span>ip<span class="w">    </span>T<span class="w">   </span>T<span class="w">   </span>-
<a id="__codelineno-36-10" name="__codelineno-36-10" href="#__codelineno-36-10"></a><span class="c1">#close  2024-09-13-16-38-11</span>
</code></pre></div>
<p>As we can see with each log file, there is a set of headers beginning with the hash character (<code>#</code>) followed by metadata about the trace. This format is the standard version of Zeek data, represented as tab separated values (TSV).</p>
<p>Interpreting this data as shown requires remembering which “column” applies to which “value.” For example, in the <code>dns.log</code>, the third field is <code>id.orig_h</code>, so when we see data in that field, such as <code>10.0.0.25</code>, we know that <code>10.0.0.25</code> is <code>id.orig_h</code>.</p>
<p>One of the common use cases for interacting with Zeek log files requires analysing specific fields. Investigators may not need to see all of the fields produced by Zeek when solving a certain problem. The following sections offer a few ways to address this concern when processing Zeek logs in text format.</p>
<h3 id="zeek-tsv-format-and-zeek-cut"><strong>Zeek TSV Format and zeek-cut</strong></h3>
<p>The Zeek project provides a tool called <strong>zeek-cut</strong> to make it easier for analysts to interact with Zeek logs in TSV format. It parses the header in each file and allows the user to refer to the specific columnar data available. This is in contrast to tools like <strong>awk</strong> that require the user to refer to fields referenced by their position.</p>
<p>If we pass zeek-cut the fields we wish to see, the output looks like this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a>cat<span class="w"> </span>dns.log<span class="w"> </span><span class="p">|</span><span class="w"> </span>zeek-cut<span class="w"> </span>id.orig_h<span class="w"> </span>query<span class="w"> </span>answers
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a><span class="m">10</span>.0.0.25<span class="w">   </span>testmynids.org<span class="w">  </span><span class="m">65</span>.9.141.86,65.9.141.96,65.9.141.53,65.9.141.117
<a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a>...
</code></pre></div>
<p>The sequence of field names given to zeek-cut determines the output order. This means you can also use zeek-cut to reorder fields.</p>
<p>Note that in its default setup using ZeekControl (but not with a simple command-line invocation like <code>zeek -i eth0</code>), watching a live interface and writing logs to disk, Zeek will rotate log files on an hourly basis. Zeek will move the current log file into a directory named using the format <code>YYYY-MM-DD</code>. Zeek will use <strong>gzip</strong> to compress the file with a naming convention that includes the log file type and time range of the file.</p>
<p>When processing a compressed log file, use the <strong>zcat</strong> tool instead of <strong>cat</strong> to read the file. Consider working with the gzip-encoding file created in the following example. For demonstration purposes, we create a copy of the <code>dns.log</code> file as <code>dns1.log</code>, <strong>gzip</strong> it, and then read it with <strong>zcat</strong> instead of <strong>cat</strong>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a>cp<span class="w"> </span>dns.log<span class="w"> </span>dns1.log
<a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a>gzip<span class="w"> </span>dns1.log
<a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a>zcat<span class="w"> </span>dns1.log.gz
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a><span class="c1">#separator \x09</span>
<a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a><span class="c1">#set_separator  ,</span>
<a id="__codelineno-40-3" name="__codelineno-40-3" href="#__codelineno-40-3"></a><span class="c1">#empty_field    (empty)</span>
<a id="__codelineno-40-4" name="__codelineno-40-4" href="#__codelineno-40-4"></a><span class="c1">#unset_field    -</span>
<a id="__codelineno-40-5" name="__codelineno-40-5" href="#__codelineno-40-5"></a><span class="c1">#path   dns</span>
<a id="__codelineno-40-6" name="__codelineno-40-6" href="#__codelineno-40-6"></a><span class="c1">#open   2024-09-13-16-38-11</span>
<a id="__codelineno-40-7" name="__codelineno-40-7" href="#__codelineno-40-7"></a><span class="c1">#fields ts  uid id.orig_h   id.orig_p   id.resp_h   id.resp_p   proto   trans_id    rtt query   qclass  qclass_name qtype   qtype_name  rcode   rcode_name  AATC    RD  RA  Z   answers TTLs    rejected</span>
<a id="__codelineno-40-8" name="__codelineno-40-8" href="#__codelineno-40-8"></a><span class="c1">#types  time    string  addr    port    addr    port    enum    count   interval    string  count   string  count   string  count   string  bool    bool    bool    bool    count   vector[string]  vector[interval]    bool</span>
<a id="__codelineno-40-9" name="__codelineno-40-9" href="#__codelineno-40-9"></a><span class="m">1726201774</span>.886295<span class="w">   </span>CXetZefExG72gUZBg<span class="w">   </span><span class="m">10</span>.0.0.25<span class="w">   </span><span class="m">37842</span><span class="w">   </span><span class="m">8</span>.8.8.8<span class="w"> </span><span class="m">53</span><span class="w">  </span>udp<span class="w"> </span><span class="m">27806</span><span class="w">   </span><span class="m">0</span>.071811<span class="w">    </span>testmynids.org<span class="w">  </span><span class="m">1</span><span class="w">   </span>C_INTERNET<span class="w">  </span><span class="m">1</span><span class="w">   </span>A<span class="w">   </span><span class="m">0</span><span class="w">   </span>NOERROR<span class="w"> </span>F<span class="w">   </span>F<span class="w">   </span>TT<span class="w">  </span><span class="m">0</span><span class="w">   </span><span class="m">65</span>.9.141.86,65.9.141.96,65.9.141.53,65.9.141.117<span class="w">    </span><span class="m">60</span>.000000,60.000000,60.000000,60.000000<span class="w"> </span>F
<a id="__codelineno-40-10" name="__codelineno-40-10" href="#__codelineno-40-10"></a><span class="m">1726201774</span>.886782<span class="w">   </span>Cw9GHy49hDbEZja5N4<span class="w">  </span><span class="m">10</span>.0.0.25<span class="w">   </span><span class="m">54819</span><span class="w">   </span><span class="m">8</span>.8.8.8<span class="w"> </span><span class="m">53</span><span class="w">  </span>udp<span class="w"> </span><span class="m">60281</span><span class="w">   </span><span class="m">0</span>.105430<span class="w">    </span>testmynids.org<span class="w">  </span><span class="m">1</span><span class="w">   </span>C_INTERNET<span class="w">  </span><span class="m">28</span><span class="w">  </span>AAAA<span class="w">    </span><span class="m">0</span><span class="w">   </span>NOERROR<span class="w"> </span>F<span class="w">   </span>F<span class="w">   </span>TT<span class="w">  </span><span class="m">0</span><span class="w">   </span><span class="m">2600</span>:9000:204b:f000:18:30b3:e400:93a1,2600:9000:204b:4400:18:30b3:e400:93a1,2600:9000:204b:ea00:18:30b3:e400:93a1,2600:9000:204b:a00:18:30b3:e400:93a1,2600:9000:204b:2e00:18:30b3:e400:93a1,2600:9000:204b:6000:18:30b3:e400:93a1,2600:9000:204b:7a00:18:30b3:e400:93a1,2600:9000:204b:ee00:18:30b3:e400:93a1<span class="w">  </span><span class="m">60</span>.000000,60.000000,60.000000,60.000000,60.000000,60.000000,60.000000,60.000000<span class="w"> </span>F
<a id="__codelineno-40-11" name="__codelineno-40-11" href="#__codelineno-40-11"></a><span class="m">1726201770</span>.278903<span class="w">   </span>CTJy3z1weA4svLHlMi<span class="w">  </span>fe80::11bb:1eb2:4e66:8cb2<span class="w">   </span><span class="m">5353</span><span class="w">    </span>ff02::fb<span class="w">    </span><span class="m">5353</span><span class="w">    </span>udp<span class="w"> </span><span class="m">0</span><span class="w">   </span>-<span class="w">   </span>_ipps._tcp.local<span class="w">    </span><span class="m">1</span><span class="w">   </span>C_INTERNET<span class="w">  </span><span class="m">12</span><span class="w">  </span>PTR<span class="w"> </span>-<span class="w">   </span>-F<span class="w">  </span>F<span class="w">   </span>F<span class="w">   </span>F<span class="w">   </span><span class="m">0</span><span class="w">   </span>-<span class="w">   </span>-<span class="w">   </span>F
<a id="__codelineno-40-12" name="__codelineno-40-12" href="#__codelineno-40-12"></a><span class="m">1726201770</span>.279490<span class="w">   </span>C7y3kf3wLnGC8eMFoj<span class="w">  </span><span class="m">10</span>.0.0.20<span class="w">   </span><span class="m">5353</span><span class="w">    </span><span class="m">224</span>.0.0.251<span class="w"> </span><span class="m">5353</span><span class="w">    </span>udp<span class="w"> </span><span class="m">0</span><span class="w">   </span>-<span class="w">   </span>_ipps._tcp.local<span class="w">    </span><span class="m">1</span><span class="w">   </span>C_INTERNET<span class="w">  </span><span class="m">12</span><span class="w">  </span>PTR<span class="w"> </span>-<span class="w">   </span>-<span class="w">   </span>F<span class="w">   </span>FF<span class="w">  </span>F<span class="w">   </span><span class="m">0</span><span class="w">   </span>-<span class="w">   </span>-<span class="w">   </span>F
<a id="__codelineno-40-13" name="__codelineno-40-13" href="#__codelineno-40-13"></a><span class="c1">#close  2024-09-13-16-38-11</span>
</code></pre></div>
<p><strong>zeek-cut</strong> accepts the flag <code>-d</code> to convert the epoch time values in the log files to human-readable format. For example, observe the default timestamp value:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a>zcat<span class="w"> </span>dns1.log.gz<span class="w"> </span><span class="p">|</span><span class="w"> </span>zeek-cut<span class="w"> </span>ts<span class="w"> </span>id.orig_h<span class="w"> </span>query<span class="w"> </span>answers
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a><span class="m">1726201774</span>.886295<span class="w">   </span><span class="m">10</span>.0.0.25<span class="w">   </span>testmynids.org<span class="w">  </span><span class="m">65</span>.9.141.86,65.9.141.96,65.9.141.53,65.9.141.117
<a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a>...
</code></pre></div>
<p>Now see the effect of using the <code>-d</code> flag:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a>cat<span class="w"> </span>dns.log<span class="w"> </span><span class="p">|</span><span class="w"> </span>zeek-cut<span class="w"> </span>-d<span class="w"> </span>ts<span class="w"> </span>id.orig_h<span class="w"> </span>query<span class="w"> </span>answers
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a><span class="m">2024</span>-09-13T16:29:34+1200<span class="w">    </span><span class="m">10</span>.0.0.25<span class="w">   </span>testmynids.org<span class="w">  </span><span class="m">65</span>.9.141.86,65.9.141.96,65.9.141.53,65.9.141.117
<a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a>...
</code></pre></div>
<p>Converting the timestamp from a log file to UTC can be accomplished with the <code>-u</code> option.</p>
<p>The default time format when using the <code>-d</code> or <code>-u</code> is the <code>strftime</code> format string <code>%Y-%m-%dT%H:%M:%S%z</code> which results in a string with year, month, day of month, followed by hour, minutes, seconds and the timezone offset.</p>
<p>The default format can be altered by using the <code>-D</code> and <code>-U</code> flags, using the standard <code>strftime</code> syntax. For example, to format the timestamp in the US-typical “Middle Endian” you could use a format string of: <code>%m-%d-%YT%H:%M:%S%z</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a><span class="m">13</span>-09-2024T16:29:34+1200<span class="w">    </span><span class="m">10</span>.0.0.25<span class="w">   </span>testmynids.org<span class="w">  </span><span class="m">65</span>.9.141.86,65.9.141.96,65.9.141.53,65.9.141.117
<a id="__codelineno-45-2" name="__codelineno-45-2" href="#__codelineno-45-2"></a>...
</code></pre></div>
<h3 id="zeek-json-format-logs"><strong>Zeek JSON Format Logs</strong></h3>
<p>During the last decade, the JavaScript Object Notation (JSON) format has become a standard way to label and store many types of data. Zeek offers support for this format. In the following example we will re-run the <code>sample.pcap</code> trace through Zeek, but request that it output logs in JSON format.</p>
<p>First we change into the json directory to avoid overwriting our existing log files.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a><span class="nb">cd</span><span class="w"> </span>../json/
</code></pre></div>
<p>Next we tell Zeek to output logs in JSON format using the command as shown.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a>/opt/zeek/bin/zeek<span class="w"> </span>-C<span class="w"> </span>-r<span class="w"> </span>../sample.pcap<span class="w"> </span>LogAscii::use_json<span class="o">=</span>T
</code></pre></div>
<p>When we look at the directory contents, we see the same five output files.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a>root@Suricata:/home/cyber/test_pcap/json#<span class="w"> </span>ls<span class="w"> </span>-al
<a id="__codelineno-48-2" name="__codelineno-48-2" href="#__codelineno-48-2"></a>total<span class="w"> </span><span class="m">36</span>
<a id="__codelineno-48-3" name="__codelineno-48-3" href="#__codelineno-48-3"></a>drwxr-xr-x<span class="w"> </span><span class="m">2</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">4096</span><span class="w"> </span>Sep<span class="w"> </span><span class="m">13</span><span class="w"> </span><span class="m">16</span>:56<span class="w"> </span>.
<a id="__codelineno-48-4" name="__codelineno-48-4" href="#__codelineno-48-4"></a>drwxr-xr-x<span class="w"> </span><span class="m">5</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">4096</span><span class="w"> </span>Sep<span class="w"> </span><span class="m">13</span><span class="w"> </span><span class="m">16</span>:37<span class="w"> </span>..
<a id="__codelineno-48-5" name="__codelineno-48-5" href="#__codelineno-48-5"></a>-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">3714</span><span class="w"> </span>Sep<span class="w"> </span><span class="m">13</span><span class="w"> </span><span class="m">16</span>:56<span class="w"> </span>conn.log
<a id="__codelineno-48-6" name="__codelineno-48-6" href="#__codelineno-48-6"></a>-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">1895</span><span class="w"> </span>Sep<span class="w"> </span><span class="m">13</span><span class="w"> </span><span class="m">16</span>:56<span class="w"> </span>dns.log
<a id="__codelineno-48-7" name="__codelineno-48-7" href="#__codelineno-48-7"></a>-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">1098</span><span class="w"> </span>Sep<span class="w"> </span><span class="m">13</span><span class="w"> </span><span class="m">16</span>:56<span class="w"> </span>files.log
<a id="__codelineno-48-8" name="__codelineno-48-8" href="#__codelineno-48-8"></a>-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">1247</span><span class="w"> </span>Sep<span class="w"> </span><span class="m">13</span><span class="w"> </span><span class="m">16</span>:56<span class="w"> </span>http.log
<a id="__codelineno-48-9" name="__codelineno-48-9" href="#__codelineno-48-9"></a>-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w">  </span><span class="m">780</span><span class="w"> </span>Sep<span class="w"> </span><span class="m">13</span><span class="w"> </span><span class="m">16</span>:56<span class="w"> </span>ntp.log
<a id="__codelineno-48-10" name="__codelineno-48-10" href="#__codelineno-48-10"></a>-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w">   </span><span class="m">90</span><span class="w"> </span>Sep<span class="w"> </span><span class="m">13</span><span class="w"> </span><span class="m">16</span>:56<span class="w"> </span>packet_filter.log
<a id="__codelineno-48-11" name="__codelineno-48-11" href="#__codelineno-48-11"></a>-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">3138</span><span class="w"> </span>Sep<span class="w"> </span><span class="m">13</span><span class="w"> </span><span class="m">16</span>:56<span class="w"> </span>syslog.log
</code></pre></div>
<p>However, if we look at the file contents, the format is much different.</p>
<p>First we look at <code>packet_filter.log</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a>cat<span class="w"> </span>packet_filter.log
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a><span class="o">{</span><span class="s2">&quot;ts&quot;</span>:1726203404.305186,<span class="s2">&quot;node&quot;</span>:<span class="s2">&quot;zeek&quot;</span>,<span class="s2">&quot;filter&quot;</span>:<span class="s2">&quot;ip or not ip&quot;</span>,<span class="s2">&quot;init&quot;</span>:true,<span class="s2">&quot;success&quot;</span>:true<span class="o">}</span>
</code></pre></div>
<p>Next we look at <code>dns.log</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a>cat<span class="w"> </span>dns.log
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a><span class="o">{</span><span class="s2">&quot;ts&quot;</span>:1726201774.886295,<span class="s2">&quot;uid&quot;</span>:<span class="s2">&quot;CboAKi44MALjum3o2k&quot;</span>,<span class="s2">&quot;id.orig_h&quot;</span>:<span class="s2">&quot;10.0.0.25&quot;</span>,<span class="s2">&quot;id.orig_p&quot;</span>:37842,<span class="s2">&quot;id.resp_h&quot;</span>:<span class="s2">&quot;8.8.8.8&quot;</span>,<span class="s2">&quot;id.resp_p&quot;</span>:53,<span class="s2">&quot;proto&quot;</span>:<span class="s2">&quot;udp&quot;</span>,<span class="s2">&quot;trans_id&quot;</span>:27806,<span class="s2">&quot;rtt&quot;</span>:0.07181096076965332,<span class="s2">&quot;query&quot;</span>:<span class="s2">&quot;testmynids.org&quot;</span>,<span class="s2">&quot;qclass&quot;</span>:1,<span class="s2">&quot;qclass_name&quot;</span>:<span class="s2">&quot;C_INTERNET&quot;</span>,<span class="s2">&quot;qtype&quot;</span>:1,<span class="s2">&quot;qtype_name&quot;</span>:<span class="s2">&quot;A&quot;</span>,<span class="s2">&quot;rcode&quot;</span>:0,<span class="s2">&quot;rcode_name&quot;</span>:<span class="s2">&quot;NOERROR&quot;</span>,<span class="s2">&quot;AA&quot;</span>:false,<span class="s2">&quot;TC&quot;</span>:false,<span class="s2">&quot;RD&quot;</span>:true,<span class="s2">&quot;RA&quot;</span>:true,<span class="s2">&quot;Z&quot;</span>:0,<span class="s2">&quot;answers&quot;</span>:<span class="o">[</span><span class="s2">&quot;65.9.141.86&quot;</span>,<span class="s2">&quot;65.9.141.96&quot;</span>,<span class="s2">&quot;65.9.141.53&quot;</span>,<span class="s2">&quot;65.9.141.117&quot;</span><span class="o">]</span>,<span class="s2">&quot;TTLs&quot;</span>:<span class="o">[</span><span class="m">60</span>.0,60.0,60.0,60.0<span class="o">]</span>,<span class="s2">&quot;rejected&quot;</span>:false<span class="o">}</span>
<a id="__codelineno-52-2" name="__codelineno-52-2" href="#__codelineno-52-2"></a>...
</code></pre></div>
<p>Next we look at <code>files.log</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a>cat<span class="w"> </span>files.log
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a><span class="o">{</span><span class="s2">&quot;ts&quot;</span>:1726201775.068874,<span class="s2">&quot;fuid&quot;</span>:<span class="s2">&quot;FQzmmA4txLAELVk6ug&quot;</span>,<span class="s2">&quot;uid&quot;</span>:<span class="s2">&quot;CQcULU2VXecTtcygwa&quot;</span>,<span class="s2">&quot;id.orig_h&quot;</span>:<span class="s2">&quot;10.0.0.25&quot;</span>,<span class="s2">&quot;id.orig_p&quot;</span>:37652,<span class="s2">&quot;id.resp_h&quot;</span>:<span class="s2">&quot;65.9.141.86&quot;</span>,<span class="s2">&quot;id.resp_p&quot;</span>:80,<span class="s2">&quot;source&quot;</span>:<span class="s2">&quot;HTTP&quot;</span>,<span class="s2">&quot;depth&quot;</span>:0,<span class="s2">&quot;analyzers&quot;</span>:<span class="o">[]</span>,<span class="s2">&quot;mime_type&quot;</span>:<span class="s2">&quot;text/plain&quot;</span>,<span class="s2">&quot;duration&quot;</span>:0.0,<span class="s2">&quot;local_orig&quot;</span>:false,<span class="s2">&quot;is_orig&quot;</span>:false,<span class="s2">&quot;seen_bytes&quot;</span>:39,<span class="s2">&quot;total_bytes&quot;</span>:39,<span class="s2">&quot;missing_bytes&quot;</span>:0,<span class="s2">&quot;overflow_bytes&quot;</span>:0,<span class="s2">&quot;timedout&quot;</span>:false<span class="o">}</span>
<a id="__codelineno-54-2" name="__codelineno-54-2" href="#__codelineno-54-2"></a>...
</code></pre></div>
<p>Next we look at the <code>http.log</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a>cat<span class="w"> </span>http.log
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-56-1" name="__codelineno-56-1" href="#__codelineno-56-1"></a><span class="o">{</span><span class="s2">&quot;ts&quot;</span>:1726201775.01087,<span class="s2">&quot;uid&quot;</span>:<span class="s2">&quot;CQcULU2VXecTtcygwa&quot;</span>,<span class="s2">&quot;id.orig_h&quot;</span>:<span class="s2">&quot;10.0.0.25&quot;</span>,<span class="s2">&quot;id.orig_p&quot;</span>:37652,<span class="s2">&quot;id.resp_h&quot;</span>:<span class="s2">&quot;65.9.141.86&quot;</span>,<span class="s2">&quot;id.resp_p&quot;</span>:80,<span class="s2">&quot;trans_depth&quot;</span>:1,<span class="s2">&quot;method&quot;</span>:<span class="s2">&quot;GET&quot;</span>,<span class="s2">&quot;host&quot;</span>:<span class="s2">&quot;testmynids.org&quot;</span>,<span class="s2">&quot;uri&quot;</span>:<span class="s2">&quot;/uid/index.html&quot;</span>,<span class="s2">&quot;version&quot;</span>:<span class="s2">&quot;1.1&quot;</span>,<span class="s2">&quot;user_agent&quot;</span>:<span class="s2">&quot;curl/7.81.0&quot;</span>,<span class="s2">&quot;request_body_len&quot;</span>:0,<span class="s2">&quot;response_body_len&quot;</span>:39,<span class="s2">&quot;status_code&quot;</span>:200,<span class="s2">&quot;status_msg&quot;</span>:<span class="s2">&quot;OK&quot;</span>,<span class="s2">&quot;tags&quot;</span>:<span class="o">[]</span>,<span class="s2">&quot;resp_fuids&quot;</span>:<span class="o">[</span><span class="s2">&quot;FQzmmA4txLAELVk6ug&quot;</span><span class="o">]</span>,<span class="s2">&quot;resp_mime_types&quot;</span>:<span class="o">[</span><span class="s2">&quot;text/plain&quot;</span><span class="o">]}</span>
<a id="__codelineno-56-2" name="__codelineno-56-2" href="#__codelineno-56-2"></a>...
</code></pre></div>
<p>Comparing the two log styles, we see strengths and weaknesses for each. For example, the TSV format shows the Zeek types associated with each entry, such as <code>string</code>, <code>addr</code>, <code>port</code>, and so on. The JSON format does not include that data. However, the JSON format associates each field “key” with a “value,” such as <code>"id.orig_p":37652</code>. While this necessarily increases the amount of disk space used to store the raw logs, it makes it easier for analysts and software to interpret the data, as the key is directly associated with the value that follows. For this reason, most developers and analysts have adopted the JSON output format for Zeek logs. That is the format we will use for the log analysis sections of the documentation.</p>
<h3 id="zeek-json-format-and-jq"><strong>Zeek JSON Format and jq</strong></h3>
<p>Analysts sometimes choose to inspect JSON-formatted Zeek files using applications that recognise JSON format, such as <strong>jq</strong>, which is a JSON parser by Stephen Dolan, available at GitHub (<a href="https://stedolan.github.io/jq/">https://stedolan.github.io/jq/</a>). It may already be installed on your Unix-like system.</p>
<p>In the following example we process the <code>dns.log</code> file with the <code>.</code> filter, which tells <strong>jq</strong> to simply output what it finds in the file. By default <strong>jq</strong> outputs JSON formatted data in its “pretty-print” style, which puts one key:value pair on each line as shown.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-57-1" name="__codelineno-57-1" href="#__codelineno-57-1"></a>jq<span class="w"> </span>.<span class="w"> </span>dns.log
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-58-1" name="__codelineno-58-1" href="#__codelineno-58-1"></a><span class="o">{</span>
<a id="__codelineno-58-2" name="__codelineno-58-2" href="#__codelineno-58-2"></a><span class="w">  </span><span class="s2">&quot;ts&quot;</span>:<span class="w"> </span><span class="m">1726201774</span>.886295,
<a id="__codelineno-58-3" name="__codelineno-58-3" href="#__codelineno-58-3"></a><span class="w">  </span><span class="s2">&quot;uid&quot;</span>:<span class="w"> </span><span class="s2">&quot;CboAKi44MALjum3o2k&quot;</span>,
<a id="__codelineno-58-4" name="__codelineno-58-4" href="#__codelineno-58-4"></a><span class="w">  </span><span class="s2">&quot;id.orig_h&quot;</span>:<span class="w"> </span><span class="s2">&quot;10.0.0.25&quot;</span>,
<a id="__codelineno-58-5" name="__codelineno-58-5" href="#__codelineno-58-5"></a><span class="w">  </span><span class="s2">&quot;id.orig_p&quot;</span>:<span class="w"> </span><span class="m">37842</span>,
<a id="__codelineno-58-6" name="__codelineno-58-6" href="#__codelineno-58-6"></a><span class="w">  </span><span class="s2">&quot;id.resp_h&quot;</span>:<span class="w"> </span><span class="s2">&quot;8.8.8.8&quot;</span>,
<a id="__codelineno-58-7" name="__codelineno-58-7" href="#__codelineno-58-7"></a><span class="w">  </span><span class="s2">&quot;id.resp_p&quot;</span>:<span class="w"> </span><span class="m">53</span>,
<a id="__codelineno-58-8" name="__codelineno-58-8" href="#__codelineno-58-8"></a><span class="w">  </span><span class="s2">&quot;proto&quot;</span>:<span class="w"> </span><span class="s2">&quot;udp&quot;</span>,
<a id="__codelineno-58-9" name="__codelineno-58-9" href="#__codelineno-58-9"></a><span class="w">  </span><span class="s2">&quot;trans_id&quot;</span>:<span class="w"> </span><span class="m">27806</span>,
<a id="__codelineno-58-10" name="__codelineno-58-10" href="#__codelineno-58-10"></a><span class="w">  </span><span class="s2">&quot;rtt&quot;</span>:<span class="w"> </span><span class="m">0</span>.07181096076965332,
<a id="__codelineno-58-11" name="__codelineno-58-11" href="#__codelineno-58-11"></a><span class="w">  </span><span class="s2">&quot;query&quot;</span>:<span class="w"> </span><span class="s2">&quot;testmynids.org&quot;</span>,
<a id="__codelineno-58-12" name="__codelineno-58-12" href="#__codelineno-58-12"></a><span class="w">  </span><span class="s2">&quot;qclass&quot;</span>:<span class="w"> </span><span class="m">1</span>,
<a id="__codelineno-58-13" name="__codelineno-58-13" href="#__codelineno-58-13"></a><span class="w">  </span><span class="s2">&quot;qclass_name&quot;</span>:<span class="w"> </span><span class="s2">&quot;C_INTERNET&quot;</span>,
<a id="__codelineno-58-14" name="__codelineno-58-14" href="#__codelineno-58-14"></a><span class="w">  </span><span class="s2">&quot;qtype&quot;</span>:<span class="w"> </span><span class="m">1</span>,
<a id="__codelineno-58-15" name="__codelineno-58-15" href="#__codelineno-58-15"></a><span class="w">  </span><span class="s2">&quot;qtype_name&quot;</span>:<span class="w"> </span><span class="s2">&quot;A&quot;</span>,
<a id="__codelineno-58-16" name="__codelineno-58-16" href="#__codelineno-58-16"></a><span class="w">  </span><span class="s2">&quot;rcode&quot;</span>:<span class="w"> </span><span class="m">0</span>,
<a id="__codelineno-58-17" name="__codelineno-58-17" href="#__codelineno-58-17"></a><span class="w">  </span><span class="s2">&quot;rcode_name&quot;</span>:<span class="w"> </span><span class="s2">&quot;NOERROR&quot;</span>,
<a id="__codelineno-58-18" name="__codelineno-58-18" href="#__codelineno-58-18"></a><span class="w">  </span><span class="s2">&quot;AA&quot;</span>:<span class="w"> </span>false,
<a id="__codelineno-58-19" name="__codelineno-58-19" href="#__codelineno-58-19"></a><span class="w">  </span><span class="s2">&quot;TC&quot;</span>:<span class="w"> </span>false,
<a id="__codelineno-58-20" name="__codelineno-58-20" href="#__codelineno-58-20"></a><span class="w">  </span><span class="s2">&quot;RD&quot;</span>:<span class="w"> </span>true,
<a id="__codelineno-58-21" name="__codelineno-58-21" href="#__codelineno-58-21"></a><span class="w">  </span><span class="s2">&quot;RA&quot;</span>:<span class="w"> </span>true,
<a id="__codelineno-58-22" name="__codelineno-58-22" href="#__codelineno-58-22"></a><span class="w">  </span><span class="s2">&quot;Z&quot;</span>:<span class="w"> </span><span class="m">0</span>,
<a id="__codelineno-58-23" name="__codelineno-58-23" href="#__codelineno-58-23"></a><span class="w">  </span><span class="s2">&quot;answers&quot;</span>:<span class="w"> </span><span class="o">[</span>
<a id="__codelineno-58-24" name="__codelineno-58-24" href="#__codelineno-58-24"></a><span class="w">    </span><span class="s2">&quot;65.9.141.86&quot;</span>,
<a id="__codelineno-58-25" name="__codelineno-58-25" href="#__codelineno-58-25"></a><span class="w">    </span><span class="s2">&quot;65.9.141.96&quot;</span>,
<a id="__codelineno-58-26" name="__codelineno-58-26" href="#__codelineno-58-26"></a><span class="w">    </span><span class="s2">&quot;65.9.141.53&quot;</span>,
<a id="__codelineno-58-27" name="__codelineno-58-27" href="#__codelineno-58-27"></a><span class="w">    </span><span class="s2">&quot;65.9.141.117&quot;</span>
<a id="__codelineno-58-28" name="__codelineno-58-28" href="#__codelineno-58-28"></a><span class="w">  </span><span class="o">]</span>,
<a id="__codelineno-58-29" name="__codelineno-58-29" href="#__codelineno-58-29"></a><span class="w">  </span><span class="s2">&quot;TTLs&quot;</span>:<span class="w"> </span><span class="o">[</span>
<a id="__codelineno-58-30" name="__codelineno-58-30" href="#__codelineno-58-30"></a><span class="w">    </span><span class="m">60</span>,
<a id="__codelineno-58-31" name="__codelineno-58-31" href="#__codelineno-58-31"></a><span class="w">    </span><span class="m">60</span>,
<a id="__codelineno-58-32" name="__codelineno-58-32" href="#__codelineno-58-32"></a><span class="w">    </span><span class="m">60</span>,
<a id="__codelineno-58-33" name="__codelineno-58-33" href="#__codelineno-58-33"></a><span class="w">    </span><span class="m">60</span>
<a id="__codelineno-58-34" name="__codelineno-58-34" href="#__codelineno-58-34"></a><span class="w">  </span><span class="o">]</span>,
<a id="__codelineno-58-35" name="__codelineno-58-35" href="#__codelineno-58-35"></a><span class="w">  </span><span class="s2">&quot;rejected&quot;</span>:<span class="w"> </span><span class="nb">false</span>
<a id="__codelineno-58-36" name="__codelineno-58-36" href="#__codelineno-58-36"></a><span class="o">}</span>
<a id="__codelineno-58-37" name="__codelineno-58-37" href="#__codelineno-58-37"></a>...
</code></pre></div>
<p>We can tell <strong>jq</strong> to output what it sees in “compact” format using the <code>-c</code> switch.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-59-1" name="__codelineno-59-1" href="#__codelineno-59-1"></a>jq<span class="w"> </span>.<span class="w"> </span>-c<span class="w"> </span>dns.log
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-60-1" name="__codelineno-60-1" href="#__codelineno-60-1"></a><span class="o">{</span><span class="s2">&quot;ts&quot;</span>:1726201774.886295,<span class="s2">&quot;uid&quot;</span>:<span class="s2">&quot;CboAKi44MALjum3o2k&quot;</span>,<span class="s2">&quot;id.orig_h&quot;</span>:<span class="s2">&quot;10.0.0.25&quot;</span>,<span class="s2">&quot;id.orig_p&quot;</span>:37842,<span class="s2">&quot;id.resp_h&quot;</span>:<span class="s2">&quot;8.8.8.8&quot;</span>,<span class="s2">&quot;id.resp_p&quot;</span>:53,<span class="s2">&quot;proto&quot;</span>:<span class="s2">&quot;udp&quot;</span>,<span class="s2">&quot;trans_id&quot;</span>:27806,<span class="s2">&quot;rtt&quot;</span>:0.07181096076965332,<span class="s2">&quot;query&quot;</span>:<span class="s2">&quot;testmynids.org&quot;</span>,<span class="s2">&quot;qclass&quot;</span>:1,<span class="s2">&quot;qclass_name&quot;</span>:<span class="s2">&quot;C_INTERNET&quot;</span>,<span class="s2">&quot;qtype&quot;</span>:1,<span class="s2">&quot;qtype_name&quot;</span>:<span class="s2">&quot;A&quot;</span>,<span class="s2">&quot;rcode&quot;</span>:0,<span class="s2">&quot;rcode_name&quot;</span>:<span class="s2">&quot;NOERROR&quot;</span>,<span class="s2">&quot;AA&quot;</span>:false,<span class="s2">&quot;TC&quot;</span>:false,<span class="s2">&quot;RD&quot;</span>:true,<span class="s2">&quot;RA&quot;</span>:true,<span class="s2">&quot;Z&quot;</span>:0,<span class="s2">&quot;answers&quot;</span>:<span class="o">[</span><span class="s2">&quot;65.9.141.86&quot;</span>,<span class="s2">&quot;65.9.141.96&quot;</span>,<span class="s2">&quot;65.9.141.53&quot;</span>,<span class="s2">&quot;65.9.141.117&quot;</span><span class="o">]</span>,<span class="s2">&quot;TTLs&quot;</span>:<span class="o">[</span><span class="m">60</span>,60,60,60<span class="o">]</span>,<span class="s2">&quot;rejected&quot;</span>:false<span class="o">}</span>
<a id="__codelineno-60-2" name="__codelineno-60-2" href="#__codelineno-60-2"></a>...
</code></pre></div>
<p>The power of <strong>jq</strong> becomes evident when we decide we only want to see specific values. For example, the following tells <strong>jq</strong> to look at the <code>dns.log</code> and report the source IP of systems doing DNS queries, followed by the query, and any answer to the query.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-61-1" name="__codelineno-61-1" href="#__codelineno-61-1"></a>jq<span class="w"> </span>-c<span class="w"> </span><span class="s1">&#39;[.&quot;id.orig_h&quot;, .&quot;query&quot;, .&quot;answers&quot;]&#39;</span><span class="w"> </span>dns.log
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-62-1" name="__codelineno-62-1" href="#__codelineno-62-1"></a><span class="o">[</span><span class="s2">&quot;192.168.4.76&quot;</span>,<span class="s2">&quot;testmyids.com&quot;</span>,null<span class="o">]</span>
<a id="__codelineno-62-2" name="__codelineno-62-2" href="#__codelineno-62-2"></a><span class="o">[</span><span class="s2">&quot;192.168.4.76&quot;</span>,<span class="s2">&quot;testmyids.com&quot;</span>,<span class="o">[</span><span class="s2">&quot;31.3.245.133&quot;</span><span class="o">]]</span>
</code></pre></div>
<p>For a more comprehensive description of the capabilities of <strong>jq</strong>, see the <a href="https://stedolan.github.io/jq/manual/">jq manual</a>.</p>
<p>With this basic understanding of how to interact with Zeek logs, we can now turn to specific logs and interpret their values.</p>
<h2 id="zeek-to-suricata-integration-via-pcap-files">Zeek to Suricata Integration via PCAP Files</h2>
<p>You can use Zeek to capture network traffic and save it as PCAP files, which can then be processed by Suricata for further signature-based analysis.</p>
<p>Run the following command to capture packets from an interface and write them to a file named sample3.pcap</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-63-1" name="__codelineno-63-1" href="#__codelineno-63-1"></a>sudo<span class="w"> </span>tcpdump<span class="w"> </span>-i<span class="w"> </span>ens32<span class="w"> </span>-s<span class="w"> </span><span class="m">0</span><span class="w"> </span>-w<span class="w"> </span>sample3.pcap
</code></pre></div>
<p>For demonstration purposes, a curl command to <code>http://testmyids.org/uid/index.html</code> was run few times to trigger Suricata alerts. </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-64-1" name="__codelineno-64-1" href="#__codelineno-64-1"></a><span class="n">curl</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">testmyids</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">uid</span><span class="o">/</span><span class="n">index</span><span class="o">.</span><span class="n">html</span>
</code></pre></div>
<p>After capturing traffic, kill the tcpdump (with <em>ctrl-c</em>).</p>
<p>Analyse <code>sample3.pcap</code> with Suricata:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-65-1" name="__codelineno-65-1" href="#__codelineno-65-1"></a><span class="c1">#/home/cyber/test directory</span>
<a id="__codelineno-65-2" name="__codelineno-65-2" href="#__codelineno-65-2"></a>sudo<span class="w"> </span>suricata<span class="w"> </span>-r<span class="w"> </span>sample3.pcap<span class="w"> </span>-c<span class="w"> </span>/etc/suricata/suricata.yaml
</code></pre></div>
<p>Check summary of Suricata alerts</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-66-1" name="__codelineno-66-1" href="#__codelineno-66-1"></a><span class="c1">#/home/cyber/test directory</span>
<a id="__codelineno-66-2" name="__codelineno-66-2" href="#__codelineno-66-2"></a>cat<span class="w"> </span>fast.log
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-67-1" name="__codelineno-67-1" href="#__codelineno-67-1"></a><span class="m">09</span>/13/2024-15:57:41.930330<span class="w">  </span><span class="o">[</span>**<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">1</span>:2022973:1<span class="o">]</span><span class="w"> </span>ET<span class="w"> </span>INFO<span class="w"> </span>Possible<span class="w"> </span>Kali<span class="w"> </span>Linux<span class="w"> </span>hostname<span class="w"> </span><span class="k">in</span><span class="w"> </span>DHCP<span class="w"> </span>Request<span class="w"> </span>Packet<span class="w"> </span><span class="o">[</span>**<span class="o">]</span><span class="w"> </span><span class="o">[</span>Classification:<span class="w"> </span>Potential<span class="w"> </span>Corporate<span class="w"> </span>Privacy<span class="w"> </span>Violation<span class="o">]</span><span class="w"> </span><span class="o">[</span>Priority:<span class="w"> </span><span class="m">1</span><span class="o">]</span><span class="w"> </span><span class="o">{</span>UDP<span class="o">}</span><span class="w"> </span><span class="m">0</span>.0.0.0:68<span class="w"> </span>-&gt;<span class="w"> </span><span class="m">255</span>.255.255.255:67
<a id="__codelineno-67-2" name="__codelineno-67-2" href="#__codelineno-67-2"></a><span class="m">09</span>/13/2024-16:12:26.419561<span class="w">  </span><span class="o">[</span>**<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">1</span>:2100498:7<span class="o">]</span><span class="w"> </span>GPL<span class="w"> </span>ATTACK_RESPONSE<span class="w"> </span>id<span class="w"> </span>check<span class="w"> </span>returned<span class="w"> </span>root<span class="w"> </span><span class="o">[</span>**<span class="o">]</span><span class="w"> </span><span class="o">[</span>Classification:<span class="w"> </span>Potentially<span class="w"> </span>Bad<span class="w"> </span>Traffic<span class="o">]</span><span class="w"> </span><span class="o">[</span>Priority:<span class="w"> </span><span class="m">2</span><span class="o">]</span><span class="w"> </span><span class="o">{</span>TCP<span class="o">}</span><span class="w"> </span><span class="m">65</span>.9.141.117:80<span class="w"> </span>-&gt;<span class="w"> </span><span class="m">10</span>.0.0.25:35302
<a id="__codelineno-67-3" name="__codelineno-67-3" href="#__codelineno-67-3"></a><span class="m">09</span>/13/2024-16:12:28.115791<span class="w">  </span><span class="o">[</span>**<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">1</span>:2100498:7<span class="o">]</span><span class="w"> </span>GPL<span class="w"> </span>ATTACK_RESPONSE<span class="w"> </span>id<span class="w"> </span>check<span class="w"> </span>returned<span class="w"> </span>root<span class="w"> </span><span class="o">[</span>**<span class="o">]</span><span class="w"> </span><span class="o">[</span>Classification:<span class="w"> </span>Potentially<span class="w"> </span>Bad<span class="w"> </span>Traffic<span class="o">]</span><span class="w"> </span><span class="o">[</span>Priority:<span class="w"> </span><span class="m">2</span><span class="o">]</span><span class="w"> </span><span class="o">{</span>TCP<span class="o">}</span><span class="w"> </span><span class="m">65</span>.9.141.53:80<span class="w"> </span>-&gt;<span class="w"> </span><span class="m">10</span>.0.0.25:34888
<a id="__codelineno-67-4" name="__codelineno-67-4" href="#__codelineno-67-4"></a><span class="m">09</span>/13/2024-16:12:29.725875<span class="w">  </span><span class="o">[</span>**<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">1</span>:2100498:7<span class="o">]</span><span class="w"> </span>GPL<span class="w"> </span>ATTACK_RESPONSE<span class="w"> </span>id<span class="w"> </span>check<span class="w"> </span>returned<span class="w"> </span>root<span class="w"> </span><span class="o">[</span>**<span class="o">]</span><span class="w"> </span><span class="o">[</span>Classification:<span class="w"> </span>Potentially<span class="w"> </span>Bad<span class="w"> </span>Traffic<span class="o">]</span><span class="w"> </span><span class="o">[</span>Priority:<span class="w"> </span><span class="m">2</span><span class="o">]</span><span class="w"> </span><span class="o">{</span>TCP<span class="o">}</span><span class="w"> </span><span class="m">65</span>.9.141.117:80<span class="w"> </span>-&gt;<span class="w"> </span><span class="m">10</span>.0.0.25:35310
<a id="__codelineno-67-5" name="__codelineno-67-5" href="#__codelineno-67-5"></a><span class="m">09</span>/13/2024-16:12:31.507368<span class="w">  </span><span class="o">[</span>**<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">1</span>:2100498:7<span class="o">]</span><span class="w"> </span>GPL<span class="w"> </span>ATTACK_RESPONSE<span class="w"> </span>id<span class="w"> </span>check<span class="w"> </span>returned<span class="w"> </span>root<span class="w"> </span><span class="o">[</span>**<span class="o">]</span><span class="w"> </span><span class="o">[</span>Classification:<span class="w"> </span>Potentially<span class="w"> </span>Bad<span class="w"> </span>Traffic<span class="o">]</span><span class="w"> </span><span class="o">[</span>Priority:<span class="w"> </span><span class="m">2</span><span class="o">]</span><span class="w"> </span><span class="o">{</span>TCP<span class="o">}</span><span class="w"> </span><span class="m">65</span>.9.141.53:80<span class="w"> </span>-&gt;<span class="w"> </span><span class="m">10</span>.0.0.25:34894
<a id="__codelineno-67-6" name="__codelineno-67-6" href="#__codelineno-67-6"></a><span class="m">09</span>/13/2024-16:12:32.574700<span class="w">  </span><span class="o">[</span>**<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">1</span>:2100498:7<span class="o">]</span><span class="w"> </span>GPL<span class="w"> </span>ATTACK_RESPONSE<span class="w"> </span>id<span class="w"> </span>check<span class="w"> </span>returned<span class="w"> </span>root<span class="w"> </span><span class="o">[</span>**<span class="o">]</span><span class="w"> </span><span class="o">[</span>Classification:<span class="w"> </span>Potentially<span class="w"> </span>Bad<span class="w"> </span>Traffic<span class="o">]</span><span class="w"> </span><span class="o">[</span>Priority:<span class="w"> </span><span class="m">2</span><span class="o">]</span><span class="w"> </span><span class="o">{</span>TCP<span class="o">}</span><span class="w"> </span><span class="m">65</span>.9.141.117:80<span class="w"> </span>-&gt;<span class="w"> </span><span class="m">10</span>.0.0.25:35312
<a id="__codelineno-67-7" name="__codelineno-67-7" href="#__codelineno-67-7"></a><span class="m">09</span>/13/2024-16:22:41.951177<span class="w">  </span><span class="o">[</span>**<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">1</span>:2100498:7<span class="o">]</span><span class="w"> </span>GPL<span class="w"> </span>ATTACK_RESPONSE<span class="w"> </span>id<span class="w"> </span>check<span class="w"> </span>returned<span class="w"> </span>root<span class="w"> </span><span class="o">[</span>**<span class="o">]</span><span class="w"> </span><span class="o">[</span>Classification:<span class="w"> </span>Potentially<span class="w"> </span>Bad<span class="w"> </span>Traffic<span class="o">]</span><span class="w"> </span><span class="o">[</span>Priority:<span class="w"> </span><span class="m">2</span><span class="o">]</span><span class="w"> </span><span class="o">{</span>TCP<span class="o">}</span><span class="w"> </span><span class="m">65</span>.9.141.53:80<span class="w"> </span>-&gt;<span class="w"> </span><span class="m">10</span>.0.0.25:43742
<a id="__codelineno-67-8" name="__codelineno-67-8" href="#__codelineno-67-8"></a><span class="m">09</span>/13/2024-16:29:35.102985<span class="w">  </span><span class="o">[</span>**<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">1</span>:2100498:7<span class="o">]</span><span class="w"> </span>GPL<span class="w"> </span>ATTACK_RESPONSE<span class="w"> </span>id<span class="w"> </span>check<span class="w"> </span>returned<span class="w"> </span>root<span class="w"> </span><span class="o">[</span>**<span class="o">]</span><span class="w"> </span><span class="o">[</span>Classification:<span class="w"> </span>Potentially<span class="w"> </span>Bad<span class="w"> </span>Traffic<span class="o">]</span><span class="w"> </span><span class="o">[</span>Priority:<span class="w"> </span><span class="m">2</span><span class="o">]</span><span class="w"> </span><span class="o">{</span>TCP<span class="o">}</span><span class="w"> </span><span class="m">65</span>.9.141.86:80<span class="w"> </span>-&gt;<span class="w"> </span><span class="m">10</span>.0.0.25:37652
<a id="__codelineno-67-9" name="__codelineno-67-9" href="#__codelineno-67-9"></a><span class="m">09</span>/13/2024-16:29:35.844047<span class="w">  </span><span class="o">[</span>**<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">1</span>:2100498:7<span class="o">]</span><span class="w"> </span>GPL<span class="w"> </span>ATTACK_RESPONSE<span class="w"> </span>id<span class="w"> </span>check<span class="w"> </span>returned<span class="w"> </span>root<span class="w"> </span><span class="o">[</span>**<span class="o">]</span><span class="w"> </span><span class="o">[</span>Classification:<span class="w"> </span>Potentially<span class="w"> </span>Bad<span class="w"> </span>Traffic<span class="o">]</span><span class="w"> </span><span class="o">[</span>Priority:<span class="w"> </span><span class="m">2</span><span class="o">]</span><span class="w"> </span><span class="o">{</span>TCP<span class="o">}</span><span class="w"> </span><span class="m">65</span>.9.141.117:80<span class="w"> </span>-&gt;<span class="w"> </span><span class="m">10</span>.0.0.25:54034
<a id="__codelineno-67-10" name="__codelineno-67-10" href="#__codelineno-67-10"></a><span class="m">09</span>/13/2024-16:29:36.590678<span class="w">  </span><span class="o">[</span>**<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">1</span>:2100498:7<span class="o">]</span><span class="w"> </span>GPL<span class="w"> </span>ATTACK_RESPONSE<span class="w"> </span>id<span class="w"> </span>check<span class="w"> </span>returned<span class="w"> </span>root<span class="w"> </span><span class="o">[</span>**<span class="o">]</span><span class="w"> </span><span class="o">[</span>Classification:<span class="w"> </span>Potentially<span class="w"> </span>Bad<span class="w"> </span>Traffic<span class="o">]</span><span class="w"> </span><span class="o">[</span>Priority:<span class="w"> </span><span class="m">2</span><span class="o">]</span><span class="w"> </span><span class="o">{</span>TCP<span class="o">}</span><span class="w"> </span><span class="m">65</span>.9.141.86:80<span class="w"> </span>-&gt;<span class="w"> </span><span class="m">10</span>.0.0.25:51716
</code></pre></div>
<h2 id="zeeks-intelligence-framework"><strong>Zeek’s Intelligence Framework</strong></h2>
<h3 id="introduction"><strong>Introduction</strong></h3>
<p>The goals of Zeek’s Intelligence Framework are to consume intelligence data, make it available for matching, and provide infrastructure to improve performance and memory utilization.</p>
<p>Data in the Intelligence Framework is an atomic piece of intelligence such as an IP address or an e-mail address. This atomic data will be packed with metadata such as a freeform source field, a freeform descriptive field, and a URL which might lead to more information about the specific item. The metadata in the default scripts has been deliberately kept to a minimum.</p>
<h3 id="quick-start"><strong>Quick Start</strong></h3>
<p>Verify that there is no file named <code>intel.log</code> in the <code>/opt/zeek/logs/current/</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-68-1" name="__codelineno-68-1" href="#__codelineno-68-1"></a>ls<span class="w"> </span>-la<span class="w"> </span>/opt/zeek/logs/current
</code></pre></div>
<p>First we need to define the intelligence data to match. Let’s look for the domain <code>www.reddit.com</code>. For the details of the file format see the <a href="https://docs.zeek.org/en/master/frameworks/intel.html#loading-intelligence">Loading Intelligence</a> section below.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-69-1" name="__codelineno-69-1" href="#__codelineno-69-1"></a>nano<span class="w"> </span>/home/cyber/intel_test/data.txt
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-70-1" name="__codelineno-70-1" href="#__codelineno-70-1"></a><span class="c1">#fields       indicator       indicator_type  meta.source</span>
<a id="__codelineno-70-2" name="__codelineno-70-2" href="#__codelineno-70-2"></a>www.reddit.com<span class="w">        </span>Intel::DOMAIN<span class="w">   </span>my_special_source
</code></pre></div>
<p>The file should look like this (<strong>with tabs instead of spaces</strong>):</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-71-1" name="__codelineno-71-1" href="#__codelineno-71-1"></a><span class="c1">#fields&lt;TAB&gt;indicator&lt;TAB&gt;indicator_type&lt;TAB&gt;meta.source</span>
<a id="__codelineno-71-2" name="__codelineno-71-2" href="#__codelineno-71-2"></a>www.reddit.com&lt;TAB&gt;Intel::DOMAIN&lt;TAB&gt;my_special_source
</code></pre></div>
<p>Now we need to tell Zeek about the data. Add this line to your <code>opt/zeek/share/zeek/site/local.zeek</code> to load an intelligence file:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-72-1" name="__codelineno-72-1" href="#__codelineno-72-1"></a>redef<span class="w"> </span>Intel::read_files<span class="w"> </span>+<span class="o">=</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="s2">&quot;/home/cyber/intel_test/data.txt&quot;</span><span class="w"> </span><span class="o">}</span><span class="p">;</span>
</code></pre></div>
<p>Add the following line to <code>local.zeek</code> to load the scripts that send “seen” data into the Intelligence Framework to be checked against the loaded intelligence data:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-73-1" name="__codelineno-73-1" href="#__codelineno-73-1"></a>@load<span class="w"> </span>frameworks/intel/seen
</code></pre></div>
<p>If you want your logs to be generated in JSON format, add the following line to <code>local.zeek</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-74-1" name="__codelineno-74-1" href="#__codelineno-74-1"></a>@load<span class="w"> </span>policy/tuning/json-logs.zeek
</code></pre></div>
<p>Save <code>local.zeek</code> and redeploy Zeek via Zeekctl</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-75-1" name="__codelineno-75-1" href="#__codelineno-75-1"></a>/opt/zeek/bin/zeekctl
<a id="__codelineno-75-2" name="__codelineno-75-2" href="#__codelineno-75-2"></a><span class="o">[</span>ZeekControl<span class="o">]</span><span class="w"> </span>&gt;<span class="w"> </span>deploy
</code></pre></div>
<p>Navigate to <code>www.reddit.com</code> on a web browser or run <code>curl https://www.reddit.com</code></p>
<p>Verify that <code>intel.log</code> is generated in the <code>/opt/zeek/logs/current/</code> directory.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-76-1" name="__codelineno-76-1" href="#__codelineno-76-1"></a>ls<span class="w"> </span>-la<span class="w"> </span>/opt/zeek/logs/current/intel.log<span class="w"> </span>
<a id="__codelineno-76-2" name="__codelineno-76-2" href="#__codelineno-76-2"></a>-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>zeek<span class="w"> </span><span class="m">1003</span><span class="w"> </span>Sep<span class="w"> </span><span class="m">13</span><span class="w"> </span><span class="m">17</span>:34<span class="w"> </span>/opt/zeek/logs/current/intel.log
</code></pre></div>
<p>Intelligence data matches will be logged to the <code>intel.log</code> file. A match on <code>www.reddit.com</code> might look like this:</p>
<p>TSV Format:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-77-1" name="__codelineno-77-1" href="#__codelineno-77-1"></a><span class="c1">#separator \x09</span>
<a id="__codelineno-77-2" name="__codelineno-77-2" href="#__codelineno-77-2"></a><span class="c1">#set_separator  ,</span>
<a id="__codelineno-77-3" name="__codelineno-77-3" href="#__codelineno-77-3"></a><span class="c1">#empty_field    (empty)</span>
<a id="__codelineno-77-4" name="__codelineno-77-4" href="#__codelineno-77-4"></a><span class="c1">#unset_field    -</span>
<a id="__codelineno-77-5" name="__codelineno-77-5" href="#__codelineno-77-5"></a><span class="c1">#path   intel</span>
<a id="__codelineno-77-6" name="__codelineno-77-6" href="#__codelineno-77-6"></a><span class="c1">#open   2024-09-13-17-34-18</span>
<a id="__codelineno-77-7" name="__codelineno-77-7" href="#__codelineno-77-7"></a><span class="c1">#fields ts  uid id.orig_h   id.orig_p   id.resp_h   id.resp_p   seen.indicator  seen.indicator_type seen.where  seen.node   matched sources fuid    file_mime_type  file_desc</span>
<a id="__codelineno-77-8" name="__codelineno-77-8" href="#__codelineno-77-8"></a><span class="c1">#types  time    string  addr    port    addr    port    string  enum    enum    string  set[enum]   set[string] string  string  string</span>
<a id="__codelineno-77-9" name="__codelineno-77-9" href="#__codelineno-77-9"></a><span class="m">1726205657</span>.998538<span class="w">   </span>CqUrI04Y7fFPsytdRe<span class="w">  </span><span class="m">10</span>.0.0.25<span class="w">   </span><span class="m">47594</span><span class="w">   </span><span class="m">8</span>.8.8.8<span class="w"> </span><span class="m">53</span><span class="w">  </span>www.reddit.com<span class="w">  </span>Intel::DOMAIN<span class="w">   </span>DNS::IN_REQUEST<span class="w"> </span>zeek<span class="w">    </span>Intel::DOMAIN<span class="w">   </span>my_special_source<span class="w">   </span>-<span class="w">   </span>-<span class="w">   </span>-
<a id="__codelineno-77-10" name="__codelineno-77-10" href="#__codelineno-77-10"></a><span class="m">1726205657</span>.999634<span class="w">   </span>Cifoa91ikOBbh89gn6<span class="w">  </span><span class="m">10</span>.0.0.25<span class="w">   </span><span class="m">39683</span><span class="w">   </span><span class="m">8</span>.8.8.8<span class="w"> </span><span class="m">53</span><span class="w">  </span>www.reddit.com<span class="w">  </span>Intel::DOMAIN<span class="w">   </span>DNS::IN_REQUEST<span class="w"> </span>zeek<span class="w">    </span>Intel::DOMAIN<span class="w">   </span>my_special_source<span class="w">   </span>-<span class="w">   </span>-<span class="w">   </span>-
<a id="__codelineno-77-11" name="__codelineno-77-11" href="#__codelineno-77-11"></a><span class="m">1726205658</span>.134483<span class="w">   </span>CDfw3o3w2dyFyCK4J1<span class="w">  </span><span class="m">10</span>.0.0.25<span class="w">   </span><span class="m">49050</span><span class="w">   </span><span class="m">151</span>.101.65.140<span class="w">  </span><span class="m">80</span><span class="w">  </span>www.reddit.com<span class="w">  </span>Intel::DOMAIN<span class="w">   </span>HTTP::IN_HOST_HEADER<span class="w">    </span>zeek<span class="w">    </span>Intel::DOMAIN<span class="w">   </span>my_special_source<span class="w">   </span>-<span class="w">   </span>--
<a id="__codelineno-77-12" name="__codelineno-77-12" href="#__codelineno-77-12"></a><span class="m">1726205661</span>.327155<span class="w">   </span>Cgj6iV1JWK1QPFoE5d<span class="w">  </span><span class="m">10</span>.0.0.25<span class="w">   </span><span class="m">51836</span><span class="w">   </span><span class="m">151</span>.101.193.140<span class="w"> </span><span class="m">80</span><span class="w">  </span>www.reddit.com<span class="w">  </span>Intel::DOMAIN<span class="w">   </span>HTTP::IN_HOST_HEADER<span class="w">    </span>zeek<span class="w">    </span>Intel::DOMAIN<span class="w">   </span>my_special_source<span class="w">   </span>-<span class="w">   </span>--
</code></pre></div>
<p>JSON format:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-78-1" name="__codelineno-78-1" href="#__codelineno-78-1"></a>jq<span class="w"> </span>.<span class="w"> </span>intel.log
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-79-1" name="__codelineno-79-1" href="#__codelineno-79-1"></a><span class="o">{</span>
<a id="__codelineno-79-2" name="__codelineno-79-2" href="#__codelineno-79-2"></a><span class="w">  </span><span class="s2">&quot;ts&quot;</span>:<span class="w"> </span><span class="m">1726206423</span>.770539,
<a id="__codelineno-79-3" name="__codelineno-79-3" href="#__codelineno-79-3"></a><span class="w">  </span><span class="s2">&quot;uid&quot;</span>:<span class="w"> </span><span class="s2">&quot;CGLHKn3xKB169eRyuc&quot;</span>,
<a id="__codelineno-79-4" name="__codelineno-79-4" href="#__codelineno-79-4"></a><span class="w">  </span><span class="s2">&quot;id.orig_h&quot;</span>:<span class="w"> </span><span class="s2">&quot;10.0.0.25&quot;</span>,
<a id="__codelineno-79-5" name="__codelineno-79-5" href="#__codelineno-79-5"></a><span class="w">  </span><span class="s2">&quot;id.orig_p&quot;</span>:<span class="w"> </span><span class="m">54142</span>,
<a id="__codelineno-79-6" name="__codelineno-79-6" href="#__codelineno-79-6"></a><span class="w">  </span><span class="s2">&quot;id.resp_h&quot;</span>:<span class="w"> </span><span class="s2">&quot;151.101.65.140&quot;</span>,
<a id="__codelineno-79-7" name="__codelineno-79-7" href="#__codelineno-79-7"></a><span class="w">  </span><span class="s2">&quot;id.resp_p&quot;</span>:<span class="w"> </span><span class="m">80</span>,
<a id="__codelineno-79-8" name="__codelineno-79-8" href="#__codelineno-79-8"></a><span class="w">  </span><span class="s2">&quot;seen.indicator&quot;</span>:<span class="w"> </span><span class="s2">&quot;www.reddit.com&quot;</span>,
<a id="__codelineno-79-9" name="__codelineno-79-9" href="#__codelineno-79-9"></a><span class="w">  </span><span class="s2">&quot;seen.indicator_type&quot;</span>:<span class="w"> </span><span class="s2">&quot;Intel::DOMAIN&quot;</span>,
<a id="__codelineno-79-10" name="__codelineno-79-10" href="#__codelineno-79-10"></a><span class="w">  </span><span class="s2">&quot;seen.where&quot;</span>:<span class="w"> </span><span class="s2">&quot;HTTP::IN_HOST_HEADER&quot;</span>,
<a id="__codelineno-79-11" name="__codelineno-79-11" href="#__codelineno-79-11"></a><span class="w">  </span><span class="s2">&quot;seen.node&quot;</span>:<span class="w"> </span><span class="s2">&quot;zeek&quot;</span>,
<a id="__codelineno-79-12" name="__codelineno-79-12" href="#__codelineno-79-12"></a><span class="w">  </span><span class="s2">&quot;matched&quot;</span>:<span class="w"> </span><span class="o">[</span>
<a id="__codelineno-79-13" name="__codelineno-79-13" href="#__codelineno-79-13"></a><span class="w">    </span><span class="s2">&quot;Intel::DOMAIN&quot;</span>
<a id="__codelineno-79-14" name="__codelineno-79-14" href="#__codelineno-79-14"></a><span class="w">  </span><span class="o">]</span>,
<a id="__codelineno-79-15" name="__codelineno-79-15" href="#__codelineno-79-15"></a><span class="w">  </span><span class="s2">&quot;sources&quot;</span>:<span class="w"> </span><span class="o">[</span>
<a id="__codelineno-79-16" name="__codelineno-79-16" href="#__codelineno-79-16"></a><span class="w">    </span><span class="s2">&quot;my_special_source&quot;</span>
<a id="__codelineno-79-17" name="__codelineno-79-17" href="#__codelineno-79-17"></a><span class="w">  </span><span class="o">]</span>
<a id="__codelineno-79-18" name="__codelineno-79-18" href="#__codelineno-79-18"></a><span class="o">}</span>
</code></pre></div>
<h2 id="references"><strong>References</strong></h2>
<ul>
<li>https://youtu.be/WBid7AZ5w4A?si=YvWCA8kIJXT1jItY</li>
<li>https://docs.zeek.org/en/master/index.html</li>
</ul>







  
  






                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../wireshark/wireshark.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Wireshark">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Wireshark
              </div>
            </div>
          </a>
        
        
          
          <a href="../zui/zui.html" class="md-footer__link md-footer__link--next" aria-label="Next: Zui">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Zui
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; 2024–2025 <a href="https://github.com/cyberdefencekit" target="_blank" rel="noopener">Cyber Defence Kit by Joseph Jee</a>

    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/cyberdefencekit" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["content.code.annotate", "content.code.copy", "content.tabs.link", "header.autohide", "announce.dismiss", "navigation.footer", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "navigation.expand", "search.highlight", "search.share", "search.suggest", "toc.integrate"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>